<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Maxime Parodi">
<meta name="author" content="Xavier Timbeau">

<title>MEAPS : Distribution statistique des trajets entre le domicile et le travail</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="radiation_files/libs/clipboard/clipboard.min.js"></script>
<script src="radiation_files/libs/quarto-html/quarto.js"></script>
<script src="radiation_files/libs/quarto-html/popper.min.js"></script>
<script src="radiation_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="radiation_files/libs/quarto-html/anchor.min.js"></script>
<link href="radiation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="radiation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="radiation_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="radiation_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="radiation_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script async="" src="https://hypothes.is/embed.js"></script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#sec-grav" id="toc-sec-grav" class="nav-link" data-scroll-target="#sec-grav"><span class="toc-section-number">1</span>  Les insuffisances du modèle gravitaire</a>
  <ul class="collapse">
  <li><a href="#les-mauvaises-raisons-du-succès-du-modèle-gravitaire" id="toc-les-mauvaises-raisons-du-succès-du-modèle-gravitaire" class="nav-link" data-scroll-target="#les-mauvaises-raisons-du-succès-du-modèle-gravitaire"><span class="toc-section-number">1.1</span>  Les (mauvaises) raisons du succès du modèle gravitaire</a></li>
  <li><a href="#le-voile-de-la-contrainte-aux-marges" id="toc-le-voile-de-la-contrainte-aux-marges" class="nav-link" data-scroll-target="#le-voile-de-la-contrainte-aux-marges"><span class="toc-section-number">1.2</span>  Le voile de la contrainte aux marges</a></li>
  </ul></li>
  <li><a href="#sec-rad" id="toc-sec-rad" class="nav-link" data-scroll-target="#sec-rad"><span class="toc-section-number">2</span>  Une première alternative : le modèle radiatif</a></li>
  <li><a href="#sec-meaps" id="toc-sec-meaps" class="nav-link" data-scroll-target="#sec-meaps"><span class="toc-section-number">3</span>  Un modèle ergodique d’absorption avec priorité et saturation (MEAPS)</a>
  <ul class="collapse">
  <li><a href="#rang-choix-des-destinations-et-absorption" id="toc-rang-choix-des-destinations-et-absorption" class="nav-link" data-scroll-target="#rang-choix-des-destinations-et-absorption"><span class="toc-section-number">3.1</span>  Rang, choix des destinations et absorption</a></li>
  <li><a href="#sec-priorite" id="toc-sec-priorite" class="nav-link" data-scroll-target="#sec-priorite"><span class="toc-section-number">3.2</span>  Saturation et priorité</a></li>
  <li><a href="#sec-erg" id="toc-sec-erg" class="nav-link" data-scroll-target="#sec-erg"><span class="toc-section-number">3.3</span>  Ergodicité</a></li>
  <li><a href="#sec-hetero" id="toc-sec-hetero" class="nav-link" data-scroll-target="#sec-hetero"><span class="toc-section-number">3.4</span>  Hétérogénéité de la fuite et de l’absorption</a></li>
  <li><a href="#synthèse-de-meaps" id="toc-synthèse-de-meaps" class="nav-link" data-scroll-target="#synthèse-de-meaps"><span class="toc-section-number">3.5</span>  Synthèse de MEAPS</a></li>
  </ul></li>
  <li><a href="#sec-synt" id="toc-sec-synt" class="nav-link" data-scroll-target="#sec-synt"><span class="toc-section-number">4</span>  Simulations numériques synthétiques</a>
  <ul class="collapse">
  <li><a href="#trois-pôles-en-centre-et-satellites" id="toc-trois-pôles-en-centre-et-satellites" class="nav-link" data-scroll-target="#trois-pôles-en-centre-et-satellites"><span class="toc-section-number">4.1</span>  Trois pôles en centre et satellites</a></li>
  <li><a href="#sec-estimation" id="toc-sec-estimation" class="nav-link" data-scroll-target="#sec-estimation"><span class="toc-section-number">4.2</span>  Procédure d’estimation</a></li>
  <li><a href="#sec-ergemp" id="toc-sec-ergemp" class="nav-link" data-scroll-target="#sec-ergemp"><span class="toc-section-number">4.3</span>  Ergodicité en pratique</a></li>
  </ul></li>
  <li><a href="#sec-rochelle" id="toc-sec-rochelle" class="nav-link" data-scroll-target="#sec-rochelle"><span class="toc-section-number">5</span>  Une application à l’agglomération de La Rochelle</a>
  <ul class="collapse">
  <li><a href="#emplois-résidents-au-carreau-inspire-200m" id="toc-emplois-résidents-au-carreau-inspire-200m" class="nav-link" data-scroll-target="#emplois-résidents-au-carreau-inspire-200m"><span class="toc-section-number">5.1</span>  Emplois, résidents au carreau Inspire 200m</a></li>
  <li><a href="#calcul-des-distances-par-mode" id="toc-calcul-des-distances-par-mode" class="nav-link" data-scroll-target="#calcul-des-distances-par-mode"><span class="toc-section-number">5.2</span>  Calcul des distances par mode</a></li>
  <li><a href="#ajustement-de-meaps-sur-mobpro" id="toc-ajustement-de-meaps-sur-mobpro" class="nav-link" data-scroll-target="#ajustement-de-meaps-sur-mobpro"><span class="toc-section-number">5.3</span>  Ajustement de MEAPS sur MOBPRO</a></li>
  <li><a href="#scénarios-localisation-de-lemploi" id="toc-scénarios-localisation-de-lemploi" class="nav-link" data-scroll-target="#scénarios-localisation-de-lemploi"><span class="toc-section-number">5.4</span>  Scénarios “localisation de l’emploi”</a></li>
  <li><a href="#scénarios-transport-en-commun" id="toc-scénarios-transport-en-commun" class="nav-link" data-scroll-target="#scénarios-transport-en-commun"><span class="toc-section-number">5.5</span>  Scénarios “transport en commun”</a></li>
  </ul></li>
  <li><a href="#bibliographie" id="toc-bibliographie" class="nav-link" data-scroll-target="#bibliographie">Bibliographie</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">MEAPS : Distribution statistique des trajets entre le domicile et le travail</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source" data-quarto-source-url="https://github.com/xtimbeau/meaps"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead"><em>version provisoire, ne pas citer, ne pas diffuser</em></p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Auteurs</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    Maxime Parodi 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            OFCE, Sciences po Paris
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    Xavier Timbeau 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            OFCE, Sciences po Paris
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Date de publication</div>
    <div class="quarto-title-meta-contents">
      <p class="date">3 janvier 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modifié</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">11 janvier 2023</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Résumé</div>
    <p>Nous proposons un modèle spatial de distribution des trajets entre emploi et résidence. En s’inspirant du modèle “intervening opportunities” de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> et du modèle radiatif de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>, nous construisons un modèle ergodique d’absorption avec priorité et saturation (MEAPS) qui permet d’expliciter complètement des contraintes traitées de façon ad hoc dans la littérature. Le modèle s’accomode de différentes formulations des processus stochastiques fondamentaux qui permettent d’en déduire une procédure d’estimation, tout en conservant un fondement microscopique solide. Une conjecture d’ergodicité, validée sur des simulations numériques, permet de réduire les coûts en temps de calcul, autorisant des applications empiriques.</p>
  </div>
</div>

</header>

<section id="introduction" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="introduction">Introduction</h2>
<p>Nous nous intéressons à la mobilité de la vie quotidienne et les facteurs qui la détermine. Pour cela nous voulons à la fois connaître le nombre de trajets qu’un individu effectue chaque jour ou chaque semaine, mais aussi quelles sont les destinations probables de ces trajets, les modes de transport employés et les temps passés à les effectuer. Cette connaissance suppose une modélisation qui fournit un certain nombre de prédictions que l’on peut confronter à l’information dont on dispose. En particulier, on ne dispose pas en général d’une information complète, même sur un échantillon, des trajets effectués pour chaque individu vers chacune des destinations possibles, pour chacun des motifs envisageables. On mesure donc soit des distributions de trajets dans la population, par motif et par mode, issues d’enquêtes de déplacement soit des nombre de trajets reliant telle commune de résidence à telle commune d’activité. L’information, quoique riche, ne couvre pas toute la complexité du phénomène considéré et la modélisation doit aider à comprendre et à quantifier le lien entre quelques paramètres fondamentaux et les observations.</p>
<p>Intuitivement, l’analyse des trajets doit permettre de relier différentes dimensions de la géographie, de l’endroit où les gens habitent, à celui où ils s’affairent, en intégrant le réseau de transport qui leur permet de se déplacer, plus ou moins rapidement, plus ou moins en sécurité, pour un coût plus ou moins important. Puisque l’espace est partagé, on s’attend à ce que la congestion ou la densité des emplois ou des résidences jouent des rôles à un moment ou un autre. La modélisation doit permettre, autant que possible, d’intégrer ces couches disparates dans un objet que l’on peut confronter aux données dont on dispose. Sur la base de cette modélisation, on doit pouvoir ensuite analyser des changements, que ce soit dans les comportements individuels, dans les masses d’emplois disponibles ou le nombre d’habitants, leur répartition spatiale, ou encore dans la structure du réseau de transport afin de construire des scénarios représentant ce qui pourrait se passer si (on changeait quelque chose). La confrontation aux données est alors une étape importante, puisqu’on veut en tirer un diagnostic sur la modélisation et apprécier le potentiel prédictif.</p>
<p>Pour modéliser les trajets entre des lieux de résidence et des lieux d’emploi, on procède usuellement par la méthode à 4 étapes <span class="citation" data-cites="patrickbonnel2001 de2011modelling">(<a href="#ref-patrickbonnel2001" role="doc-biblioref">Patrick Bonnel 2001</a>; <a href="#ref-de2011modelling" role="doc-biblioref">Dios Ortúzar et Willumsen 2011</a>)</span>. Cette méthode consiste dans un premier temps à déterminer le nombre de trajets en partance d’un lieu de résidence ainsi que ceux arrivant au total dans un lieu d’activité. C’est l’étape 1 de génération des trajets. La seconde étape consiste à distribuer les trajets de l’étape 1 entre chaque paire de départ et de destination. C’est l’étape de distribution. La troisième étape est celle du choix modal, où pour chaque trajet (entre chaque origine et chaque destination) considéré se voit affecté un mode de transport. Enfin la quatrième étape du modèle à 4 étapes est celle qui spécifie le trajet et permet d’en connaître les caractéristiques précises, comme la distance parcourue, les axes employées ou les dénivelés effectués. Cette décomposition est un peu arbitraire. Le nombre de trajets effectué dépend en effet des possibilités ouvertes par la géographie qui sont définies par les caractéristiques précises des trajets. L’étape 4 est donc nécessaire pour comprendre l’étape 1, et l’étape 4 demande de connaître les choix modaux pour être utile aux choix fait en 1. L’étape 2 est nécessaire pour explorer les possibilités de trajets. Les imbrications sont nombreuses entre les étapes et la décomposition n’implique pas l’indépendance.</p>
<p>Nous développons ici un modèle qui permet de distribuer les trajets qui ont été assignés en première étape. Le modèle gravitaire est employé généralement dans cette deuxième étape pour prendre en compte le rôle de la distance. Plus un emploi est loin, moins il doit être attractif. Un individu doit donc préférer les emplois près de lui à ceux qui sont éloignés.</p>
<p>Nous discutons dans une première partie des insuffisances du modèle gravitaire (<a href="#sec-grav">Section&nbsp;1</a>), puis nous comparons le modèle gravitaire à celui de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> et de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> qui font intervenir le rang de classement des emplois plutôt que la distance (<a href="#sec-rad">Section&nbsp;2</a>). Nous présentons alors une version étendue de ce modèle “radiatif” qui permet deux résultats principaux : 1. au lieu de la distance, c’est le nombre d’emplois accessibles dans un cercle de rayon donné qui détermine le choix individuel. 2. nous explicitons la saturation et nous donnons un fondement microscopique au respect des contraintes aux marges (tout individu a un emploi, tout emploi est occupé par un individu) (<a href="#sec-meaps">Section&nbsp;3</a>). La formulation est probabiliste et nous en analysons quelques propriétés par des simulations synthétiques (<a href="#sec-synt">Section&nbsp;4</a>). Nous proposons ensuite une application à l’agglomération de la Rochelle (<a href="#sec-rochelle">Section&nbsp;5</a>).</p>
</section>
<section id="sec-grav" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="sec-grav"><span class="header-section-number">1</span> Les insuffisances du modèle gravitaire</h2>
<p>Le modèle gravitaire est employé très fréquemment en économie spatiale <span class="citation" data-cites="handbook2007">(<a href="#ref-handbook2007" role="doc-biblioref">Hensher et Button 2007, chap. 2</a>)</span>. Il semble en effet répondre de façon satisfaisante au premier principe de Tobler (Tout est relié mais les choses proches sont plus reliées que les choses éloignées). Il s’appuie également sur une analogie avec le modèle de la gravitation dont les succès en physique et en mécanique sont immenses. Ce modèle est généralement la pierre angulaire de l’étape de distribution des trajets dans la décomposition à 4 étapes des modèles de transport <span class="citation" data-cites="de2011modelling patrickbonnel2001">(<a href="#ref-de2011modelling" role="doc-biblioref">Dios Ortúzar et Willumsen 2011</a>; <a href="#ref-patrickbonnel2001" role="doc-biblioref">Patrick Bonnel 2001, 160</a>)</span>. Il est également utilisé dans d’autres domaines, comme le commerce international ou l’analyse des épidémies, domaines que nous ne discuterons pas ici.</p>
<section id="les-mauvaises-raisons-du-succès-du-modèle-gravitaire" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="les-mauvaises-raisons-du-succès-du-modèle-gravitaire"><span class="header-section-number">1.1</span> Les (mauvaises) raisons du succès du modèle gravitaire</h3>
<p>Formellement, le modèle gravitaire décrit la force d’une relation entre deux objets en fonction de leur distance et de leur masse respective. Par analogie, le modèle gravitaire consiste ici à évaluer le nombre de trajets professionnels entre deux localisations en prenant pour masses le nombre d’habitants au point de départ et le nombre d’emplois au point d’arrivée et, pour distance, une fonction <span class="math inline">f</span> croissante de la distance. On a ainsi, en indiçant les points de départ par <span class="math inline">i</span> et les points d’arrivée par <span class="math inline">j</span> :</p>
<p><span id="eq-gravity"><span class="math display">
T_{i,j} = \frac {N_{hab, i}\times N_{emp, j}} {f(d_{i,j})}
\tag{1}</span></span></p>
<p>Les premiers modèles gravitaires ont emprunté la fonction <span class="math inline">f</span> à la physique newtonienne (<span class="math inline">f=1/d^2</span>), mais d’autres formulations ont depuis été proposées. Par exemple, la fonction <span class="math inline">f=e^{-d/\delta}</span> intervient dans les modèles de choix discrets proposés par McFadden <span class="citation" data-cites="ben-akiva2018">(<a href="#ref-ben-akiva2018" role="doc-biblioref">Ben-Akiva et Lerman 2018</a>)</span>. En remplaçant la distance par la notion de coût généralisé du transport, on peut relier cette forme fonctionnelle à un modèle de choix avec une fonction d’utilité aléatoire (random utility model). Il est également possible d’ajuster des formes fonctionnelles plus complexes en ajoutant des paramètres. Le modèle gravitaire arrive alors à reproduire des distributions de distances observées dans des enquêtes de transport menées de par le monde. Un raisonnement par minimisation de l’entropie a été proposé par <span class="citation" data-cites="wilson1967">Wilson (<a href="#ref-wilson1967" role="doc-biblioref">1967</a>)</span> pour donner un fondement théorique à l’<a href="#eq-gravity">équation&nbsp;1</a>. Le raisonnement est de considérer l’état de référence comme étant celui qui est le plus fréquent dans une distribution aléatoire des choix. <span class="citation" data-cites="wilson1967">Wilson (<a href="#ref-wilson1967" role="doc-biblioref">1967</a>)</span> montre alors que, si la fonction <span class="math inline">f</span> est donnée, l’<a href="#eq-gravity">équation&nbsp;1</a> a bien la forme proposée et que c’est le produit des habitants et des emplois qui doit se trouver au numérateur (et non une puissance de l’un ou l’autre par exemple). Mais rien ne permet de trouver un fondement à la forme fonctionnelle de <span class="math inline">f</span>. Le parallèle avec la physique est simple à faire : l’interaction définit le rôle de la distance, la maximisation de l’entropie permet d’en déduire que l’équation macroscopique dépend des masses agrégées, mais ne permet de dire quoique ce soit de plus sur la nature de l’interaction.</p>
<p>Comme le notent <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>, les fondations théoriques et empiriques de la fonction <span class="math inline">f</span> sont donc faibles. La multiplication des paramètres pour améliorer l’ajustement n’ont le plus souvent aucune justification théorique. De fait, on est parfois plus proche d’un exercice d’interpolation des données que d’un exercice de modélisation où les paramètres ont une signification explicite. Les comportements asymptotiques soulignent également des incohérences : par exemple, en faisant tendre vers l’infini les emplois à l’arrivée, le modèle prédit un nombre infini de trajets, même si le nombre de résidents au départ est limité ! Il est également insatisfaisant que le modèle gravitaire soit déterministe et ne permette ni d’expliquer les fluctuations statistiques du nombre de trajets prédits, ni d’évaluer la vraisemblance de différents cas empirique.</p>
<p>Mais la critique la plus forte du modèle gravitaire vient de ses propriétés fondamentales et des conclusions que l’on peut en tirer. Le nombre de trajets entre une origine (la résidence) et une destination (l’emploi) repose sur un simple arbitrage entre distance et quantité de résidents ou d’emplois. Le comportement du modèle aux limites, à nouveau, suscite la perplexité : un seul emploi à l’origine devrait être infiniment préféré un très grand nombre d’emplois un peu plus loin. C’est tout à fait irréaliste et l’on devine déjà que la distance ne joue pas un rôle si direct dans les comportements de mobilité. On voit également que le poids relatif de cet emploi quasi central par rapport aux “masses” d’emplois éloignés va varier de manière irréaliste selon qu’il est plus ou moins proche de l’origine.</p>
<p>Comme le soulignait déjà <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span>, ce n’est peut-être pas tant la distance aux emplois qui est décisive que le rang de ces emplois selon l’ordre des distances. Dans le modèle gravitaire, il faut faire une grande différence entre le cas où le deuxième emploi le plus proche est à 500 m et le cas où il est à 1 km. Si l’on applique le modèle newtonien, il faudrait croire, par exemple, que l’attractivité de ce dernier emploi est divisée par 4. Qui peut croire que les 500 m de différence pèsent d’un si grand poids dans une recherche d’emploi ? L’attractivité de l’emploi dépend avant tout du fait qu’il s’agit du deuxième emploi disponible près de chez soi. Empiriquement, il y a peu de doutes que le modèle gravitaire a de piètres performances : il ne parvient pas à expliquer pourquoi, lorsque la densité des emplois est faible autour d’un résident, celui-ci va envisager des trajets plus long pour atteindre des zones denses en emplois ; c’est pourtant une observation très commune qui devrait se retrouver dans une modélisation adéquate.</p>
<p>Assez peu de publications se risquent à une comparaison systématique du modèle gravitaire avec d’autres formulations qui respecteraient la première loi de Tobler. On peut citer <span class="citation" data-cites="heanue1966">Heanue et Pyers (<a href="#ref-heanue1966" role="doc-biblioref">1966</a>)</span> comme une des rares tentatives de ce genre. Le modèle gravitaire semblait moins bon que le modèle des intervening opportunities (voir plus loin) s’il n’était pas ajusté de manière ad hoc, comme il est devenu usuel.</p>
<p><span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> donnent quelques exemples pour les Etats-Unis de la difficulté du modèle gravitaire à reproduire les comportements habituels. A l’évidence, le modèle gravitaire ne prédit que des destinations proches et néglige complètement les destinations lointaines. Il semble impossible à la forme fonctionnelle <span class="math inline">f(d_{ij})</span> de rendre compte empiriquement à la fois du nombre de trajets courts et du nombre de trajets distants au travers d’un modèle susceptible de rendre compte des trajets dans différentes régions, dès lors que les densités y sont distribuées différemment.</p>
</section>
<section id="le-voile-de-la-contrainte-aux-marges" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="le-voile-de-la-contrainte-aux-marges"><span class="header-section-number">1.2</span> Le voile de la contrainte aux marges</h3>
<p>Le modèle gravitaire peut être complexifié pour mieux coller aux données qu’il ne le fait spontanément. Il perd alors tout lien avec les réflexions théoriques le reliant à la maximisation de l’entropie <span class="citation" data-cites="wilson1967">(<a href="#ref-wilson1967" role="doc-biblioref">Wilson 1967</a>)</span> ou au modèle de choix discrets. L’ajustement du modèle devient un exercice d’interpolation, en s’efforçant de coller autant que possible aux données, sans plus tester réellement un modèle à l’aide de tests de vraisemblance. L’exercice consiste ainsi à ajouter une étape de “normalisation” au modèle en incorporant dans le modèle des coefficients correctifs en ligne et en colonne dans la matrice origine-destination, ce qui revient à ajouter des effets fixes à chacun des points de départ et d’arrivée. La formulation du modèle gravitaire est alors modifiée comme suit :</p>
<p><span id="eq-gravmod"><span class="math display">
T_{i,j} = a_i \times b_j \times \frac {N_{hab, i}\times N_{emp, j}} {f(d_{i,j})}
\tag{2}</span></span></p>
<p>La détermination des coefficients <span class="math inline">a_i</span> et <span class="math inline">b_j</span> pose de nombreux problèmes. Ces coefficients doivent permettre de respecter les contraintes aux marges (la somme des emplois pour une ligne de résidents doit être égale au nombre des résidents employés dans la zone et la somme des résidents employés sur un lieu d’emploi doit, en colonne donc, être égale au nombre d’emplois en ce lieu) sur les déplacements. On a pour <span class="math inline">a_i</span> :</p>
<p><span id="eq-ai"><span class="math display">
a_i = \frac {\Sigma_j T_{i,j}} {\Sigma_j \frac {b_j \times N_{hab, i} \times N_{emp, j}}{f(d_{i,j})}}
\tag{3}</span></span></p>
<p><span class="math inline">\Sigma_j T_{i,j}</span> est généralement directement observé ou estimé lors de l’étape de génération dans les approches dites à 4 étapes. C’est le nombre de départs depuis le point <span class="math inline">i</span> et il est proportionnel aux nombre d’actifs résidant en <span class="math inline">i</span>. De la même façon on peut écrire pour <span class="math inline">b_j</span> une expression symétrique de celle de <span class="math inline">a_i</span>, qui fait intervenir <span class="math inline">\Sigma_i T_{i,j}</span> qui est également observée ou estimé auparavant. C’est le nombre de trajets convergeant vers le point d’arrivée <span class="math inline">j</span>, qui est proportionnel au nombre d’emplois en <span class="math inline">j</span>.</p>
<p><span id="eq-bj"><span class="math display">
b_j = \frac {\Sigma_i T_{i,j}} {\Sigma_i \frac {a_i \times N_{hab, i} \times N_{emp, j}}{f(d_{i,j})}}
\tag{4}</span></span></p>
<p>La valeur de <span class="math inline">a_i</span>, pour un <span class="math inline">i</span> donné, dépend de l’évaluation de tous les <span class="math inline">b_j</span> et réciproquement l’évaluation de chaque <span class="math inline">b_j</span> dépend de celle de tous les <span class="math inline">a_i</span>. On peut estimer ces coefficients par itérations successives et espérer atteindre de cette manière un point fixe, éventuellement unique à une constante multiplicative près. Des algorithmes de résolution ont donc été proposés dans les principaux manuels (voir par exemple <span class="citation" data-cites="de2011modelling">Dios Ortúzar et Willumsen (<a href="#ref-de2011modelling" role="doc-biblioref">2011</a>)</span>, chapitre 5). L’application de tels algorithmes (comme celui de Furness, <span class="citation" data-cites="de2011modelling">Dios Ortúzar et Willumsen (<a href="#ref-de2011modelling" role="doc-biblioref">2011</a>)</span>, p.&nbsp;192) peut toutefois modifier considérablement le résultat initial proposé par le modèle gravitaire, au risque d’en trahir la logique et les justifications initiales. En outre, la multiplicité des solutions et le choix retenu par l’algorithme demeure un angle mort de ces méthodes.</p>
<p>Mais surtout, cette procédure itérative se contente de multiplier par des facteurs arbitraires des lignes et des colonnes de la matrice origine-destination. Ceci ne change donc pas les poids relatifs des nombres de déplacements depuis une origine ou vers une destination. Or, si l’on pense que le modèle gravitaire estime mal ces poids relatifs, comme nous l’avons affirmé ci-dessus, alors cette normalisation ne change rien sur le fond : une destination éloignée est si fortement pénalisée dans le modèle gravitaire qu’aucun facteur multiplicatif ne peut faire remonter le nombre de trajets vers cette destination, sans faire crever le plafond au nombre de trajets plus proches. La procédure de respect des marges aurait pu être formulée différemment, par exemple en utilisant des corrections additives au lieu de corrections multiplicatives ou une combinaison d’additivité et de multiplicativité. Chacune de ces procédures manque toutefois de fondement théorique et, en toute généralité, peuvent conduire à des équilibres multiples que l’algorithme de résolution va sélectionner sans que l’on puisse justifier quoi que ce soit.</p>
<p>Le succès du modèle gravitaire découle en partie de cette “plasticité” opérationnelle qui permet de l’appliquer à des observations en respectant certaines contraintes observées tout en laissant croire qu’un fondement théorique continue de justifier les opérations. Aussi l’approche gravitaire est-elle largement reprise dans des modèles appliquées (notamment les modèles LUTI) en dépit de ses défauts, peut-être faute de mieux. Mais le décalage avec les données rend urgent de dépasser cette approche qui “survit” en se transformant en boîte noire.</p>
</section>
</section>
<section id="sec-rad" class="level2 page-columns page-full" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-rad"><span class="header-section-number">2</span> Une première alternative : le modèle radiatif</h2>
<div class="page-columns page-full"><p>Le modèle radiatif est l’une des rares alternatives au modèle gravitaire <span class="citation" data-cites="de2011modelling">(<a href="#ref-de2011modelling" role="doc-biblioref">Dios Ortúzar et Willumsen 2011</a>)</span>. Il reprend les intuitions de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> avec son modèle des “intervening opportunities”, dont la logique est la suivante : un migrant prévoit d’aller dans un endroit distant mais trouve en chemin des opportunités ; il s’interrompt alors en chemin. Cette distraction de son objectif initial est le résultat des opportunités rencontrées en chemins, “intervenantes”. La différence avec le modèle gravitaire est que ce n’est pas la distance qui détermine la destination, mais le nombre de rencontres. La distance et la structure géographique continuent de peser indirectement sur le choix des destinations puisque plus le migrant parcourt une grande distance, plus il a de chances de rencontrer des opportunités. La modélisation initiale de Stouffer souffre toutefois de quelques défauts<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> et ne résout pas les questions de capacité ou de respect des contraintes sur les marges. Mais elle ouvre une autre perspective, où le rôle de la distance est médiatisé par le nombre d’opportunités rencontré.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;Notamment des défauts dans la formalisation qui repose sur une série d’approximation pas toujours explicitées et qui rend le modèle peu manipulable.</p></li></div></div>
<p>Avec Stouffer, c’est ainsi une autre métrique qui est proposée en lieu et place de la simple distance spatiale. Elle est liée à la notion d’accessibilité, c’est-à-dire au nombre d’emplois (et plus généralement d’opportunités) auxquels à accès un individu pour un temps de trajet ou une distance maximaux fixés. Un emploi apparaît ainsi d’autant plus “éloigné” d’un individu qu’il y a d’emplois plus proches de lui. Le modèle gravitaire posait que les individus font une grande différence entre le cas où le deuxième emploi disponible est à 500 m et celui où cet emploi est à 1 km. Dans la nouvelle perspective, il n’y a pas de différence car il s’agit toujours du second emploi rencontré. Autrement dit, la distance est relativisée par la prise en compte du milieu qui est traversé. Plus le milieu est riche en opportunités, moins il est nécessaire d’aller loin et, inversement, plus le milieu est désert, plus il faut accepter d’aller loin.</p>
<p>La proposition de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> répond à certaines failles de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> en proposant un modèle déduit par analogie avec la physique qui explicite le processus sous-jacent. L’appellation vient du modèle radiatif qui décrit l’émission de particules et leur absorption par le milieu qu’elle traverse. L’intuition est la même que celle de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> : tant qu’une particule ne rencontre pas d’obstacle, elle poursuit son chemin. Elle ne s’arrête qu’en rencontrant un site qui peut l’absorber. Plus le milieu est dense en obstacles, plus la particule a des chances de s’arrêter. Dans ce modèle, la distribution des distances parcourues dépend du milieu et de la quantité de sites d’absorption rencontrés.</p>
<p>Plus précisément, dans le modèle de radiation, chaque particule est tirée aléatoirement d’une distribution de probabilité avec une caractéristique <span class="math inline">z</span>. Chaque point d’absorption, qui représente un lieu possible de travail, possède une masse d’emploi <span class="math inline">n_i</span> et se voit attribuer une caractéristique <span class="math inline">z_i</span> qui est aléatoire. Les lieux possibles sont classés par ordre de distance, comme dans le modèle de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> et la particule les rencontre dans cet ordre. Le tirage de <span class="math inline">z_i</span> est construit en tirant <span class="math inline">n_i</span> fois des <span class="math inline">z</span> dans la distribution de probabilité et en prenant le maximum de ces <span class="math inline">z</span>. Plus la masse est grande en <span class="math inline">i</span>, plus le <span class="math inline">z_{max}</span> sera grand. La particule émise est absorbée si son <span class="math inline">z</span> est plus petit que <span class="math inline">z_i</span>. Pour représenter que la particule sera émise si elle n’est pas absorbée par son point de départ, son propre <span class="math inline">z</span> est tiré par la même méthode, c’est-à-dire le maximum de <span class="math inline">m_i</span> tirages où <span class="math inline">m_i</span> est la masse d’opportunités en <span class="math inline">i</span>.</p>
<p>Le résultat principal de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> est particulièrement élégant. La valeur moyenne (notée <span class="math inline">\langle T_{i,j}\rangle</span> ) des trajets partant de <span class="math inline">i</span> et allant en <span class="math inline">j</span> a une expression qui ne dépend pas de la distribution de probabilité des <span class="math inline">z</span>. Elle prend l’expression suivante, où <span class="math inline">s_{i,j}=\Sigma_{k \in (i \rightarrow j)^*} n_k</span>, la somme des opportunités entre <span class="math inline">i</span> (non inclus) et <span class="math inline">j</span> (non inclus) :</p>
<p><span id="eq-rad"><span class="math display">
\langle T_{i,j}\rangle = T_i \times \frac {m_i \times n_j}{(m_i + s_{i,j}) \times (m_i + n_i +s_{i,j})}
\tag{5}</span></span></p>
<p>A partir d’hypothèses générales assez simples, on obtient une formulation qui s’apparente au modèle gravitaire en remplaçant la distance par l’accumulation des opportunités entre deux points, dès lors que les opportunités sont classées dans l’ordre des distances. Cette formulation respecte autant que le modèle gravitaire le premier principe de Tobler, mais elle repose sur des hypothèses explicites et permet de mieux représenter les phénomènes déjà évoqués. Un départ dans une zone peu dense produira des trajets plus longs pour trouver un nombre équivalent d’opportunités à des trajets plus courts dans une zone dense. De plus, aucune étape de “normalisation” ad hoc n’est requise et le modèle est probabiliste, ce qui permet de produire des marges d’erreurs et des tests empiriques.</p>
<p>Les applications du modèle radiatif à des données diverses (mouvements pendulaires travail-domicile, appels téléphoniques, migrations, logistique) produisent des distributions de trajets plus proches des données que le modèle gravitaire, mettant à mal l’adage selon lequel le modèle gravitaire serait un “bon” modèle, validé par les données.</p>
<p>On notera que le modèle de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> admet comme cas limite le modèle gravitaire. En effet, lorsque la densité d’emplois est uniforme dans le plan, alors l’accumulation des opportunités est proportionnelle à la surface et la moyenne de trajets entre <span class="math inline">i</span> et <span class="math inline">j</span> est une fonction en <span class="math inline">1/r^4</span>. Ce cas limite montre sous quelle condition (très particulière) le modèle gravitaire peut être valide.</p>
<p>Il subsiste deux défauts au modèle radiatif de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>. Le premier est le pendant de son élégance : il n’y a pas de paramètres pour l’ajuster, ce qui limite les capacités du modèle à rendre compte de la richesses des données. Si l’on veut un modèle de base simple et clair sur le plan conceptuel, on veut aussi pouvoir enrichir le modèle avec des paramètres qui auraient du sens. Or la seule proposition qu’ils font dans ce sens, en introduisant un <span class="math inline">\varepsilon</span> pour modifier le poids du point de départ dans le choix des trajets n’y répond que très partiellement.</p>
<p>Le second défaut est que le modèle ne traite pas le respect des contraintes aux marges, en particulier en colonne. Dans l’<a href="#eq-rad">équation&nbsp;5</a> le terme <span class="math inline">T_i</span> représente le nombre de départs de <span class="math inline">i</span>. Il joue le rôle des coefficients <span class="math inline">a_i</span> dans le modèle gravitaire sous une forme multiplicative simple. Son interprétation est directe et simple. En revanche, il n’existe pas de pendant aux coefficients <span class="math inline">b_j</span> et il n’est donc pas possible au modèle de tenir compte d’une contrainte capacitaire : un nombre de particules supérieur au nombre d’emplois peuvent être absorbées en <span class="math inline">j</span>.</p>
</section>
<section id="sec-meaps" class="level2 page-columns page-full" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-meaps"><span class="header-section-number">3</span> Un modèle ergodique d’absorption avec priorité et saturation (MEAPS)</h2>
<p>Nous proposons maintenant une version étendue et remaniée de l’approche de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> qui répond aux critiques que nous faisons au modèle de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>. Dans cette section, nous présentons le modèle dans sa forme plus simple avant d’en exposer les extensions les plus directes. Des simulations synthétiques permettent alors d’apprécier les grandes lignes du fonctionnement de ce modèle. Nous discutons ensuite des procédures d’estimation envisageables ainsi que du développement de mesures issues de ce modèle.</p>
<section id="rang-choix-des-destinations-et-absorption" class="level3 page-columns page-full" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="rang-choix-des-destinations-et-absorption"><span class="header-section-number">3.1</span> Rang, choix des destinations et absorption</h3>
<div class="page-columns page-full"><p>On considère <span class="math inline">I</span> individus et <span class="math inline">J</span> emplois<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> localisés sur un territoire. Ces localisations sont fixes et exogènes, ce qui signifie que l’on ne s’intéresse pas au problème de choix de localisation. Non que ce choix ne soit pas important, mais nous nous intéressons à la distribution des trajets, une fois fixées les localisations. L’idée est que pour déterminer le choix de localisation, il faudra prendre en compte ce que la distribution des trajets, leur longueur ou le coût généralisé qui leur est associé, nous apprend.</p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;Dans ce qui suit on regarde la relation entre résident et emploi ce qui suggère les mobilités domicile travail. C’est principalement pour fixer les idées, mais la relation entre résident et tout type d’aménités peut être abordée de la même façon. Il est également possible de décliner les résident selon des caractéristiques observables et d’indexer le modèle par ces catégories.</p></li></div></div>
<p>On suppose que toutes les localisations sont séparées et qu’il n’y a donc qu’un individu ou qu’un emploi par localisation (les emplois et les individus peuvent être au même endroit, ça ne change rien). Chaque individu <span class="math inline">i</span> classe par ordre de distance croissante les <span class="math inline">J</span> emplois et les examine dans cet ordre. Il a à chaque fois une probabilité <span class="math inline">p_a</span> de prendre l’emploi. Tant qu’il n’est pas pris, il continue sa recherche en passant à l’emploi suivant le plus proche (de son point de départ). La probabilité d’occuper l’emploi <span class="math inline">j</span> est donc égale à la probabilité de ne pas occuper les emplois plus proches multipliée par la probabilité <span class="math inline">p_a</span> d’occuper le poste <span class="math inline">j</span>. En notant <span class="math inline">r_{i}(j)</span> le rang de l’emploi <span class="math inline">j</span> dans le classement des distances depuis <span class="math inline">i</span>, on peut écrire <span class="math inline">\bar F(j)</span> la probabilité de dépasser le <span class="math inline">jème</span> élément :</p>
<p><span id="eq-fbar"><span class="math display">
\bar F(j)=(1-p_a)^{r_i(j)}
\tag{6}</span></span></p>
<p>On définit également la probabilité de fuite de la zone considérée. Cette probabilité est celle qu’un individu ne trouve pas parmi les <span class="math inline">J</span> emplois celui qui lui convient et donc qu’il renonce ou cherche plus loin. En supposant pour le moment que cette probabilité est la même pour tous les individus, <span class="math inline">p_f</span>, on peut déterminer <span class="math inline">p_a</span> :</p>
<p><span id="eq-pa"><span class="math display">
p_a = 1-(p_f)^{1/J}
\tag{7}</span></span></p>
<p>La probabilité <span class="math inline">P_i(j)</span> de <span class="math inline">i</span> de s’arrêter en <span class="math inline">j</span> est :</p>
<p><span id="eq-pij"><span class="math display">
P_i(j) = (1-p_a)^{r_i(j)-1} \times p_a = {p_f}^{\frac {r_i(j)-1} {J}} \times (1-{p_f}^{1/J})
\tag{8}</span></span></p>
<p>Cette expression définit donc la probabilité pour un individu <span class="math inline">i</span> d’occuper l’emploi <span class="math inline">j</span> comme une fonction de la probabilité de fuite, le rang de l’emploi et le nombre total d’emploi. La rang de <span class="math inline">j</span> n’est autre que le nombre d’opportunités cumulées du point de départ de <span class="math inline">i</span> jusqu’à <span class="math inline">j</span> et remplace la distance, comme dans les expressions de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> ou de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>. Ce nombre n’est autre que l’accessibilité aux emplois de l’individu <span class="math inline">i</span> dans un cercle de rayon <span class="math inline">[ij]</span>.</p>
<p>Chaque emploi a été supposé distinct spatialement des autres. Dans le cas où les emplois ne seraient pas séparés et pourraient s’accumuler en un point ou au sein d’un carreau, la formalisation ne change pas.</p>
<p>La probabilité que l’on s’arrête dans le carreau <span class="math inline">c_d</span> situé à une distance <span class="math inline">d</span> de <span class="math inline">i</span> où se trouvent <span class="math inline">k</span> emplois se déduit de l’<a href="#eq-fbar">équation&nbsp;6</a> puisque les <span class="math inline">k</span> emplois ont des rangs successifs. En notant <span class="math inline">s_i(d)=\sum _{j/d_{i,j}&lt;d}1</span> le cumul de tous les emplois qui sont à une distance strictement inférieure à celle du carreau considéré pour <span class="math inline">i</span> (et donc à l’exclusion des <span class="math inline">k</span> emplois du le carreau <span class="math inline">c_d</span>), on a :</p>
<p><span id="eq-picd"><span class="math display">
P_i(i\in c_d) = {p_f}^{s_i(d)/J}\times(1-{p_f}^{ k/J})
\tag{9}</span></span></p>
<p>En prenant un développement limité au 1<sup>er</sup> ordre de cette expression (sous l’hypothèse que <span class="math inline">k</span> est petit devant le nombre total d’opportunités <span class="math inline">J</span>) , on obtient, en notant <span class="math inline">\mu=\frac{-log(p_f)}{J}</span> :</p>
<p><span id="eq-picddl"><span class="math display">
P_i(i\in c_d) \approx k\times \mu \times e^{-\mu \times s_i(d)}
\tag{10}</span></span></p>
<p>Cette expression fait apparaître clairement le cœur du modèle. La proportion d’emplois venant de <span class="math inline">i</span> dans le carreau est une fonction des emplois dans le carreau multiplié par l’accessibilité jusqu’à ce carreau de <span class="math inline">i</span>.</p>
<div class="page-columns page-full"><p>Lorsque la densité des emplois est constante sur un plan, <span class="math inline">s_i(d)</span> est proportionnel à la surface et le modèle devient une fonction de la distance avec un terme en <span class="math inline">e^{-r^2/\rho^2}</span>. Ici aussi, le comportement de notre modèle rejoint, sous cette condition très particulière d’une répartition homogène des opportunités, celui proposé pour un modèle gravitaire, lorsque celui-ci est spécifié avec une fonction de distance en <span class="math inline">e^{-r/\rho}</span>. La forme favorite du modèle gravitaire se justifierait pour une répartition homogène des opportunités le long d’une droite<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Ce résultat diffère de celui de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>, qui trouvaient un comportement asymptotique en <span class="math inline">1/r^4</span>.</p><div class="no-row-height column-margin column-container"><li id="fn3"><p><sup>3</sup>&nbsp;La littérature sur le commerce international fait un grand usage du modèle gravitaire et on y trouve des développements très riches. Le problème du commerce international est un peu différent de celui de l’analyse des distribution de déplacement parce qu’on observe les flux bilatéraux par produit de façon répétée entre les pays. On dispose ainsi d’une grande quantité d’informations à relier entre elles par la représentation gravitaire. La question du transport est différente en ce que la distance entre origines et destination est bien connue, mais que les trajets bilatéraux ne le sont pas. On dispose en revanche d’information sur la distribution des trajets en fonction de leur distance, de leur motif et des modes employés.</p></li></div></div>
<p>Tout comme dans le modèle de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>, le résultat est sans paramètre, parce que la probabilité de fuite est entièrement déterminée par la contrainte en ligne (l’individu <span class="math inline">i</span> a une espérance égale à 1 - <span class="math inline">p_f</span> de trouver un emploi dans la zone considérée).</p>
</section>
<section id="sec-priorite" class="level3 page-columns page-full" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="sec-priorite"><span class="header-section-number">3.2</span> Saturation et priorité</h3>
<div class="page-columns page-full"><p>Il reste encore à prendre en compte la contrainte en colonne, c’est-à-dire le fait que chaque emploi peut être pourvu une fois et une seule. Au lieu d’un ajustement ad hoc qui tombe de nulle part, nous proposons le mécanisme suivant de remplissage des emplois : chaque individu <span class="math inline">i</span> est classé selon un ordre de priorité. L’individu au premier rang est confronté à l’ensemble des emplois et nous calculons ses probabilités de prendre un emploi <span class="math inline">j</span> par la formule précédente (<a href="#eq-pij">équation&nbsp;8</a>). Les emplois sont alors partiellement remplis à proportion de ces probabilités<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. Le deuxième individu est traité de la même manière, et ainsi de suite, jusqu’à ce qu’un ou plusieurs emplois soient totalement pourvu (lorsque la somme des probabilités dépasse tout juste 1). On retire alors ces emplois de la liste des choix possibles et on continue l’affectation pour les individus suivants sur la liste réduite. A chaque individu ajouté, on peut être amené à retirer d’autres emplois de la liste de recherche.</p><div class="no-row-height column-margin column-container"><li id="fn4"><p><sup>4</sup>&nbsp;En toute rigueur, les probabilités ne s’additionnent pas si simplement et un traitement exact exigerait de tenir compte de probabilités conditionnelles au fait que tel emploi a été pris, ou non, auparavant. La procédure décrite ici est une simplification, en subsituant aux probabilités conditionnelles des espérances.</p></li></div></div>
<p>A la fin de ce processus, tous les individus ont des emplois (à <span class="math inline">p_f</span> près) et tous les emplois sont pourvus dès lors que l’on pose <span class="math inline">I \times p_f = J</span>. Cette attribution avec priorité est Pareto-optimale. Il n’est pas possible d’augmenter la satisfaction d’un individu sans dégrader celle d’un autre. A chaque étape, chaque individu réalise ses choix sans contrainte autre que l’éventuelle saturation provoquée par ses prédécesseurs. Pour augmenter sa satisfaction, c’est-à-dire lui permettre d’occuper en probabilité un emploi mieux classé pour lui, il faudrait dégrader la situation d’un prédécesseur en lui attribuant un emploi plus éloigné pour lui. Cette procédure d’affection avantage les premiers du classement, mais tient compte des choix de chacun.</p>
<p>Formellement, on note <span class="math inline">\phi_u(i,j)</span> la probabilité de disponibilité (<span class="math inline">\phi</span> vaut 0 si l’emploi est complètement pris) de l’emploi <span class="math inline">j</span> pour un ordre de priorité donné <span class="math inline">u</span> au moment où l’individu <span class="math inline">i</span> doit choisir. La probabilité de cet individu <span class="math inline">i</span> de prendre l’emploi <span class="math inline">j</span> s’écrit alors :</p>
<p><span id="eq-puij"><span class="math display">
P_{u, i}(j) = \lambda_{u,i}.\phi_u(i,j). p_a \prod_{l=1}^{r_i^{-1}(j)-1}(1-\lambda_{u,i}. \phi_u(i,r^{-1}(l)).p_a)
\tag{11}</span></span></p>
<p>Cette expression est rendue complexe par la nécessité de parcourir les emplois dans l’ordre qui correspond à chaque individu. La probabilité <span class="math inline">p_a</span> doit alors être calculée pour que le taux de fuite de <span class="math inline">i</span> soit inchangé. On suppose que les emplois restants demeurent homogènes tout au long du processus d’affectation. La probabilité de chacun est donc identique et ajustée d’un facteur multiplicatif <span class="math inline">\lambda_{u,i}</span>. Le terme <span class="math inline">\lambda_{u,i}</span> découle ainsi de l’indisponibilité potentielle des emplois. Lorsqu’un emploi est indisponible, l’individu <span class="math inline">i</span>, lorsque c’est son tour de choisir, connait ses cibles potentielles. Il ajuste donc sa probabilité d’absorption de façon à respecter la probabilité de fuite. Nous choisissons cette option afin de continuer à respecter la contrainte en ligne, qui s’exprime par l’<a href="#eq-lambda">équation&nbsp;12</a> ci-dessous. Ceci signifie qu’un individu a d’autant plus de chances d’accepter un emploi qu’il reste peu de choix.</p>
<div class="page-columns page-full"><p>Une autre solution serait de considérer que la probabilité de fuite n’est pas conservée et que les indisponibilités se traduisent par une fuite plus élevée. On peut tout à fait envisager des solutions plus complexes. Nous nous en tenons pour l’instant au cas simple où tous les individus ont la même chance de travailler dans la zone considérée<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. Sous cette hypothèse de conservation de la probabilité de fuite, on a :</p><div class="no-row-height column-margin column-container"><li id="fn5"><p><sup>5</sup>&nbsp;En pratique, pour éviter les effets de bord, il faut choisir une zone d’emplois plus grande que la zone des résidents.</p></li></div></div>
<p><span id="eq-lambda"><span class="math display">
\prod_{j=i} ^{J} (1-\lambda_{u,i} \times \phi_u(i,j) \times p_{a})= p_f
\tag{12}</span></span></p>
<p>La solution de cette équation est celle d’un polynôme en <span class="math inline">\lambda_{u,i}</span> d’un ordre élevé. Il y a possiblement plusieurs solutions, mais il est nécessaire que <span class="math inline">0&lt;\lambda_{u,i}\times p_a&lt;1</span>, ce qui réduit le nombre de solutions admissibles. On peut en produire une solution approchée par un développement limité à l’ordre 1 en prenant le <span class="math inline">log</span> de l’<a href="#eq-lambda">équation&nbsp;12</a> :</p>
<p><span id="eq-lambdadl"><span class="math display">
p_{a} \times \lambda_{u,i} = \frac {-log(p_f)}{\sum_{j=1} ^{J} \phi_u(i,j)}
\tag{13}</span></span></p>
<p>On peut vérifier que <span class="math inline">0&lt;\lambda_{u,i}\times p_a&lt;1</span> lorsque <span class="math inline">J</span> est assez grand et que le nombre d’emplois restant demeure élevé (en probabilité) par rapport à <span class="math inline">-log(p_f)</span>.</p>
</section>
<section id="sec-erg" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="sec-erg"><span class="header-section-number">3.3</span> Ergodicité</h3>
<p>Chaque ordre de priorité <span class="math inline">u</span> définit une trajectoire possible d’affectation des emplois aux résidents (ou l’inverse). On aboutit à chaque fois à un état possible de l’appariement résidents-emplois d’où l’on déduit les trajets professionnels. Bien entendu, le résultat final dépend de l’ordre de priorité choisi. Pour s’en affranchir, la stratégie usuelle en physique statistique consiste à réitérer la procédure pour tous les ordres possibles de priorité et à considérer la moyenne des résultats obtenus sur les <span class="math inline">I!</span> ordres de priorité possibles.</p>
<p>L’hypothèse ergodique consiste ici à soutenir que cette moyenne sur tous ces ordres de priorité est proche du régime permanent des trajets professionnels sur la zone considérée.</p>
<p>La première grandeur que nous moyennons sur les ordres <span class="math inline">u</span> est la variable de disponibilités <span class="math inline">\phi_u(i,j)</span> de l’emploi <span class="math inline">j</span> pour le résident <span class="math inline">i</span>. Cette moyenne <span class="math inline">\langle\phi\rangle_u(n,j)</span> correspond à la probabilité de disponibilité de l’emploi <span class="math inline">j</span> pour n’importe quel résident après que <span class="math inline">n</span> résidents occupent d’ores et déjà un emploi ou ont fuit la zone. Cette grandeur ne dépend pas de <span class="math inline">i</span>, mais uniquement du nombre de résidents déjà positionnés.</p>
<p>Un deuxième grandeur nous sera utile. Il s’agit de l’accessibilité moyenne aux emplois disponibles. On peut noter <span class="math inline">A_u(i,k)</span> le cumul des emplois qui restent disponibles pour <span class="math inline">i</span> lorsque <span class="math inline">n</span> résidents se sont d’ores et déjà positionnés, en comptant les emplois depuis le plus proche de <span class="math inline">i</span> jusqu’au <span class="math inline">k^{ième}</span> le plus proche. La grandeur qui nous intéresse est la moyenne sur tous les <span class="math inline">n</span> possibles, soit :</p>
<p><span id="eq-an"><span class="math display">
\langle A \rangle_n(i,k) = \langle\sum_{l=1}^k \langle \phi \rangle_u(n, r_i(k)) \rangle _n
\tag{14}</span></span></p>
<p>La particularité de cette accessibilité est qu’à mesure que les emplois sont pris (lorsque <span class="math inline">n</span> s’accroît), l’accessibilité se restreint puisqu’elle ne retient que la part encore disponible des emplois proches.</p>
<p>Comme précédemment, nous considérons que la probabilité de fuite d’un individu est une constante. Dans ce cas, la probabilité d’absorption va augmenter au fur et à mesure que les emplois sont pris : moins il reste d’emplois disponibles, plus un résident est prêt à accepter ceux qui restent. La probabilité <span class="math inline">P_a</span> va donc dépendre de <span class="math inline">n</span> et s’écrire ici <span class="math inline">P_{a,n}</span>.</p>
<p>Pour un <span class="math inline">n</span> donné, on a :</p>
<p><span id="eq-pf2"><span class="math display">
P_f=\prod_{k=1}^J(1-P_{a,n}\times \langle \phi \rangle_u(n, r_i(k))
\tag{15}</span></span></p>
<p>En passant en <span class="math inline">log</span> et en effectuant un développement limité, on obtient :</p>
<p><span id="eq-logpf"><span class="math display">
log(P_f)=-P_{a,n}\times\sum_{k=1}^J \langle \phi \rangle_u(n,r_i(k))=-P_{a,n}\times(J-(1-P_f)\times n)
\tag{16}</span></span></p>
<p>Nous avons alors tous les éléments pour calculer la probabilité <span class="math inline">P_n(i,j)</span> que le résident <span class="math inline">i</span> prenne l’emploi <span class="math inline">j</span> après que <span class="math inline">n</span> résidents se sont déjà positionnés (cf. <a href="#eq-pij">équation&nbsp;8</a>). En passant alors en <span class="math inline">log</span>, on a :</p>
<p><span id="eq-logpij"><span class="math display">
log(P_{ij})=log(P_{a,n})+log(\langle\phi \rangle_u(n,j))+\sum_{k=1}^{r_i^{-1}(j)}log(1-P_{a,n}\times \langle \phi \rangle_u(n,r_i(k))
\tag{17}</span></span></p>
<p>En faisant un développement limité du dernier terme puis la moyenne sur les <span class="math inline">n</span>, il en découle :</p>
<p><span id="eq-logpijapprox"><span class="math display">
log(P_{ij})\approx\langle log(P_{a,n})\rangle _n+\langle\langle\phi\rangle_u(n,j)\rangle_n + \langle A\rangle_n(i, r_i^{-1}(j))
\tag{18}</span></span></p>
<p>La probabilité <span class="math inline">P_{ij}</span> s’écrit donc à partir de la probabilité moyenne d’absorption, de l’espérance que l’emploi <span class="math inline">j</span> est disponible et de l’accessibilité moyenne. Sur le plan conceptuel, c’est tout à fait satisfaisant et compréhensible.</p>
</section>
<section id="sec-hetero" class="level3 page-columns page-full" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="sec-hetero"><span class="header-section-number">3.4</span> Hétérogénéité de la fuite et de l’absorption</h3>
<p>Nous avons considéré jusqu’à présent le cas où les individus et les emplois étaient homogènes et indiscernables. Cela simplifie le modèle et permet une résolution explicite. Il est cependant possible de complexifier le modèle en levant ces hypothèses en introduisant des paramètres interprétables qui permettent une meilleure prédiction et l’extraction d’informations des données.</p>
<p>Tout d’abord, le paramètre de fuite peut être spécifique à chaque individu. Par exemple, le recensement nous permet de mesurer la proportion d’individu, par commune, qui ont un emploi à plus de 100km de leur domicile. Cette proportion est faible (<span class="math inline">&lt;5\%</span> pour une région comme celle étudiée dans l’application à la Rochelle <a href="#sec-rochelle">Section&nbsp;5</a>) mais peut varier d’une commune à l’autre. Ces variations peuvent s’expliquer par une géographie particulière ou par des caractéristiques des individus. On peut alors définir une probabilité de fuite <span class="math inline">p_{f,i}</span> pour chaque individu.</p>
<p>Ensuite, le paramètre d’absorption était jusqu’à maintenant identique pour tous les emplois et tous les individus. On peut le rendre dépendant des emplois, <span class="math inline">p_{a,j}</span>, pour marquer un effet fixe spécifique à des emplois. Le recensement nous donne quelques informations sur les trajets professionnels de commune à commune et, donc, sur l’attractivité différentielle entre communes. D’autres données pourraient nous informer à un niveau infra-communal. On pourrait aussi vouloir faire dépendre la probabilité d’absorption de caractéristiques observables des emplois. Des emplois dans une zone dense en emploi peuvent, au-delà de l’effet masse déjà pris en compte, être plus attractifs que des emplois isolés. Dans ce cas, l’absorption dépend de caractéristiques <span class="math inline">X</span> observées et en spécifiant la forme fonctionnelle de <span class="math inline">p_a(X)</span> on peut l’estimer de façon à mieux reproduire l’information sur la distribution des déplacements.</p>
<div class="page-columns page-full"><p>Le modèle présenté est suffisamment flexible pour pouvoir rendre compte de phénomènes plus complexes afin de, à la fois, pouvoir exploiter des données riches et modéliser des comportements (de fuite, d’absorption) qui semblent avoir un sens. Si au lieu d’apparier les individus et les emplois, on s’intéresse au cas du choix des écoles, on peut imaginer que l’absorption de l’école la plus proche est élevée, mais que celles de rang supérieur s’effondrent. Si l’individu est indifférent aux caractéristiques des écoles, hors leur emplacement, il prend l’école la plus proche. Le refus de cette première école peut s’expliquer par une exigence parentale non observable, mais qui se traduit par une distance parcourue plus élevée. Mais le modèle de base rendant compte d’une baisse de l’absorption au-delà du premier rang est déjà assez bon<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn6"><p><sup>6</sup>&nbsp;De façon plus générale, on peut spécifier une loi de la probabilité d’absorption quelconque qui doit vérifier que <span class="math inline">\sum_{k=1,J} p_{i,r_i(k)} = p_{f,i}</span> pour tout <span class="math inline">i</span>. Toute paramétrisation de cette loi de probabilité peut alors être simulée et ajustée sur des données. Si les paramètres ont une interprétation théorique, on peut alors les identifier.</p></li></div></div>
<p>On peut ainsi modifier les probabilités d’absorption en donnant à un groupe particulier de paires individus emplois plus ou moins de chances d’être absorbé. En jouant sur les groupes qui partionnent les paires individus <span class="math inline">\times</span> emplois on peut augmenter ou réduire le nombre de degré de liberté du système. Lorsque seule la probabilité d’absorption est un paramètre, le nombre de dégré de liberté est 1 et le paramètre <span class="math inline">p</span> est déterminé par la condition d’égalité entre le nombre d’emplois pourvus et d’individus. Si on dispose d’une information sur la probabilité de fuite par indidividu ou par groupe d’individus, le nombre de degré de liberté peut être accru par une probabilité de fuite différenciée selon ces groupes. On peut encore accroître le nombre de degré de liberté en croisant une probabilité d’absorption par groupes d’emplois et groupes d’individus. Le choix de la spécification dépendra de ce que l’on souhaite réaliser et du problème considéré. On verra dans la <a href="#sec-rochelle">Section&nbsp;5</a> une application en recourant à un grand nombre de degré de liberté afin d’ajuster le modèle sur des données détaillées (donnant pour des paires commune de résidence <span class="math inline">\times</span> commune d’emploi une observation des flux de mobilité professionnels) et de pouv oir procéder à des intrapolations, en projetant les flux à une échelle infra communale tout en respectant les observations, et de pouvoir simuler des scénarios alternatifs en considérant que les <span class="math inline">\lambda_{i,j}</span> sont constants. Dans une publication ultérieure, nous montrerons une détermination parcimonieuse des coefficients correcteurs afin de pouvoir extraire une information pertinente des données de flux entre communes et de pouvoir comparer le pouvoir prédictif de MEAPS à celui d’un modèle gravitaire, à degré de liberté égal.</p>
<p>En indexant par <span class="math inline">i</span> les probabilités de fuite <span class="math inline">p_{f,i}</span> et par <span class="math inline">i,j</span> les coefficients correcteurs <span class="math inline">\lambda_{i,j}</span>, les équations principales du modèle deviennent :</p>
<p><span id="eq-comp1"><span class="math display">
P_{i, u}(j) = \lambda_{i,j} . p_{a} \prod _{l=1} ^{r_{u(i)}(j)-1} {[1-\lambda_{i,r_{u(i)}(l)}. p_{a}.\phi_u(i,r_{u(i)}^{-1}(l))]}
\tag{19}</span></span></p>
<p><span id="eq-lambdacomp"><span class="math display">
\prod _{l=1} ^{J} {[1-\lambda_{i,r_{u(i)}(l)}.p_{a}.\phi_u(i,r_{u(i)}^{-1}(l))]}= p_{f,i}
\tag{20}</span></span></p>
<div class="page-columns page-full"><p>Il n’est pas possible de donner une forme réduite de cette dernière expression. En revanche, elle est calculable numériquement pour chaque <span class="math inline">u</span>, <span class="math inline">i</span> et <span class="math inline">j</span> en fonction des hypothèses du modèle (<span class="math inline">p_{f,i}</span>, <span class="math inline">p_{a,j}</span>, la structure spatiale des résidents et des emplois) et sert de base à l’algorithme de calcul employé dans les simulations présentées dans la section <a href="#sec-synt">Section&nbsp;4</a><a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn7"><p><sup>7</sup>&nbsp;L’implémentation de cette expression est faite dans le fichier <code>meaps.cpp</code> accessible sur le dépôt <code>github.com/xtimbeau/meaps</code></p></li></div></div>
<p>Le modèle ainsi construit est flexible puisqu’on peut spécifier des processus de fuite (contrainte en ligne équivalente à la contrainte <a href="#eq-ai">3</a>) et des processus d’absorption qui respecte la contrainte de saturation des emplois (contrainte en ligne équivalente à la contrainte <a href="#eq-bj">4</a>) par le processus de priorité décrit en <a href="#sec-priorite">Section&nbsp;3.2</a>. Le parcours de toutes les permutations possibles permet de s’affranchir d’un ordre de priorité particulier et de définir une solution moyenne au processus. Lorsqu’on analyse le problème avec une grille de taille finie (ou de taille inférieure au nombre <span class="math inline">J</span> d’opportunités), on peut conjecturer un comportement ergodique des quantités moyennes prédites par le modèle. On résout de cette façon explicitement le problème de contrainte aux marges du modèle gravitaire ou du modèle radiatif.</p>
</section>
<section id="synthèse-de-meaps" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="synthèse-de-meaps"><span class="header-section-number">3.5</span> Synthèse de MEAPS</h3>
<p>Avant de passer aux simulations, résumons le propos : nous proposons une formulation du problème de distribution des transports qui permet de traiter du respect de la contrainte aux marges avec un processus élémentaire explicite. Cela accroît la validité du modèle et sa possible utilisation dans des applications. Cela permet également d’utiliser l’information donnée par les contraintes de marge et d’en déduire une série d’indicateurs caractérisant la zone étudiée et les tensions entre l’offre et la demande.</p>
<p>La formulation la plus simple du modèle, correspondant à l’hypothèse d’homogénéité des emplois, d’un processus binaire d’absorption et d’une valeur identique de fuite par individu permet de construire une calibration canonique, qui ne dépend que des paramètres de “masse” et de “distance”. On peut alors proposer une version plus riche du modèle, en individualisant la probabilité de fuite, en pondérant les probabilités d’absorption ou encore en proposant un processus d’absorption non binaire et paramétrique. Ces versions peuvent alors être confrontées aux données disponibles, en contrôlant du risque de sur ajustement et en disposant pour chacun des paramètres d’une une référence canonique.</p>
<p>Comme il est d’usage de le discuter en économie, cette approche est structurelle et donne aux paramètres un statut exogène. L’identification sur les données, conditionnellement à ce modèle, peut alors recevoir une interprétation causale.</p>
</section>
</section>
<section id="sec-synt" class="level2 page-columns page-full" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="sec-synt"><span class="header-section-number">4</span> Simulations numériques synthétiques</h2>
<p>Pour étudier quelques unes des propriétés du modèle nous proposons ici d’explorer son comportement sur des données synthétiques. Les données synthétiques, générées de façon explicites, permettent de contrôler les variations de paramètres afin d’en isoler les conséquences. Ces simulations ne prétendent pas ni à l’exhaustivité ni à la démonstration, mais peuvent servir à appuyer l’intuition. L’ensemble de la partie sur les simulations synthétiques est exécutable au sens de <span class="citation" data-cites="lasser2020">(<a href="#ref-lasser2020" role="doc-biblioref">Lasser 2020</a>)</span>. Les codes nécessaires à la reproduction de ces simulations et des graphiques associés sont disponibles sur <code>github.com/xtimbeau/meaps</code> et exécutables librement.</p>
<section id="trois-pôles-en-centre-et-satellites" class="level3 page-columns page-full" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="trois-pôles-en-centre-et-satellites"><span class="header-section-number">4.1</span> Trois pôles en centre et satellites</h3>
<p>Nous construisons un territoire abstrait composé d’un “centre ville” et de “deux périphéries” (<a href="#fig-territoire">figure&nbsp;1</a>). Cette configuration arbitraire nous permet d’évaluer MEAPS en simulant les trajets et leur distribution. Chaque individu et chaque emploi sont localisés, distinctement les uns des autres, ce qui permet de calculer des distances euclidiennes entre chaque habitant et chaque emploi et d’en déduire un classement pour chaque habitant sans ambiguïté des emplois en fonction de leur éloignement de chaque résident. Tous les emplois sont considérés comme homogènes et on suppose une probabilité de fuite identique de 10% pour tous les individus. Les distances entre les pôles sont données dans le <a href="#tbl-distances">tableau&nbsp;1</a> (dans une unité sans intérêt).</p>
<div class="cell page-columns page-full" data-tbl-scap="Distances entre les pôles">
<div class="cell-output-display page-columns page-full">
<div id="tbl-distances" class="anchored page-columns page-full">

<div id="duaenpjyvg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#duaenpjyvg) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#duaenpjyvg) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#duaenpjyvg) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#duaenpjyvg) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#duaenpjyvg) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#duaenpjyvg) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#duaenpjyvg) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#duaenpjyvg) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#duaenpjyvg) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#duaenpjyvg) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#duaenpjyvg) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#duaenpjyvg) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#duaenpjyvg) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#duaenpjyvg) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#duaenpjyvg) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#duaenpjyvg) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#duaenpjyvg) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#duaenpjyvg) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#duaenpjyvg) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#duaenpjyvg) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#duaenpjyvg) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#duaenpjyvg) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#duaenpjyvg) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#duaenpjyvg) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#duaenpjyvg) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#duaenpjyvg) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#duaenpjyvg) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#duaenpjyvg) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#duaenpjyvg) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#duaenpjyvg) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#duaenpjyvg) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#duaenpjyvg) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#duaenpjyvg) .gt_left {
  text-align: left;
}

:where(#duaenpjyvg) .gt_center {
  text-align: center;
}

:where(#duaenpjyvg) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#duaenpjyvg) .gt_font_normal {
  font-weight: normal;
}

:where(#duaenpjyvg) .gt_font_bold {
  font-weight: bold;
}

:where(#duaenpjyvg) .gt_font_italic {
  font-style: italic;
}

:where(#duaenpjyvg) .gt_super {
  font-size: 65%;
}

:where(#duaenpjyvg) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#duaenpjyvg) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#duaenpjyvg) .gt_indent_1 {
  text-indent: 5px;
}

:where(#duaenpjyvg) .gt_indent_2 {
  text-indent: 10px;
}

:where(#duaenpjyvg) .gt_indent_3 {
  text-indent: 15px;
}

:where(#duaenpjyvg) .gt_indent_4 {
  text-indent: 20px;
}

:where(#duaenpjyvg) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="e1">e1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="e2">e2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="e3">e3</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="gh" class="gt_row gt_left">h1</td>
<td headers="e1" class="gt_row gt_right">0.0</td>
<td headers="e2" class="gt_row gt_right">0.6</td>
<td headers="e3" class="gt_row gt_right">0.7</td></tr>
    <tr><td headers="gh" class="gt_row gt_left">h2</td>
<td headers="e1" class="gt_row gt_right">0.6</td>
<td headers="e2" class="gt_row gt_right">0.0</td>
<td headers="e3" class="gt_row gt_right">1.3</td></tr>
    <tr><td headers="gh" class="gt_row gt_left">h3</td>
<td headers="e1" class="gt_row gt_right">0.7</td>
<td headers="e2" class="gt_row gt_right">1.3</td>
<td headers="e3" class="gt_row gt_right">0.0</td></tr>
  </tbody>
  
  
</table>
<div class="quarto-table-caption margin-caption">tableau&nbsp;1:  Distances entre les pôles </div></div>
</div>
</div>
</div>
<p>Pour assurer l’égalité entre demandes et offres d’emploi, on tire aléatoirement 4 500 emplois. Les trois pôles d’emplois ont les mêmes centres que les pôles d’habitation, mais ont une répartition plus resserrée que pour les habitants. Comme indiqué sur la <a href="#fig-territoire">figure&nbsp;1</a>, les tâches d’emplois 1 à 3 sont respectivement localisés autour des mêmes centres que les zones d’habitation 1 à 3.. Les pôles périphériques comportent moins d’emplois (5% chacun) que le pôle central (80% de l’emploi total) afin de représenter dans les pôles périphériques des emplois présentiels, liés aux services fournis aux résidents (comme des commerces ou des écoles) et d’une zone d’activité centrale. Nous ne faisons aucune distinction de productivité ou de qualification nécessaire pour les emplois. Cette hypothèse simplifie la simulation du modèle, mais rien n’empêche de distinguer des catégories d’emplois, des catégories d’habitants ni d’introduire des éléments de choix entre distance et nature de l’emploi. Nous ne considérons ici pas le choix de la localisation et considérons toutes les localisations comme exogènes.</p>
<p>Dans l’analyse statistique qui suit, on procédera à une agrégation spatiale en pavant le plan où sont localisés emplois et habitants par des hexagones adjacents. Cela correspond à une analyse empirique où les données de localisation sont carroyées.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-territoire" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="svg/gcarte_ss.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;1: Territoire synthétique comportant un centre ville (h1) et deux villages (h2) et (h3). Dans chaque hexagone est indiqué la densité (5 000 habitants). 4 500 emplois avec des proportions d’emplois de 80% dans le centre et de 5% dans les 2 villages (les 10% restant sont la fuite). La dispersion est plus basse pour les emplois. Les densités d’emplois sont représentées dans le panneau de droite en orange.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-distances">figure&nbsp;2</a> simule MEAPS à partir des données de <a href="#fig-territoire">figure&nbsp;1</a>. On obtient pour chaque hexagone où résident des habitants une valeur moyenne de distance jusqu’à leur emploi. De la même façon, on calcule pour chaque emploi la distance accomplie en moyenne pour l’atteindre.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-distances" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/gdistances.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;2: On représente sur le panneau de <strong>gauche</strong> les distances moyennes parcourues par les habitants d’un héxagone. La vignette présente la densité des trajets en fonction de la distance(vert). Sur le panneau de <strong>droite</strong> on représente les distances moyennes pour atteindre chaque emploi, ainsi que la densité de ces trajets par distance dans la vignette (orange)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Cette première représentation graphique permet de se représenter le fonctionnement du modèle MEAPS. On peut générer une distribution de trajets (dans les vignettes de la <a href="#fig-distances">figure&nbsp;2</a>). Comme la majorité des emplois se trouvent dans le pôle central, les distances moyennes pour les habitants y sont plus faibles que dans les autres pôles. Le modèle génère un peu de variance à l’intérieur de chaque pôle. On retrouve l’idée que les hexagones d’habitations les plus excentrées génèrent des distances plus importantes. La distribution des distances moyennes pour atteindre un emploi est plus resserrée que celle des distances parcourues en moyenne par habitant. Les moyennes de ces deux distributions sont égales (par construction).</p>
<p>On peut construire une table des flux entre chaque pôles (<a href="#tbl-fluxpoles">tableau&nbsp;2</a>). Le premier élément est de noter que les contraintes aux marges sont parfaitement respectées, ce qui est le principe de construction de MEAPS, les approximations faites dans l’algorithme de résolution restant ici inférieures à <span class="math inline">10^{-5}</span> au moins. Par ailleurs, la table de flux confirme le diagnostic précédent. La plupart des habitants de h1 (95%) se rendent dans g1 (le même pôle donc). Ce taux d’“auto-emploi” est de 10% à 20% pour les deux autres pôles. Cela tient au déséquilibre de localisation des emplois et est une propriété souhaitée du modèle. Cela explique en partie la distribution des distances pour les habitants et également le concept réciproque (distances moyenne vers un hexagone d’emplois).</p>
<div class="cell page-columns page-full" data-tbl-scap="flux entre pôles">
<div class="cell-output-display page-columns page-full">
<div id="tbl-fluxpoles" class="anchored page-columns page-full">

<div id="cbdmttdcss" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#cbdmttdcss) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#cbdmttdcss) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#cbdmttdcss) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#cbdmttdcss) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#cbdmttdcss) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#cbdmttdcss) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#cbdmttdcss) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#cbdmttdcss) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#cbdmttdcss) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#cbdmttdcss) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#cbdmttdcss) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#cbdmttdcss) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#cbdmttdcss) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#cbdmttdcss) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#cbdmttdcss) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#cbdmttdcss) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#cbdmttdcss) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#cbdmttdcss) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#cbdmttdcss) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#cbdmttdcss) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#cbdmttdcss) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#cbdmttdcss) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#cbdmttdcss) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#cbdmttdcss) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#cbdmttdcss) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#cbdmttdcss) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#cbdmttdcss) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#cbdmttdcss) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#cbdmttdcss) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#cbdmttdcss) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#cbdmttdcss) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#cbdmttdcss) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#cbdmttdcss) .gt_left {
  text-align: left;
}

:where(#cbdmttdcss) .gt_center {
  text-align: center;
}

:where(#cbdmttdcss) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#cbdmttdcss) .gt_font_normal {
  font-weight: normal;
}

:where(#cbdmttdcss) .gt_font_bold {
  font-weight: bold;
}

:where(#cbdmttdcss) .gt_font_italic {
  font-style: italic;
}

:where(#cbdmttdcss) .gt_super {
  font-size: 65%;
}

:where(#cbdmttdcss) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#cbdmttdcss) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#cbdmttdcss) .gt_indent_1 {
  text-indent: 5px;
}

:where(#cbdmttdcss) .gt_indent_2 {
  text-indent: 10px;
}

:where(#cbdmttdcss) .gt_indent_3 {
  text-indent: 15px;
}

:where(#cbdmttdcss) .gt_indent_4 {
  text-indent: 20px;
}

:where(#cbdmttdcss) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="e1">e1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="e2">e2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="e3">e3</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total">total</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="gh" class="gt_row gt_left">h1</td>
<td headers="e1" class="gt_row gt_right">2 992</td>
<td headers="e2" class="gt_row gt_right">81</td>
<td headers="e3" class="gt_row gt_right">77</td>
<td headers="total" class="gt_row gt_right">3 150</td></tr>
    <tr><td headers="gh" class="gt_row gt_left">h2</td>
<td headers="e1" class="gt_row gt_right">506</td>
<td headers="e2" class="gt_row gt_right">135</td>
<td headers="e3" class="gt_row gt_right">34</td>
<td headers="total" class="gt_row gt_right">675</td></tr>
    <tr><td headers="gh" class="gt_row gt_left">h3</td>
<td headers="e1" class="gt_row gt_right">502</td>
<td headers="e2" class="gt_row gt_right">34</td>
<td headers="e3" class="gt_row gt_right">140</td>
<td headers="total" class="gt_row gt_right">675</td></tr>
    <tr><td headers="gh" class="gt_row gt_left">total</td>
<td headers="e1" class="gt_row gt_right">4 000</td>
<td headers="e2" class="gt_row gt_right">250</td>
<td headers="e3" class="gt_row gt_right">250</td>
<td headers="total" class="gt_row gt_right">4 500</td></tr>
  </tbody>
  
  
</table>
<div class="quarto-table-caption margin-caption">tableau&nbsp;2:  flux entre pôles </div></div>
</div>
</div>
</div>
<p>Pour apprécier le comportement du modèle on peut procéder à une expérience de pensée dans laquelle on éloigne le pôle 3 des deux autres pôles (la distance entre 1 et 3 passe de 0.7 à 1.2 dans cette expérience). Le <a href="#tbl-fluxpoles2">tableau&nbsp;3</a> est obtenu en re-simulant le modèle sur la nouvelle géographie. Le résultat est très proche du modèle précédent. Les flux entre le pôle 1 et 3 sont marginalement modifiés (de 2 ou 3) alors que ceux entre h1 et e2 ou e3 le sont un peu plus, traduisant des changements de rangs possibles pour les habitants de h1 entre e2 ou e3 (qui est plus loin). Ce résultat est conforme à l’intuition et également une propriété souhaitée du modèle. Les distributions des distances (sortantes et arrivantes) sont plus largement modifiées, puisque 3 est plus loin de 1 et 2, comme l’indique la <a href="#fig-distances2">figure&nbsp;3</a>. Les habitants de h1 préfèrent e2 à e3 et réduisent un peu leur trajets vers e3 mais augmentent leurs distances. L’accroissement de la saturation sur e2 conduit à des trajets vers e3 (de h1, h2 et h3) qui marque la distribution des distances. la <a href="#fig-denscomp">figure&nbsp;4</a> éclaire ce qui se passe par pôle.</p>
<div class="cell page-columns page-full" data-tbl-scap="flux entre pôles (pôle 3 plus loin)">
<div class="cell-output-display page-columns page-full">
<div id="tbl-fluxpoles2" class="anchored page-columns page-full">

<div id="aamvxhdvgd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#aamvxhdvgd) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#aamvxhdvgd) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#aamvxhdvgd) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#aamvxhdvgd) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#aamvxhdvgd) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#aamvxhdvgd) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#aamvxhdvgd) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#aamvxhdvgd) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#aamvxhdvgd) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#aamvxhdvgd) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#aamvxhdvgd) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#aamvxhdvgd) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#aamvxhdvgd) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#aamvxhdvgd) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#aamvxhdvgd) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#aamvxhdvgd) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#aamvxhdvgd) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#aamvxhdvgd) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#aamvxhdvgd) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#aamvxhdvgd) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#aamvxhdvgd) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#aamvxhdvgd) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#aamvxhdvgd) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#aamvxhdvgd) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#aamvxhdvgd) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#aamvxhdvgd) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#aamvxhdvgd) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#aamvxhdvgd) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#aamvxhdvgd) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#aamvxhdvgd) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#aamvxhdvgd) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#aamvxhdvgd) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#aamvxhdvgd) .gt_left {
  text-align: left;
}

:where(#aamvxhdvgd) .gt_center {
  text-align: center;
}

:where(#aamvxhdvgd) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#aamvxhdvgd) .gt_font_normal {
  font-weight: normal;
}

:where(#aamvxhdvgd) .gt_font_bold {
  font-weight: bold;
}

:where(#aamvxhdvgd) .gt_font_italic {
  font-style: italic;
}

:where(#aamvxhdvgd) .gt_super {
  font-size: 65%;
}

:where(#aamvxhdvgd) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#aamvxhdvgd) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#aamvxhdvgd) .gt_indent_1 {
  text-indent: 5px;
}

:where(#aamvxhdvgd) .gt_indent_2 {
  text-indent: 10px;
}

:where(#aamvxhdvgd) .gt_indent_3 {
  text-indent: 15px;
}

:where(#aamvxhdvgd) .gt_indent_4 {
  text-indent: 20px;
}

:where(#aamvxhdvgd) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="e1">e1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="e2">e2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="e3">e3</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total">total</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="gh" class="gt_row gt_left">h1</td>
<td headers="e1" class="gt_row gt_right">2 992</td>
<td headers="e2" class="gt_row gt_right">85</td>
<td headers="e3" class="gt_row gt_right">73</td>
<td headers="total" class="gt_row gt_right">3 150</td></tr>
    <tr><td headers="gh" class="gt_row gt_left">h2</td>
<td headers="e1" class="gt_row gt_right">508</td>
<td headers="e2" class="gt_row gt_right">133</td>
<td headers="e3" class="gt_row gt_right">34</td>
<td headers="total" class="gt_row gt_right">675</td></tr>
    <tr><td headers="gh" class="gt_row gt_left">h3</td>
<td headers="e1" class="gt_row gt_right">500</td>
<td headers="e2" class="gt_row gt_right">33</td>
<td headers="e3" class="gt_row gt_right">142</td>
<td headers="total" class="gt_row gt_right">675</td></tr>
    <tr><td headers="gh" class="gt_row gt_left">total</td>
<td headers="e1" class="gt_row gt_right">4 000</td>
<td headers="e2" class="gt_row gt_right">250</td>
<td headers="e3" class="gt_row gt_right">250</td>
<td headers="total" class="gt_row gt_right">4 500</td></tr>
  </tbody>
  
  
</table>
<div class="quarto-table-caption margin-caption">tableau&nbsp;3:  flux entre pôles (pôle 3 plus loin) </div></div>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-distances2" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/gdistances2.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;3: Le graphique est construit comme le précédent, le pôle 3 est éloigné de 0.5 (70% plus loin) par rapport à 1.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-denscomp" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/gdenshabg.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;4: Densités comparées des distances parcourues par habitant entre le scénario de référence et le scénario ‘pôle 3 plus loin’. Le trait pointillé est utilisé pour le scénario alternatif.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-estimation" class="level3 page-columns page-full" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="sec-estimation"><span class="header-section-number">4.2</span> Procédure d’estimation</h3>
<p>Il est possible de modifier les pondérations des probabilités d’absorption de façon à modifier la table des flux. Ceci est illustré dans la table suivante où on a doublé pour chaque paire possible de zone d’habitation et de zone d’emploi la probabilité relative d’absorption. La configuration géographique est celle de la <a href="#fig-territoire">figure&nbsp;1</a>, avec un centre et deux satellites. Le centre comporte plus d’emplois que de résidents, ce qui oblige à des flux entrants dans la zone 1 comme indiqués dans la <a href="#tbl-fluxpoles">tableau&nbsp;2</a>. On parle de doublement relatif de la probabilité, parce que les contraintes de constance de probabilité de fuite et de saturation des emplois imposent une réduction des probabilités d’absorption des autres emplois, ce qui est assuré dans l’algorithme qui implémente MEAPS.</p>
<p>Le tableau <a href="#tbl-fluxpond">tableau&nbsp;4</a> décrit les variations de flux par rapport à une situation de référence (celle de <a href="#tbl-fluxpoles">tableau&nbsp;2</a>), arrondi à l’entier le plus proche. Il y a donc <span class="math inline">3 \times 3</span> matrices $3 \times 3$. Chacune des sous matrice indique les variations de flux pour chaque paire origine destination et il y a 9 possibilités de doublement de la probabilité d’absorption qui constitue les lignes et les colonnes de la matrice englobante. On notera que les sommes des colonnes de chaque sous matrice sont nulles, ce qui indique le respect des contraintes en ligne et en colonne.</p>
<p>Conformément à l’intuition et malgré les effets induits par le respect des contraintes en ligne et en colonne, on observe bien que la paire zone d’habitation zone d’emploi qui se voit augmentée en probabilité relative connait des flux supérieurs. Pour compenser ces flux supérieurs, dans la même colonne, c’est-à-dire pour les flux en provenance des autres zones d’habitation, on constate systématiquement une diminution des flux en provenance des autres zones d’habitation. Symétriquement un accroissement des flux de la zone d’habitation <span class="math inline">i</span> vers la zone d’emploi <span class="math inline">j</span> induit toujours une diminution des flux de <span class="math inline">i</span> vers les autres zones d’emploi.</p>
<div class="cell page-columns page-full" data-tbl-scap="Modification de la probabilité d'absorption">
<div class="cell-output-display page-columns page-full">
<div id="tbl-fluxpond" class="anchored page-columns page-full">

<div id="tdhhhtppjj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>@import url("https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
html {
  font-family: Nunito, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#tdhhhtppjj) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: none;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#tdhhhtppjj) .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#tdhhhtppjj) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#tdhhhtppjj) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#tdhhhtppjj) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#tdhhhtppjj) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #000000;
}

:where(#tdhhhtppjj) .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#tdhhhtppjj) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 3px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#tdhhhtppjj) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#tdhhhtppjj) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#tdhhhtppjj) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#tdhhhtppjj) .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 3px;
  padding-bottom: 3px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#tdhhhtppjj) .gt_group_heading {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #000000;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#tdhhhtppjj) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #000000;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #000000;
  vertical-align: middle;
}

:where(#tdhhhtppjj) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#tdhhhtppjj) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#tdhhhtppjj) .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#tdhhhtppjj) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#tdhhhtppjj) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#tdhhhtppjj) .gt_row_group_first td {
  border-top-width: 1px;
}

:where(#tdhhhtppjj) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#tdhhhtppjj) .gt_first_summary_row {
  border-top-style: none;
  border-top-color: #000000;
}

:where(#tdhhhtppjj) .gt_first_summary_row.thick {
  border-top-width: 1px;
}

:where(#tdhhhtppjj) .gt_last_summary_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #000000;
}

:where(#tdhhhtppjj) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#tdhhhtppjj) .gt_first_grand_summary_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: none;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#tdhhhtppjj) .gt_striped {
  background-color: #FFE6E8;
}

:where(#tdhhhtppjj) .gt_table_body {
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #000000;
}

:where(#tdhhhtppjj) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#tdhhhtppjj) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#tdhhhtppjj) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#tdhhhtppjj) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#tdhhhtppjj) .gt_left {
  text-align: left;
}

:where(#tdhhhtppjj) .gt_center {
  text-align: center;
}

:where(#tdhhhtppjj) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#tdhhhtppjj) .gt_font_normal {
  font-weight: normal;
}

:where(#tdhhhtppjj) .gt_font_bold {
  font-weight: bold;
}

:where(#tdhhhtppjj) .gt_font_italic {
  font-style: italic;
}

:where(#tdhhhtppjj) .gt_super {
  font-size: 65%;
}

:where(#tdhhhtppjj) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#tdhhhtppjj) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#tdhhhtppjj) .gt_indent_1 {
  text-indent: 5px;
}

:where(#tdhhhtppjj) .gt_indent_2 {
  text-indent: 10px;
}

:where(#tdhhhtppjj) .gt_indent_3 {
  text-indent: 15px;
}

:where(#tdhhhtppjj) .gt_indent_4 {
  text-indent: 20px;
}

:where(#tdhhhtppjj) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id=""></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000; border-left-width: 5px; border-left-style: solid; border-left-color: #FFFFFF;" scope="colgroup" id="e1">
        <span class="gt_column_spanner">e1</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000; border-left-width: 5px; border-left-style: solid; border-left-color: #FFFFFF;" scope="colgroup" id="e2">
        <span class="gt_column_spanner">e2</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000; border-left-width: 5px; border-left-style: solid; border-left-color: #FFFFFF;" scope="colgroup" id="e3">
        <span class="gt_column_spanner">e3</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="e1">e1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="e2">e2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="e3">e3</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="e1">e1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="e2">e2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="e3">e3</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="e1">e1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="e2">e2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="e3">e3</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="h1 stub_1_1 stub_1" rowspan="3" class="gt_row gt_left gt_stub_row_group" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000; border-top-width: 1px; border-top-style: solid; border-top-color: #000000;">h1</td>
<td headers="h1 stub_1_1 h" class="gt_row gt_left">h1</td>
<td headers="h1 stub_1_1 e1_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">39</td>
<td headers="h1 stub_1_1 e1_e2" class="gt_row gt_right">-20</td>
<td headers="h1 stub_1_1 e1_e3" class="gt_row gt_right">-19</td>
<td headers="h1 stub_1_1 e2_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">-28</td>
<td headers="h1 stub_1_1 e2_e2" class="gt_row gt_right">31</td>
<td headers="h1 stub_1_1 e2_e3" class="gt_row gt_right">-2</td>
<td headers="h1 stub_1_1 e3_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">-29</td>
<td headers="h1 stub_1_1 e3_e2" class="gt_row gt_right">-2</td>
<td headers="h1 stub_1_1 e3_e3" class="gt_row gt_right" style="border-right-width: 1px; border-right-style: solid; border-right-color: black;">31</td></tr>
    <tr><td headers="h1 h_2 h" class="gt_row gt_left">h2</td>
<td headers="h1 h_2 e1_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">-20</td>
<td headers="h1 h_2 e1_e2" class="gt_row gt_right">16</td>
<td headers="h1 h_2 e1_e3" class="gt_row gt_right">4</td>
<td headers="h1 h_2 e2_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">25</td>
<td headers="h1 h_2 e2_e2" class="gt_row gt_right">-26</td>
<td headers="h1 h_2 e2_e3" class="gt_row gt_right">1</td>
<td headers="h1 h_2 e3_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">4</td>
<td headers="h1 h_2 e3_e2" class="gt_row gt_right">1</td>
<td headers="h1 h_2 e3_e3" class="gt_row gt_right" style="border-right-width: 1px; border-right-style: solid; border-right-color: black;">-5</td></tr>
    <tr><td headers="h1 h_3 h" class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">h3</td>
<td headers="h1 h_3 e1_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">-19</td>
<td headers="h1 h_3 e1_e2" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">4</td>
<td headers="h1 h_3 e1_e3" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">15</td>
<td headers="h1 h_3 e2_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">3</td>
<td headers="h1 h_3 e2_e2" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">-5</td>
<td headers="h1 h_3 e2_e3" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">2</td>
<td headers="h1 h_3 e3_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">25</td>
<td headers="h1 h_3 e3_e2" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">1</td>
<td headers="h1 h_3 e3_e3" class="gt_row gt_right" style="border-right-width: 1px; border-right-style: solid; border-right-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">-26</td></tr>
    <tr class="gt_row_group_first"><td headers="h2 stub_1_4 stub_1" rowspan="3" class="gt_row gt_left gt_stub_row_group" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000; border-top-width: 1px; border-top-style: solid; border-top-color: #000000;">h2</td>
<td headers="h2 stub_1_4 h" class="gt_row gt_left">h1</td>
<td headers="h2 stub_1_4 e1_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">-34</td>
<td headers="h2 stub_1_4 e1_e2" class="gt_row gt_right">29</td>
<td headers="h2 stub_1_4 e1_e3" class="gt_row gt_right">5</td>
<td headers="h2 stub_1_4 e2_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">33</td>
<td headers="h2 stub_1_4 e2_e2" class="gt_row gt_right">-33</td>
<td headers="h2 stub_1_4 e2_e3" class="gt_row gt_right">-1</td>
<td headers="h2 stub_1_4 e3_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">3</td>
<td headers="h2 stub_1_4 e3_e2" class="gt_row gt_right">5</td>
<td headers="h2 stub_1_4 e3_e3" class="gt_row gt_right" style="border-right-width: 1px; border-right-style: solid; border-right-color: black;">-7</td></tr>
    <tr><td headers="h2 h_5 h" class="gt_row gt_left">h2</td>
<td headers="h2 h_5 e1_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">41</td>
<td headers="h2 h_5 e1_e2" class="gt_row gt_right">-34</td>
<td headers="h2 h_5 e1_e3" class="gt_row gt_right">-7</td>
<td headers="h2 h_5 e2_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">-37</td>
<td headers="h2 h_5 e2_e2" class="gt_row gt_right">38</td>
<td headers="h2 h_5 e2_e3" class="gt_row gt_right">-1</td>
<td headers="h2 h_5 e3_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">-8</td>
<td headers="h2 h_5 e3_e2" class="gt_row gt_right">-6</td>
<td headers="h2 h_5 e3_e3" class="gt_row gt_right" style="border-right-width: 1px; border-right-style: solid; border-right-color: black;">13</td></tr>
    <tr><td headers="h2 h_6 h" class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">h3</td>
<td headers="h2 h_6 e1_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">-6</td>
<td headers="h2 h_6 e1_e2" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">5</td>
<td headers="h2 h_6 e1_e3" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">2</td>
<td headers="h2 h_6 e2_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">4</td>
<td headers="h2 h_6 e2_e2" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">-5</td>
<td headers="h2 h_6 e2_e3" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">1</td>
<td headers="h2 h_6 e3_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">5</td>
<td headers="h2 h_6 e3_e2" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">1</td>
<td headers="h2 h_6 e3_e3" class="gt_row gt_right" style="border-right-width: 1px; border-right-style: solid; border-right-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">-6</td></tr>
    <tr class="gt_row_group_first"><td headers="h3 stub_1_7 stub_1" rowspan="3" class="gt_row gt_left gt_stub_row_group" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000; border-top-width: 1px; border-top-style: solid; border-top-color: #000000;">h3</td>
<td headers="h3 stub_1_7 h" class="gt_row gt_left">h1</td>
<td headers="h3 stub_1_7 e1_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">-35</td>
<td headers="h3 stub_1_7 e1_e2" class="gt_row gt_right">6</td>
<td headers="h3 stub_1_7 e1_e3" class="gt_row gt_right">29</td>
<td headers="h3 stub_1_7 e2_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">2</td>
<td headers="h3 stub_1_7 e2_e2" class="gt_row gt_right">-7</td>
<td headers="h3 stub_1_7 e2_e3" class="gt_row gt_right">5</td>
<td headers="h3 stub_1_7 e3_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">34</td>
<td headers="h3 stub_1_7 e3_e2" class="gt_row gt_right">-3</td>
<td headers="h3 stub_1_7 e3_e3" class="gt_row gt_right" style="border-right-width: 1px; border-right-style: solid; border-right-color: black;">-31</td></tr>
    <tr><td headers="h3 h_8 h" class="gt_row gt_left">h2</td>
<td headers="h3 h_8 e1_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">-6</td>
<td headers="h3 h_8 e1_e2" class="gt_row gt_right">1</td>
<td headers="h3 h_8 e1_e3" class="gt_row gt_right">5</td>
<td headers="h3 h_8 e2_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">5</td>
<td headers="h3 h_8 e2_e2" class="gt_row gt_right">-6</td>
<td headers="h3 h_8 e2_e3" class="gt_row gt_right">1</td>
<td headers="h3 h_8 e3_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black;">3</td>
<td headers="h3 h_8 e3_e2" class="gt_row gt_right">3</td>
<td headers="h3 h_8 e3_e3" class="gt_row gt_right" style="border-right-width: 1px; border-right-style: solid; border-right-color: black;">-6</td></tr>
    <tr><td headers="h3 h_9 h" class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">h3</td>
<td headers="h3 h_9 e1_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">41</td>
<td headers="h3 h_9 e1_e2" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">-7</td>
<td headers="h3 h_9 e1_e3" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">-34</td>
<td headers="h3 h_9 e2_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">-7</td>
<td headers="h3 h_9 e2_e2" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">13</td>
<td headers="h3 h_9 e2_e3" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">-6</td>
<td headers="h3 h_9 e3_e1" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">-37</td>
<td headers="h3 h_9 e3_e2" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">0</td>
<td headers="h3 h_9 e3_e3" class="gt_row gt_right" style="border-right-width: 1px; border-right-style: solid; border-right-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">37</td></tr>
  </tbody>
  
  
</table>
<div class="quarto-table-caption margin-caption">tableau&nbsp;4:  Modification de la probabilité d’absorption par groupe. Le tableau représente l’écart entre lesd flux obtenus pour une probabilité d’absorption doublée pour la zone i d’habitation et la zone j d’emploi, pour chaque paire de zones habitation/emploi. La première matrice en haut à gauche indique donc que le flux entre la zone 1 d’habitation et la zone 1 d’emploi est accru de 39 lorsque la probabilité d’absorption reletive est doublée. Pour compenser ce flux plus important entre 1 et 1, le flux en la zone d’habitation 2 et l’emploi 1 est réduit de 20, ce qui implique à son tour que ceux entre 2 et 2 et entre 2 et 3 s’accroissent. </div></div>
</div>
</div>
</div>
<div class="page-columns page-full"><p>Une propriété intéressante des matrices de la <a href="#tbl-fluxpond">tableau&nbsp;4</a> est que les 9 matrices <span class="math inline">3 \times 3</span> forment un espace vectoriel de dimension 4<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. Ceci est attendu, puisque les contraintes réduisent la dimension de 9 (<span class="math inline">=3\times 3</span>) à 4, puisqu’il y a 3 contraintes dans chaque dimension (lignes et colonnes) et qu’une est redondante (si les somme sur chaque ligne sont nulles, alors la somme de tous les coefficients est nulle et donc si les sommes sur deux colonnes sont nulles, la troisième l’est nécessairement). Cela indique que, au moins localement (au voisinage de la matrice de flux calculée en <a href="#tbl-fluxpoles">tableau&nbsp;2</a>), il est possible de modifier les probabilités d’absorption pour atteindre n’importe quelle matrice de flux. A l’approximation linéaire près, il est donc possible de reproduire n’importe quelle structure de flux agrégés par un jeu de paramètres saturant exactement la dimension de cette structure de flux. Cette propriété permet d’envisager différentes approches d’estimations, suivant les données dont on dispose et du nombre de degrés de liberté que l’on est prêt à consacrer à la reproduction des données.</p><div class="no-row-height column-margin column-container"><li id="fn8"><p><sup>8</sup>&nbsp;Les valeurs propres de la matrice <span class="math inline">9 \times 9</span> constituée des 9 vecteurs colonnes des 9 matrices “dérivées” sont (133.3, 97.3, -28.6, 22.0, 0, 0, 0, 0, 0). Les 5 valeurs propres nulles et les 4 non nulles permettent de conclure que la dimension de l’espace vectoriel engendré par les 9 matrices est 4.</p></li></div></div>
<p>Le temps de calcul peut être assez long du fait de la nécessité de répéter un grand nombre de tirages, mais la section suivante ( <a href="#sec-ergemp">Section&nbsp;4.3</a>) montre que ce nombre peut rester raisonnable. Une estimation de ce type est mise en oeuvre par une procédure itérative dans la section <a href="#sec-rochelle">Section&nbsp;5</a>, permettant de reproduire à l’aide de MEAPS les données issues de l’enquête mobilités professionnelles <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022a</a>)</span> avec un schéma de calcul qui peut se mettre facilement en œuvre.</p>
</section>
<section id="sec-ergemp" class="level3 page-columns page-full" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="sec-ergemp"><span class="header-section-number">4.3</span> Ergodicité en pratique</h3>
<div class="page-columns page-full"><p>L’utilisation de données synthétiques permet de tester simplement l’hypothèse d’ergodicité. On a conjecturé que les différentes grandeurs moyennes sur les permutations <span class="math inline">u</span> étaient assimilables à des observations, éventuellement répétées. A ce stade de simulations synthétiques nous ne confrontons pas le modèle à des observations (voir <a href="#sec-rochelle">Section&nbsp;5</a>), mais nous allons montrer que l’estimation des valeurs moyennes ne demande pas l’examen des <span class="math inline">I!</span> permutations possibles<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> et peut se contenter d’une agrégation spatiale et de quelques tirages de permutations.</p><div class="no-row-height column-margin column-container"><li id="fn9"><p><sup>9</sup>&nbsp;Par la formule de Stirling <span class="math inline">log_{10}(I!) \approx (n +1/2)log_{10} n +log_{10}\sqrt{2} - n log_{10}e \approx 5\times10^5</span> pour <span class="math inline">I=10^5</span>, ce qui fait un nombre de grande taille.</p></li></div></div>
<p>Pour illustrer cette propriété, nous répétons les simulations du modèle pour plusieurs tirages de priorités (notés <span class="math inline">u</span> dans la section <a href="#sec-erg">Section&nbsp;3.3</a>). En prenant la moyenne sur un échantillon de <span class="math inline">u</span>, on peut construire un estimateur des grandeurs moyennes et montrer qu’avec un échantillon petit par rapport à <span class="math inline">I!</span>, on peut les estimer avec fiabilité et dans un temps raisonnable. Cette propriété sera montrée sur la structure géographique particulière que nous avons synthétisée, sans que cela permette de le généraliser avec certitude. Il existe sans doute des configurations spatiales pathologiques qui contredisent cette conjecture.</p>
<p>La <a href="#fig-emperg">figure&nbsp;5</a> illustre les processus stochastiques à l’œuvre dans le modèle et leur résolution par la moyennisation sur les tirages possibles. On applique le modèle en tirant aléatoirement des permutations de priorité de choix. On représente alors pour quelques hexagones d’habitation (tirés au sort) l’ensemble des choix de destination (carroyés dans les hexagones). Le carroyage opère déjà une moyennisation puisque chacun des individus de chaque hexagone a un ordre de priorité différent. On représente alors les quantités d’emplois (la probabilité de choisir comme emploi un emploi qui se trouve dans l’hexagone d’arrivée). Les lignes blanches illustrent la dépendance au tirage de priorité. Mais au bout de quelques tirages, ces probabilités convergent en moyenne. Pour simuler le modèle, il n’est pas nécessaire (en toute vraisemblance) de parcourir l’univers entier des permutations.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-emperg" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/gemploi_erg.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;5: Chaque ligne blanche représente pour un carreau de départ et d’arrivée (tous les carreaux d’arrivée sont représenté par une ligne, pour une sélection aléatoire de 4 carreaux de départ) la probabilité de prendre l’emploi dans le carreau d’arrivée en fonction du tirage aléatoire. Les lignes vertes représentent cette même probabibilité prise en moyenne sur les tirages cumulés. L’échelle de l’axe des y est logarithmique.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Le schéma de saturation et de priorité est illustré par la <a href="#fig-rangerg">figure&nbsp;6</a> ci-dessous. Pour chaque carreau d’arrivée (un emploi), on représente le rang moyen (gauche) et son écart type (droite) au moment de la saturation. La caractère stochastique découle du tirage aléatoire de l’ordre de chaque individu (les carreaux de départ). Pour la plupart des emplois, le rang moyen de saturation ergodique est atteint très rapidement. Trois bandes blanches apparaissent sur le graphique. Pour beaucoup d’emplois le rang moyene est le même et relativement élevé. Pour quelques emplois le temps de convergence vers un état indépendant des tirages est plus long. Pour un grand nombre de destinations, l’écart type est faible. Ces graphiques confirment qu’à quelques exceptions, l’état du système est stable après quelques tirages et le calcul de la moyenne.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-rangerg" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/g_rangns.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;6: Chaque ligne blanche représente pour un carreau d’arrivée (tous les carreaux d’arrivée sont représenté par une ligne) le rang moyen (panneau gauche) et l’écart type du rang (panneau de droite).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-fluxerg">figure&nbsp;7</a> est construite en simulant 500 tirages de priorité et en calculant les flux entre pôles. A ce niveau d’agrégation, plus aucune variance ne subsiste et un très faible nombre de tirages est nécessaire pour pouvoir quantifier les flux. On a la une illustration de la nature ergodique du modèle. L’estimation telle que présentée en <a href="#sec-estimation">Section&nbsp;4.2</a> peut ainsi fonctionner y compris si on ne réalise que quelques tirages aléatoires des priorités.</p>
<p>Le rang moyen au moment de la saturation est un objet qui peut être utilisé pour construire un indicateur localisé de tension.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-fluxerg" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/gfluxs.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;7: On simule 500 tirages de priorité tirés au sort et on calcule les flux impliqués par le modèle entre pôles. A ce niveau d’agrégation, les flux sont pratiquement invariants d’un tirage à l’autre à l’exception des ‘petits’ flux. L’échelle de l’axe des y est logarithmique.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-rochelle" class="level2 page-columns page-full" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="sec-rochelle"><span class="header-section-number">5</span> Une application à l’agglomération de La Rochelle</h2>
<p>Nous proposons ici une première application de MEAPS à l’agglomération de la Rochelle. Cette application est issue d’un travail de quantification de scénarios de politiques publiques visant à réduire l’empreinte carbone associée aux mobilités quotidiennes et au secteur résidentiel. La quantification demande à la fois de produire une cartographie très fine des émissions, en procédant par interpolation à partir de données plus macroscopiques mesurées par ailleurs et d’être en mesure de produire des évaluations des différences d’émissions localement et à l’échelle du territoire selon les différents scénarios. Nous présentons ici deux familles de scénarios pour lesquelles MEAPS a été mobilisé :</p>
<ul>
<li><p>Des scénarios de localisation de l’emploi : nous projetons la distribution des trajets en utilisant MEAPS sur deux structures spatiales de l’emploi différentes, tout en conservant la même quantité d’emploi globale. La différence entre les kilomètres parcourus suivant les différents modes dans les deux scénarios permet d’évaluer l’impact de la localisation, en distinguant la contribution du changement modal, la contribution des changements de distance pure (à mode et flux carreaux à carreaux inchangés) et la contribution des changements de flux.</p></li>
<li><p>Des scénarios de modification de la structure du réseau de transport. Le principe est identique à celui pour la localisation de l’emploi. C’est la matrice des distances et des temps qui est modifiée par une modification des infrastructures de transports (par exemple une ligne de bus en plus). Cette matrice de distance différente induit des temps de trajet plus petits mais uniquement pour le mode transport en commun. Elle induit un changement modal (plus de transport en commun, moins des autres modes) et enfin conduit à un changement des rangs des opportunités et donc une redistribution des flux de carreau à carreau.</p></li>
</ul>
<p>Dans les deux familles de scénarios, les simulations par MEAPS permettent de construire un contrefactuel et des alternatives à un niveau fin, croisant la localisation au carreau 200m pour les résidences (5 456 carreaux pour la Rochelle et le périmètre du SCOT) et les opportunités (6 326 carreaux dans le périmètre de 33km autour de l’agglomération de la Rochelle), soit 34,5 millions de flux et de modes. L’agrégation de ces informations est alors possible à des niveaux plus généraux pour analyser les impacts. La conversion des kilomètres ou des minutes en émissions de CO<sub>2</sub> pour la voiture est faite en appliquant des coefficients de conversion conventionnels, ce qui permet d’étendre les indicateurs au champ des émissions de gaz à effet de serre.</p>
<section id="emplois-résidents-au-carreau-inspire-200m" class="level3 page-columns page-full" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="emplois-résidents-au-carreau-inspire-200m"><span class="header-section-number">5.1</span> Emplois, résidents au carreau Inspire 200m</h3>
<div class="page-columns page-full"><p>La carte de la zone considéré est représentée sur la <a href="#fig-zoneslr">figure&nbsp;8</a>. L’analyse est limitée aux résidents du périmètre du Schéma de COhérence Territoriale (SCOT) et considère les emplois dans un rayon 33 kilomètres autour de lieux de résidence. Cette carte est construite à partir des données carroyées de l’INSEE <span class="citation" data-cites="C200">INSEE (<a href="#ref-C200" role="doc-biblioref">2022b</a>)</span> à la résolution du carreau 200m Inspire<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>. Nous ajoutons à ces données la localisation de l’emploi sur la même grille en utilisant les fichiers fonciers et les données d’emplois localisés de <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022a</a>)</span><a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>. La méthode consiste à imputer par code NAF<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> les emplois de chaque commune selon <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022a</a>)</span> aux surfaces professionnelles à la parcelle issues des fichiers foncier s. Cela permet ensuite de localiser au carreau 200m les emploi s. Cette méthode est assez grossière, puisqu’en particulier la ratio personne/surface n’est pas constant d’une entreprise à l’autre, mais elle fournit une bonne première approximation d’autant que l’extrapolation ne dépasse pas l’échelle de la commun e. Elle est en tout cas très supérieure à une imputation uniform e.</p><div class="no-row-height column-margin column-container"><li id="fn10"><p><sup>10</sup>&nbsp;INfrastructure for SPatial InfoRmation in Europe est depuis 2007 une directive pour la production de données spatialisées. Inspire définit une grille de carroyage et son système de projection harmonisée. C’est ce qui suit l’INSEE dans la diffusion des données carroyées. Voir https://inspire-geoportal.ec.europa.eu pour la définition de la grille et des jeux de données.</p></li><li id="fn11"><p><sup>11</sup>&nbsp;Une alternative est d’utiliser FLORES qui propose une localisation de l’emploi à la commune sur la base des DADS. FLORES fournit probablement une donnée de meilleure qualité, mais comme nous utilisons ensuite les flux entre communes de résidence et d’emploi, pour des raisons de cohérence, il est plus logique d’utiliser <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022a</a>)</span>.</p></li><li id="fn12"><p><sup>12</sup>&nbsp;L’utilisation des codes NAF dans les fichiers fonciers pose deux problèmes. L’un est la prise en compte des bâtiments publics, qui ne sont pas soumis à la taxe foncière et l’autre est l’identification du code NAF de l’usage effectif du local lorsque le local est loué.</p></li></div></div>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-zoneslr" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/popemp.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;8: Localisation es emplois et des résidents, zones de la Rochelle. Le périmètre de du SCOT de la Rochelle est indiqué ainsi que les limites administratives des communes et des EPCI le composant. Sources : OSM, Mapbox, IGN, carroyage INSEE 2017, Flores et fichiers fonciers 2018</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calcul-des-distances-par-mode" class="level3 page-columns page-full" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="calcul-des-distances-par-mode"><span class="header-section-number">5.2</span> Calcul des distances par mode</h3>
<p>Un ingrédient important de l’analyse du territoire est la prise en compte des distances entre chaque paire possible résidence/emploi. Contrairement à l’analyse synthétique, nous ne nous contentons pas de la distance euclidienne.</p>
<div class="page-columns page-full"><p>Pour ce faire nous calculons à partir d’un calculateur d’itinéraire<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> les distances et surtout les temps de transport pour 4 modes (voiture, vélo, transport en commun, marche à pied). Les temps de transport calculés pour chaque paire de carreaux de résidence et d’emploi, en retenant le centre des carreaux, tiennent compte des différentes contraintes de circulation (vitesses limites pour la voiture, sens de circulation, pénalité pour changement de direction, accès autorisé ou restreint suivant le mode, stress à vélo)<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a> . Concernant les déplacements en voiture, nous ne prenons pas en compte à ce stade la congestion . Concernant les transports en commun, le niveau de détail est assez grand, puisque les fréquences de voyages ainsi que les correspondances sont prises en compte . Dans certaines villes, il est possible d’accéder à une information sur les temps de parcours effectifs (mesurant ainsi la congestion ou la disponibilité du réseau) en complément des horaires théoriques . Ces informations ne sont pas disponible pour l’agglomération de la Rochelle et donc cette possibilité n’est pas explorée . L’accès aux données GTFS impose quelques limites, comme par exemple la non prise en compte des réseaux scolaires ou d’autres réseaux locaux ou privés non publiés sous ce format . La modification du réseau de transport comme l’ouverture d’une ligne ou l’accroissement de fréquence est pris en compte en modifiant la matrice des distances et temps par mode entre chaque carreau de résidence et chaque carreau de destination . Dans le cas de l’agglomération de la Rochelle, le nombre de paires calculés est de l’ordre de 16 million s</p><div class="no-row-height column-margin column-container"><li id="fn13"><p><sup>13</sup>&nbsp;Nous utilisons le routeur (ou calculateur d’itinéraires) R5 de Conveyal, qui est en accès libre (<span class="citation" data-cites="conway2017">Conway et Stewart (<a href="#ref-conway2019" role="doc-biblioref">2019</a>)</span>) à partir du package R <span class="citation" data-cites="r5r">(<a href="#ref-r5r" role="doc-biblioref"> et al. 2021</a>)</span>, des données cartographiques OpenStreetMap <span class="citation" data-cites="OpenStreetMap">OpenStreetMap contributors (<a href="#ref-OpenStreetMap" role="doc-biblioref">2017</a>)</span>, et des données de transport en commun au format GTFS de l’agglomération de la Rochelle établies par Yélo (https://transport.data.gouv.fr/datasets/arrets-horaires-et-parcours-theoriques-des-reseaux-naq-lro-nva-m) ainsi que les données TER de la SNCF (https://transport.data.gouv.fr/datasets/horaires-des-lignes-ter-sncf).</p></li><li id="fn14"><p><sup>14</sup>&nbsp;Cette liste pourrait être augmentée par la prise en compte de la pente (principalement le vélo ou la marche), l’accessibilité pour les personnes à mobilité réduite ou encore la congestion. Les outils utilisés permettent la prise en compte facilement de la congestion. Nous sommes également en mesure de produire une congestion simulée, mais nous préférerions accéder à des données fines de congestion effective, plus réalistes que les simulées, disponibles mais coûteuses.</p></li></div></div>
<div class="page-columns page-full"><p>Pour ce faire nous calculons à partir d’un calculateur d’itinéraire<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a> les distances et surtout les temps de transport pour 4 modes (voiture, vélo, transport en commun, marche à pied). Les temps de transport calculés pour chaque paire de carreaux de résidence et d’emploi, en retenant le centre des carreaux, tiennent compte des différentes contraintes de circulation (vitesses limites pour la voiture, sens de circulation, pénalité pour changement de direction, accès autorisé ou restreint suivant le mode, stress à vélo)<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a> . Concernant les déplacements en voiture, nous ne prenons pas en compte à ce stade la congestion . Concernant les transports en commun, le niveau de détail est assez grand, puisque les fréquences de voyages ainsi que les correspondances sont prises en compte . Dans certaines villes, il est possible d’accéder à une information sur les temps de parcours effectifs (mesurant ainsi la congestion ou la disponibilité du réseau) en complément des horaires théoriques . Ces informations ne sont pas disponible pour l’agglomération de la Rochelle et donc cette possibilité n’est pas explorée . L’accès aux données GTFS impose quelques limites, comme par exemple la non prise en compte des réseaux scolaires ou d’autres réseaux locaux ou privés non publiés sous ce format . La modification du réseau de transport comme l’ouverture d’une ligne ou l’accroissement de fréquence est pris en compte en modifiant la matrice des distances et temps par mode entre chaque carreau de résidence et chaque carreau de destination . Dans le cas de l’agglomération de la Rochelle, le nombre de paires calculés est de l’ordre de 16 millions .</p><div class="no-row-height column-margin column-container"><li id="fn15"><p><sup>15</sup>&nbsp;INfrastructure for SPatial InfoRmation in Europe est depuis 2007 une directive pour la production de données spatialisées. Inspire définit une grille de carroyage et son système de projection harmonisée. C’est ce qui suit l’INSEE dans la diffusion des données carroyées. Voir https://inspire-geoportal.ec.europa.eu pour la définition de la grille et des jeux de données.</p></li><li id="fn16"><p><sup>16</sup>&nbsp;Une alternative est d’utiliser FLORES qui propose une localisation de l’emploi à la commune sur la base des DADS. FLORES fournit probablement une donnée de meilleure qualité, mais comme nous utilisons ensuite les flux entre communes de résidence et d’emploi, pour des raisons de cohérence, il est plus logique d’utiliser <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022a</a>)</span>.</p></li></div></div>
<p>A partir des temps de trajets par mode, nous appliquons un modèle de choix discret, à la McFadden, estimé sur l’enquête mobilité des personnes 2019 <span class="citation" data-cites="MOBPERS">SDES (<a href="#ref-MOBPERS" role="doc-biblioref">2021</a>)</span> en utilisant les données de mobilités professionnelles <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022a</a>)</span> pour caler les flux commune à commune. L’estimation de ce modèle est détaillée dans un autre document (référence à insérer).</p>
<p>Les distances entre chaque paire de cases permettent de calculer un indicateur d’accessibilité qui joue un rôle central dans le modèle radiatif, et donc dans MEAPS, en remplaçant la distance par la somme des opportunités en deçà d’un seuil de temps. La carte de la <a href="#fig-4access">figure&nbsp;9</a> représente les temps pour accéder à 10 000 emplois en utilisant différents modes de transport.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-4access" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/access_4modes.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;9: Temps d’accès à 10 000 emplois. Pour chaque carreau de résidence, on détermine le temps minimal pour atteindre au moins 10 000 emplois suivant l’un des quatre modes considéré. Cette mesure remplace la distance dans le modèle radiatif. Calcul des auteurs. Sources : OSM, Mapbox, IGN, Conveyal R5, carroyage INSEE 2017, Flores et fichiers fonciers 2018</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Les courbes d’accessibilité de la <a href="#fig-comaccess">figure&nbsp;10</a> sont construite en prenant la moyenne par commune de résidence des temps d’accès pour les différents seuils d’emplois. C’est cette courbe qui découle du modèle théorique présenté plus haut (<a href="#sec-meaps">Section&nbsp;3</a>) et qui détermine les choix individuels de déplacement comme de localisation. Ces courbes font apparaître une propriété propre aux villes littorales : si pour des temps courts ou des moyens de transport peu rapide, l’accès à l’emploi pour des temps courts est maximal à la Rochelle, en revanche, d’autres communes jouissent d’une position plus centrale lorsqu’on accepte des temps de trajets supérieurs à 30 minutes en voiture.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-comaccess" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/access_par_com.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;10: Courbe du temps d’accès aux emplois. Pour chaque commune, on calcule la médianne, pondérée par le nombre d’habitants par carreau, du temps d’accès à différents seuils d’emplois. Cela permet de caractériser les communes par leur accessibilité à l’emploi, une mesure plus pertinente de la ‘distance à l’emploi’. Calcul des auteurs. Sources : OSM, Mapbox, IGN, Conveyal R5, carroyage INSEE 2017, Flores et fichiers fonciers 2018</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ajustement-de-meaps-sur-mobpro" class="level3 page-columns page-full" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="ajustement-de-meaps-sur-mobpro"><span class="header-section-number">5.3</span> Ajustement de MEAPS sur MOBPRO</h3>
<p>La construction de la matrice de distance permet d’utiliser MEAPS pour déduire les flux carreau à carreau. Mais le fichier détail du recensement et son volet mobilités professionnelles nous donnent une information supplémentaire que nous pouvons utiliser pour calibrer au plus près des données MEAPS. Les mobilités professionnelles décrivent pour chaque paire de commune résidence-emploi les flux de mobilités professionnelles (de nombreuses paires de communes ont des flux nuls). Cette information est équivalente à celle produite par MEAPS mais agrégée au niveau communal. Une première stratégie de calage de MEAPS est d’affecter aux probabilités d’absorption un facteur correcteur pour reproduire le plus fidèlement possible les flux agrégés de <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022a</a>)</span>. Cette approche permet ensuite d’utiliser MEAPS sur les données <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022a</a>)</span> pour réaliser une interpolation infra-communale des déplacements, au carreau 200m. En accédant à ce niveau de détail, nous pouvons ensuite mobiliser la méthode de calcul des distances et des temps de trajets à une échelle fine pour produire des différences au carreau 200m. Dans une autre approche, plus parcimonieuse, on pourrait limiter le nombre de paramètres estimés pour MEAPS, afin d’une apprécier la qualité prédictive et le comparer à une autre approche. Nous détaillerons cette autre approche dans un futur document.</p>
<p>La modification des probabilités d’absorption est faite par l’ajout d’un facteur correcteur exprimé en “chance”, c’est-à-dire que la probabilité modifiée l’est par la formule suivante où <span class="math inline">\omicron_{i,j}</span> est un nombre entre <span class="math inline">0</span> et <span class="math inline">+\infty</span> et <span class="math inline">i,j</span> indexent les communes de départ et d’arrivée avec <span class="math inline">c_a = p_a/(1-p_a)</span>:</p>
<p><span id="eq-odd"><span class="math display">
\tilde{p}_a = \frac{c_a \times \omicron_{i,j}} {1+c_a \times \omicron_{i,j}}
\tag{21}</span></span></p>
<p>A ce stade nous utilisons un algorithme naïf pour trouver une solution au problème posé. Nous calculons l’<em>odd-ratio</em> entre le résultat d’une simulation associée à un ensemble d’<span class="math inline">\omicron_{i,j}</span> et celui défini par les données observées de <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022a</a>)</span> en utilisant la formule suivante où <span class="math inline">\beta</span> est un paramètre d’amortissement inférieur à 1 et positif et <span class="math inline">k</span> indexe les itérations :</p>
<p><span id="eq-algest"><span class="math display">
\omicron^k_{i,j} = (\frac{\tilde{p}^k_a/(1-\tilde{p}^k_a)}{
p^{mobpro}_a/(1-p^{mobpro}_a)})^\beta \times \omicron^{k-1}_{i,j}
\tag{22}</span></span></p>
<p>Nous modifions alors les <span class="math inline">\omicron_{i,j}</span> en fonction des écarts observés. Cela conduit à chercher un point fixe. Nous calculons ensuite un critère d’ajustement à partir de l’entropie relative de Kullback-Leibler <span class="citation" data-cites="kullback1951">(<a href="#ref-kullback1951" role="doc-biblioref">Kullback et Leibler 1951</a>)</span>. L’entropie relative est définie pour deux distributions de probabilités <span class="math inline">p</span> et <span class="math inline">q</span> comme suit (dans le cas discret, le cas continu se généralise aisément) :</p>
<p><span id="eq-kl"><span class="math display">
KL(p,q) = \sum_{i}p_i \times log(p_i/q_i)
\tag{23}</span></span></p>
<p>Cette mesure ressemble à une distance, mais n’est pas symétrique et ne vérifie pas l’inégalité triangulaire. Elle s’interprète dans le cadre de la théorie de l’information comme la quantité relative d’information supplémentaire nécessaire pour exprimer <span class="math inline">q</span> à partir de <span class="math inline">p</span>. En suivant <span class="citation" data-cites="colincameron1997">Colin Cameron et Windmeijer (<a href="#ref-colincameron1997" role="doc-biblioref">1997</a>)</span> on peut construire un coefficient <span class="math inline">R_{KL}^2</span> de la façon suivante, où <span class="math inline">\hat{q}</span> et <span class="math inline">q_0</span> sont deux distributions respectivement estimée et de référence que l’on compare à <span class="math inline">p</span> :</p>
<p><span id="eq-r2kl"><span class="math display">
R_{KL}^2 = 1 - \frac{KL(p,\hat{q})}{KL(p, q_0)}
\tag{24}</span></span></p>
<p>La distribution de référence est choisie comme une distribution uniforme, par analogie avec le calcul de la variance dans un <span class="math inline">R^2</span> habituel où l’on régresse sur une constante. On écrit :</p>
<p><span id="eq-klent"><span class="math display">
\begin{aligned}
KL(p,q_{ref}) &amp;{}= \sum_{i}p_i \times log(p_i/unif) \\&amp;{}= \sum_i p_i \times log(p_i) + log(N)
\end{aligned}
\tag{25}</span></span></p>
<p>qui n’est autre que l’entropie de la distribution <span class="math inline">p</span> à une constante près (<span class="math inline">N</span> est le nombre de résidents actifs ou d’emplois).</p>
<p>L’algorithme employé devra être affiné dans le futur afin de permettre une descente de gradient qui permet de minimiser l’entropie relative. L’algorithme naïf permet de réduire cette entropie relative sans assurer qu’elle est minimale. Nous utiliserons l’algorithme naïf pour explorer la possibilité d’ajuster MEAPS sur un jeu de données. Cet algorithme a été utilisé avec différentes contraintes sur les paramètres. Le <a href="#tbl-meapsR2">tableau&nbsp;5</a> indique la qualité de l’ajustement obtenu dans ces différentes configurations. La première est celle où les probabilités d’absorption sont déterminées uniquement par les fuites par commune de résidence. C’est la configuration la plus parcimonieuse en termes de paramètres et qui sert de référence. Le <span class="math inline">R^2_{KL}</span> vaut 89.1% ce qui est déjà un ajustement élevé. La seconde configuration est celle où l’on ajuste des <span class="math inline">\omicron_{i,j}</span> uniquement pour les termes diagonaux (<span class="math inline">i=j</span>). Cette configuration ajuste donc un <em>odd-ratio</em> pour les résidents qui travaillent dans leur commune de résidence. Dans un certain nombre de communes, cet ajustement conduit à augmenter la probabilité d’absorption interne (<a href="#fig-carteodd">figure&nbsp;13</a>), ce qui indique que le choix de résidence n’est pas indépendant de celui d’activité. Pour la commune la plus importante (la Rochelle), en revanche, l’<em>odd-ratio</em> <span class="math inline">\omicron_{17300, 17300}</span> est proche de 1. Les deux configurations suivantes laissent beaucoup plus de degrés de liberté en estimant des <span class="math inline">\omicron_{i,j}</span> librement. La première de ces deux configurations limite les <span class="math inline">\omicron_{i,j}</span> estimés à ceux représentant un total cumulé des flux mesurés par <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022a</a>)</span> égal à 98% ce qui représente un peu moins de 2 000 <span class="math inline">\omicron_{i,j}</span>. La seconde configuration estime tous les <span class="math inline">\omicron_{i,j}</span> sans limite (soit 15 120 paramètres pour 72 communes de résidence et 210 communes d’activité).</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="tbl-meapsR2" class="anchored page-columns page-full">

<div id="hztldhkijf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#hztldhkijf) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#hztldhkijf) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#hztldhkijf) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#hztldhkijf) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#hztldhkijf) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#hztldhkijf) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#hztldhkijf) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#hztldhkijf) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#hztldhkijf) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#hztldhkijf) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#hztldhkijf) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#hztldhkijf) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#hztldhkijf) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#hztldhkijf) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#hztldhkijf) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#hztldhkijf) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#hztldhkijf) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#hztldhkijf) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hztldhkijf) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#hztldhkijf) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#hztldhkijf) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hztldhkijf) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#hztldhkijf) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#hztldhkijf) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#hztldhkijf) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hztldhkijf) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#hztldhkijf) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#hztldhkijf) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#hztldhkijf) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#hztldhkijf) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hztldhkijf) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#hztldhkijf) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hztldhkijf) .gt_left {
  text-align: left;
}

:where(#hztldhkijf) .gt_center {
  text-align: center;
}

:where(#hztldhkijf) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#hztldhkijf) .gt_font_normal {
  font-weight: normal;
}

:where(#hztldhkijf) .gt_font_bold {
  font-weight: bold;
}

:where(#hztldhkijf) .gt_font_italic {
  font-style: italic;
}

:where(#hztldhkijf) .gt_super {
  font-size: 65%;
}

:where(#hztldhkijf) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#hztldhkijf) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#hztldhkijf) .gt_indent_1 {
  text-indent: 5px;
}

:where(#hztldhkijf) .gt_indent_2 {
  text-indent: 10px;
}

:where(#hztldhkijf) .gt_indent_3 {
  text-indent: 15px;
}

:where(#hztldhkijf) .gt_indent_4 {
  text-indent: 20px;
}

:where(#hztldhkijf) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="N(p<sub>f,i</sub>)">N(p<sub>f,i</sub>)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="N(o<sub>i,j</sub>)">N(o<sub>i,j</sub>)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="R<sub>KL</sub><sup>2</sup>">R<sub>KL</sub><sup>2</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="config" class="gt_row gt_left">Fuite par commune de résidence</td>
<td headers="n_fuite" class="gt_row gt_right">72</td>
<td headers="n_params" class="gt_row gt_right">0</td>
<td headers="r2kl" class="gt_row gt_right">89.1%</td></tr>
    <tr><td headers="config" class="gt_row gt_left">Fuite et diagonale</td>
<td headers="n_fuite" class="gt_row gt_right">72</td>
<td headers="n_params" class="gt_row gt_right">72</td>
<td headers="r2kl" class="gt_row gt_right">94.3%</td></tr>
    <tr><td headers="config" class="gt_row gt_left">Fuite et 90% des flux</td>
<td headers="n_fuite" class="gt_row gt_right">72</td>
<td headers="n_params" class="gt_row gt_right">729</td>
<td headers="r2kl" class="gt_row gt_right">95.9%</td></tr>
    <tr><td headers="config" class="gt_row gt_left">Fuite et 99% des flux</td>
<td headers="n_fuite" class="gt_row gt_right">72</td>
<td headers="n_params" class="gt_row gt_right">1 928</td>
<td headers="r2kl" class="gt_row gt_right">98.3%</td></tr>
    <tr><td headers="config" class="gt_row gt_left">Fuite et 100% des flux</td>
<td headers="n_fuite" class="gt_row gt_right">72</td>
<td headers="n_params" class="gt_row gt_right">15 120</td>
<td headers="r2kl" class="gt_row gt_right">99.0%</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"> L'ajustement de MEAPS est réalisé par l'algorithme décrit dans le texte. Le nombre de paramètres estimés est égal à la somme de la colonne N(p<sub>f,i</sub>) et de la colonne N(o<sub>i,j</sub>).</td>
    </tr>
  </tfoot>
</table>
<div class="quarto-table-caption margin-caption">tableau&nbsp;5:  Ajustement de MEAPS </div></div>
</div>
</div>
</div>
<p>la <a href="#fig-actvsfit">figure&nbsp;11</a> représente les flux observés et estimés pour les différentes configurations du <a href="#tbl-meapsR2">tableau&nbsp;5</a>. Le gain à estimer les <span class="math inline">\omicron_{i,i}</span> diagonaux, pondérant les flux allant d’une commune de résidence vers elle même est assez élevé, faisant passer le <span class="math inline">R^2_{KL}</span> de 89.1% à 94.3% et réduisant les écarts entre flux observé et flux estimé comme le montrent les deux panneaux supérieurs de la <a href="#fig-actvsfit">figure&nbsp;11</a>. L’ajout de paramètres supplémentaires ne fait pas gagner beaucoup plus d’autant que les écarts pour les flux marginaux ne sont pas tant réduit que ça. La limite de l’algorithme naïf apparaît ici, puisque le modèle complètement saturé n’ajuste pas totalement la distribution. Différents détails de l’algorithme peuvent l’expliquer, notamment la censure des <em>odd-ratio</em> trop faibles (&lt;0.001) ou trop importants (&gt;1000). Au-delà de cet argument, il est probable que pour converger vers un ajustement plus strict, il serait nécessaire de calculer la matrice des quasi dérivées des flux par rapport aux <span class="math inline">\omicron_{i,j}</span>.</p>
<div class="page-columns page-full"><p>Mais le coût peut être très élevé puisque cette matrice (calculée dans la partie synthétique dans un cas simple) est d’une taille considérable (15 120 <span class="math inline">\times</span> 15 120 coefficients), surtout si l’on prend en compte que le calcul de chaque terme prend quelques dizaine de secondes<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn17"><p><sup>17</sup>&nbsp;Autour de mille années de vCPU…</p></li></div></div>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-actvsfit" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/estmeaps.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;11: La figure présente pour chaque configuration d’estimation le flux observé (axe des x) et le flux estimé (axe des y) en bleu lorsque o<sub>i,j</sub> est estimé et en vert lorsqu’il n’est pas estimé. La valeur de référence est répétée dans chaque panneau en gris clair.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Pour les 20 plus grandes communes de l’agglomération de la Rochelle – qui comptent plus de 1 000 résidents en activité – on peut représenter les <em>odd-ratios</em> estimés (dans la configuration 100% des flux) en fonction de la distance de la commune de destination à la commune de résidence. L’élément le plus frappant est que les odd-ratios de <span class="math inline">i</span> à <span class="math inline">i</span> sont généralement supérieur à 1, à l’exception de la commune de la Rochelle. Il n’émerge pas de structure particulière par rapport à la distance, si ce n’est des <em>odd-ratios</em> élevés pour des distances importantes.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-spectre" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/spectre100.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;12: La figure représente pour les 20 plus grandes communes de l’agglomération de la Rochelle les odd-ratios estimés (100% des flux) en fonction de la distance entre commune. La distance est construite comme la distance moyenne pondérée entre les résidents de la commune de départ et les emplois de la commune d’arrivée. La pondération est le produit des emplois et des résidents pour chqeu paire, normalisé à 1.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La carte de la <a href="#fig-carteodd">figure&nbsp;13</a> permet de préciser la valeur élevée des <em>odd-ratio</em> pour les flux internes. Les communes où sont localisés de nombreux emplois ont un <em>odd-ratio</em> plutôt plus faible alors qu’ils sont estimés plus élevés dans les communes plus petites et moins desservies. Un <em>odd-ratio</em> élevé indique que les flux internes sont plus élevés que dans le scénario de référence [[ce serait bien de calculer les probabilités d’absorption (qui dépendent des fuites et de tous les <em>odds</em> plutôt que de discuter des odds)]]. Cela indique probablement un choix de résidence en lien avec l’emploi occupé en privilégiant la commune d’activité pour la résidence (ou l’inverse). Le spectre en fonction de la distance indique que ce phénomène, s’il est un hypothèse à très faible distance, ne persiste pas en dehors de la commune de résidence.<br>
</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-carteodd" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="output/diagonale.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">figure&nbsp;13: Chaque cercle indique les odd-ratio estimés dans la diagonale (100% des flux). Les diamètres des cercles sont proportionels aux flux internes (de i à i).</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scénarios-localisation-de-lemploi" class="level3 page-columns page-full" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="scénarios-localisation-de-lemploi"><span class="header-section-number">5.4</span> Scénarios “localisation de l’emploi”</h3>
<p>Le Schéma de Cohérence Territorial (SCoT) est un document de planification, établi et voté par les élus des communes composant le territoire et soumis à validation de l’État. Il défini, entre autres, des zones de développement économique, urbaines et des espaces naturels. C’est la loi SRU relative à la Solidarité et au Renouvellement Urbains du 13 décembre 2000 qui l’a défini et les contours en ont été modifiés au cours des dernières années.</p>
<p>Le schéma n’est pas qu’indicatif puisqu’il est opposable. En ce qui concerne le développement de l’emploi, la création de zones d’activité est rendue possible par le SCoT, mais la réalisation effective des créations d’emploi et surtout leur localisation nette des déplacements d’autres emplois découle des décisions de l’ensemble des acteurs et donc et donc de causalités diverses et variées. Nous évaluons ici des scénarios comptatible avec le SCoT sans pour autant nous prononcer quant à leur réalisme ou leur probabilité d’occurrence. Ainsi, nous analysons les localisations proposées à emploi total constant, c’est-à-dire vues comme des relocalisations de l’emploi vers les zones d’activités depuis leur localisation actuelle.</p>
<div class="page-columns page-full"><p>La construction de cette analyse impose donc de connaître précisément la localisation de l’emploi, ce que nous réalisons par une imputation au carreau INSPIRE 200m à partir des données d’emploi par commune[^16]. Nous calons alors MEAPS sur ces données ainsi que sur les données de mobilité professionnelles issues du recensement<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a> et publiées par l’INSEE. Ces données donnent les lieux habituels de travail (à la commune) pour les différents résidents (d’une commune) ainsi que les flux correspondant entre paires de communes.</p><div class="no-row-height column-margin column-container"><li id="fn18"><p><sup>18</sup>&nbsp;https://www.insee.fr/fr/information/2383243</p></li></div></div>
<div class="page-columns page-full"><p>La construction de cette analyse impose donc de connaître précisément la localisation de l’emploi, ce que nous réalisons par une imputation au carreau INSPIRE 200m à partir des données d’emploi par commune. Nous calons alors MEAPS sur ces données ainsi que sur les données de mobilité professionnelles issues du recensement<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a> et publiées par l’INSEE. Ces données donnent les lieux habituels de travail (à la commune) pour les différents résidents (d’une commune) ainsi que les flux correspondant entre paires de communes.</p><div class="no-row-height column-margin column-container"><li id="fn19"><p><sup>19</sup>&nbsp;Autour de mille années de vCPU…</p></li></div></div>
<ul>
<li>Une fois MEAPS calé sur ces données, nous pouvons analyser des scénarios de déplacement des emplois et en déduire les conséquences en trajets, mode de transport et donc émissions de CO<sub>2</sub> associé</li>
</ul>
</section>
<section id="scénarios-transport-en-commun" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="scénarios-transport-en-commun"><span class="header-section-number">5.5</span> Scénarios “transport en commun”</h3>
<p>L’analyse du territoire ne repose pas seulement sur la localisation de l’emploi, mais aussi sur une prise en compte détaillée des possibilités de transport.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="bibliographie" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="bibliographie">Bibliographie</h2>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-ben-akiva2018" class="csl-entry" role="doc-biblioentry">
Ben-Akiva, Moshe, et Steven R. Lerman. 2018. <em>Discrete Choice Analysis: Theory and Application to Travel Demand</em>. Transportation Series. MIT Press.
</div>
<div id="ref-colincameron1997" class="csl-entry" role="doc-biblioentry">
Colin Cameron, A., et Frank A. G. Windmeijer. 1997. <span>«&nbsp;An R-Squared Measure of Goodness of Fit for Some Common Nonlinear Regression Models&nbsp;»</span>. <em>Journal of Econometrics</em> 77 (2): 329‑42. <a href="https://doi.org/10.1016/s0304-4076(96)01818-0">https://doi.org/10.1016/s0304-4076(96)01818-0</a>.
</div>
<div id="ref-conway2017" class="csl-entry" role="doc-biblioentry">
Conway, Matthew Wigginton, Andrew Byrd, et Marco van der Linden. 2017. <span>«&nbsp;Evidence-Based Transit and Land Use Sketch Planning Using Interactive Accessibility Methods on Combined Schedule and Headway-Based Networks&nbsp;»</span>. <em>Transportation Research Record: Journal of the Transportation Research Board</em> 2653 (1): 45‑53. <a href="https://doi.org/10.3141/2653-06">https://doi.org/10.3141/2653-06</a>.
</div>
<div id="ref-conway2018" class="csl-entry" role="doc-biblioentry">
Conway, Matthew Wigginton, Andrew Byrd, et Michael Van Eggermond. 2018. <span>«&nbsp;Accounting for uncertainty and variation in accessibility metrics for public transport sketch planning&nbsp;»</span>. <em>Journal of Transport and Land Use</em> 11 (1). <a href="https://doi.org/10.5198/jtlu.2018.1074">https://doi.org/10.5198/jtlu.2018.1074</a>.
</div>
<div id="ref-conway2019" class="csl-entry" role="doc-biblioentry">
Conway, Matthew Wigginton, et Anson F. Stewart. 2019. <span>«&nbsp;Getting Charlie Off the MTA: A Multiobjective Optimization Method to Account for Cost Constraints in Public Transit Accessibility Metrics&nbsp;»</span>. <em>International Journal of Geographical Information Science</em> 33 (9): 1759‑87. <a href="https://doi.org/10.1080/13658816.2019.1605075">https://doi.org/10.1080/13658816.2019.1605075</a>.
</div>
<div id="ref-de2011modelling" class="csl-entry" role="doc-biblioentry">
Dios Ortúzar, Juan de, et Luis G Willumsen. 2011. <em>Modelling transport</em>. John wiley &amp; sons.
</div>
<div id="ref-heanue1966" class="csl-entry" role="doc-biblioentry">
Heanue, Kevin E., et Clyde E. Pyers. 1966. <span>«&nbsp;A Comparative Evaluation of Trip Distribution Procedures&nbsp;»</span>. <em>Highway Reserach Record</em>, nᵒ 114: 20‑50.
</div>
<div id="ref-handbook2007" class="csl-entry" role="doc-biblioentry">
Hensher, David A., et Kenneth J. Button, éd. 2007. <span>«&nbsp;Handbook of Transport Modelling&nbsp;»</span>. <em>Handbooks in Transport</em>, septembre. <a href="https://doi.org/10.1108/9780857245670">https://doi.org/10.1108/9780857245670</a>.
</div>
<div id="ref-MOBPRO" class="csl-entry" role="doc-biblioentry">
INSEE. 2022a. <span>«&nbsp;Mobilités professionnelles en 2019 : déplacements domicile - lieu de travail Recensement de la population - Base flux de mobilité&nbsp;»</span>. <a href="https://www.insee.fr/fr/statistiques/6454112" class="uri">https://www.insee.fr/fr/statistiques/6454112</a>.
</div>
<div id="ref-C200" class="csl-entry" role="doc-biblioentry">
———. 2022b. <span>«&nbsp;Revenus, pauvreté et niveau de vie en 2017 - Données carroyées. Dispositif Fichier localisé social et fiscal (Filosofi)&nbsp;»</span>. <a href="https://www.insee.fr/fr/statistiques/6214811?sommaire=6215217" class="uri">https://www.insee.fr/fr/statistiques/6214811?sommaire=6215217</a>.
</div>
<div id="ref-kullback1951" class="csl-entry" role="doc-biblioentry">
Kullback, S., et R. A. Leibler. 1951. <span>«&nbsp;On Information and Sufficiency&nbsp;»</span>. <em>The Annals of Mathematical Statistics</em> 22 (1): 79‑86. <a href="https://doi.org/10.1214/aoms/1177729694">https://doi.org/10.1214/aoms/1177729694</a>.
</div>
<div id="ref-lasser2020" class="csl-entry" role="doc-biblioentry">
Lasser, Jana. 2020. <span>«&nbsp;Creating an Executable Paper Is a Journey Through Open Science&nbsp;»</span>. <em>Communications Physics</em> 3 (1). <a href="https://doi.org/10.1038/s42005-020-00403-4">https://doi.org/10.1038/s42005-020-00403-4</a>.
</div>
<div id="ref-OpenStreetMap" class="csl-entry" role="doc-biblioentry">
OpenStreetMap contributors. 2017. <span>«&nbsp;<span>Planet dump retrieved from https://planet.osm.org</span>&nbsp;»</span>. <a href="https://www.openstreetmap.org" class="uri">https://www.openstreetmap.org</a>.
</div>
<div id="ref-patrickbonnel2001" class="csl-entry" role="doc-biblioentry">
Patrick Bonnel. 2001. <span>«&nbsp;Prévision de la demande de transport&nbsp;»</span>. Thèse de doctorat, Lyon, France.
</div>
<div id="ref-r5r" class="csl-entry" role="doc-biblioentry">
Rafael H. M. Pereira, Marcus Saraiva, Daniel Herszenhut, Carlos Kaue Vieira Braga, et Matthew Wigginton Conway. 2021. <span>«&nbsp;r5r: Rapid Realistic Routing on Multimodal Transport Networks with R5 in R&nbsp;»</span>. <a href="https://doi.org/10.32866/001c.21262">https://doi.org/10.32866/001c.21262</a>.
</div>
<div id="ref-MOBPERS" class="csl-entry" role="doc-biblioentry">
SDES, Ministère de la transition écologique et de la cohésion des territoires. 2021. <span>«&nbsp;EMP 2019 Résultats détaillés de l’enquête mobilité des personnes de 2019&nbsp;»</span>. <a href="https://www.statistiques.developpement-durable.gouv.fr/resultats-detailles-de-lenquete-mobilite-des-personnes-de-2019" class="uri">https://www.statistiques.developpement-durable.gouv.fr/resultats-detailles-de-lenquete-mobilite-des-personnes-de-2019</a>.
</div>
<div id="ref-simini2012" class="csl-entry" role="doc-biblioentry">
Simini, Filippo, Marta C. González, Amos Maritan, et Albert-László Barabási. 2012. <span>«&nbsp;A Universal Model for Mobility and Migration Patterns&nbsp;»</span>. <em>Nature</em> 484 (7392): 96‑100. <a href="https://doi.org/10.1038/nature10856">https://doi.org/10.1038/nature10856</a>.
</div>
<div id="ref-stouffer1940" class="csl-entry" role="doc-biblioentry">
Stouffer, Samuel A. 1940. <span>«&nbsp;Intervening Opportunities: A Theory Relating Mobility and Distance&nbsp;»</span>. <em>American Sociological Review</em> 5 (6): 845. <a href="https://doi.org/10.2307/2084520">https://doi.org/10.2307/2084520</a>.
</div>
<div id="ref-wilson1967" class="csl-entry" role="doc-biblioentry">
Wilson, A. G. 1967. <span>«&nbsp;A Statistical Theory of Spatial Distribution Models&nbsp;»</span>. <em>Transportation Research</em> 1 (3): 253‑69. <a href="https://doi.org/10.1016/0041-1647(67)90035-4">https://doi.org/10.1016/0041-1647(67)90035-4</a>.
</div>
</div>
<div style="page-break-after: always;"></div>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{parodi2023,
  author = {Maxime Parodi and Xavier Timbeau},
  title = {MEAPS : Distribution statistique des trajets entre le
    domicile et le travail},
  date = {2023-03-01},
  url = {https://xtimbeau.github.io/larochelle/radiation/radiation.html},
  langid = {fr},
  abstract = {Nous proposons un modèle spatial de distribution des
    trajets entre emploi et résidence. En s’inspirant du modèle
    “intervening opportunities” de @stouffer1940 et du modèle radiatif
    de @simini2012, nous construisons un modèle ergodique d’absorption
    avec priorité et saturation (MEAPS) qui permet d’expliciter
    complètement des contraintes traitées de façon ad hoc dans la
    littérature. Le modèle s’accomode de différentes formulations des
    processus stochastiques fondamentaux qui permettent d’en déduire une
    procédure d’estimation, tout en conservant un fondement
    microscopique solide. Une conjecture d’ergodicité, validée sur des
    simulations numériques, permet de réduire les coûts en temps de
    calcul, autorisant des applications empiriques.}
}
</code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">Veuillez citer ce travail comme suit&nbsp;:</div><div id="ref-parodi2023" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Maxime Parodi, and Xavier Timbeau. 2023. <span>“MEAPS : Distribution
statistique des trajets entre le domicile et le travail.”</span>
<em>Document de travail de l’OFCE</em>. <a href="https://xtimbeau.github.io/larochelle/radiation/radiation.html">https://xtimbeau.github.io/larochelle/radiation/radiation.html</a>.
</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>