<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="keywords" content="modèle gravitaire, modèle radiatif, mobilités">

<title>MEAPS : Distribution statistique des trajets entre le domicile et le travail - 1&nbsp; Aspects théoriques de MEAPS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./simsynth.html" rel="next">
<link href="./intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Aspects théoriques de MEAPS</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MEAPS : Distribution statistique des trajets entre le domicile et le travail</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/xtimbeau/meaps/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Download" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-download"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./meaps.pdf">
            <i class="bi bi-bi-file-pdf pe-1"></i>
          Download PDF
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./meaps.epub">
            <i class="bi bi-bi-journal pe-1"></i>
          Download ePub
          </a>
        </li>
    </ul>
    <a href="https://twitter.com/intent/tweet?url=|url|" title="Twitter" class="sidebar-tool px-1"><i class="bi bi-twitter"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Résumé</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">Introduction générale</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./theorie.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Aspects théoriques de MEAPS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simsynth.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">MEAPS : Simulations synthétiques</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./larochelle.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Application à la Rochelle</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">Références bibliographiques</a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#sec-grav" id="toc-sec-grav" class="nav-link" data-scroll-target="#sec-grav"><span class="toc-section-number">1.1</span>  Les insuffisances du modèle gravitaire</a>
  <ul class="collapse">
  <li><a href="#les-mauvaises-raisons-du-succès-du-modèle-gravitaire" id="toc-les-mauvaises-raisons-du-succès-du-modèle-gravitaire" class="nav-link" data-scroll-target="#les-mauvaises-raisons-du-succès-du-modèle-gravitaire"><span class="toc-section-number">1.1.1</span>  Les (mauvaises) raisons du succès du modèle gravitaire</a></li>
  <li><a href="#le-voile-de-la-contrainte-aux-marges" id="toc-le-voile-de-la-contrainte-aux-marges" class="nav-link" data-scroll-target="#le-voile-de-la-contrainte-aux-marges"><span class="toc-section-number">1.1.2</span>  Le voile de la contrainte aux marges</a></li>
  </ul></li>
  <li><a href="#sec-rad" id="toc-sec-rad" class="nav-link" data-scroll-target="#sec-rad"><span class="toc-section-number">1.2</span>  Une première alternative : le modèle radiatif</a></li>
  <li><a href="#sec-meaps" id="toc-sec-meaps" class="nav-link" data-scroll-target="#sec-meaps"><span class="toc-section-number">1.3</span>  Un modèle ergodique d’absorption avec priorité et saturation (MEAPS)</a>
  <ul class="collapse">
  <li><a href="#rang-choix-des-destinations-et-absorption" id="toc-rang-choix-des-destinations-et-absorption" class="nav-link" data-scroll-target="#rang-choix-des-destinations-et-absorption"><span class="toc-section-number">1.3.1</span>  Rang, choix des destinations et absorption</a></li>
  <li><a href="#sec-priorite" id="toc-sec-priorite" class="nav-link" data-scroll-target="#sec-priorite"><span class="toc-section-number">1.3.2</span>  Saturation et priorité</a></li>
  <li><a href="#sec-erg" id="toc-sec-erg" class="nav-link" data-scroll-target="#sec-erg"><span class="toc-section-number">1.3.3</span>  Ergodicité</a></li>
  <li><a href="#sec-hetero" id="toc-sec-hetero" class="nav-link" data-scroll-target="#sec-hetero"><span class="toc-section-number">1.3.4</span>  Hétérogénéité de la fuite et de l’absorption</a></li>
  <li><a href="#synthèse-de-meaps" id="toc-synthèse-de-meaps" class="nav-link" data-scroll-target="#synthèse-de-meaps"><span class="toc-section-number">1.3.5</span>  Synthèse de MEAPS</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/xtimbeau/meaps/edit/main/theorie.qmd" class="toc-action">Modifier cette page</a></p></div></div></nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Aspects théoriques de MEAPS</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    <div>
    <div class="quarto-title-meta-heading">Modifié</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">3 février 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="introduction" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="introduction">Introduction</h2>
<p>Nous nous intéressons à la mobilité de la vie quotidienne et aux facteurs qui la déterminent. Pour cela nous voulons à la fois connaître le nombre de trajets qu’un individu effectue chaque jour, mais aussi quelles sont les destinations probables de ces trajets, les modes de transport et les temps passés à les effectuer. Cette connaissance suppose une modélisation qui produit un certain nombre de prédictions que l’on peut confronter à l’information dont on dispose. En particulier, on ne dispose pas, à ce jour, d’une information complète des trajets effectués pour chaque individu, même sur un échantillon réduit, vers chacune des destinations possibles, pour chacun des motifs envisageables. On mesure donc soit des distributions de trajets dans la population, par motif et par mode, issues d’enquêtes de mobilité, soit des nombre de trajets reliant telle commune de résidence à telle commune d’activité. L’information, quoique riche, ne couvre pas toute la complexité du phénomène considéré et la modélisation, par des hypothèses sur les comportements, permet de quantifier le lien entre quelques paramètres fondamentaux et les observations.</p>
<p>Intuitivement, l’analyse des trajets doit permettre de relier différentes dimensions de la géographie, de l’endroit où les gens habitent, à celui où ils s’affairent, en intégrant le réseau de transport qui leur permet de se déplacer, plus ou moins rapidement, plus ou moins en sécurité, pour un coût plus ou moins élevé. Puisque l’espace est partagé entre les individus, on s’attend à ce que la congestion ou la compétition pour des emplois, des lieux de résidences ou d’autres ressources rares, jouent des rôles à un moment ou un autre. La modélisation doit permettre, autant que possible, d’intégrer ces couches disparates dans un objet que l’on peut confronter aux données dont on dispose. Sur la base de cette modélisation, on doit pouvoir ensuite analyser des changements, que ce soit dans les comportements individuels, dans les masses d’emplois disponibles ou le nombre d’habitants, leur répartition spatiale, ou encore dans la structure du réseau de transport afin de construire des scénarios représentant ce qui pourrait se passer si on changeait quelque chose. La confrontation aux données est alors une étape importante, puisqu’on veut en tirer un diagnostic sur la modélisation et apprécier le potentiel prédictif.</p>
<p>Pour modéliser les trajets entre des lieux de résidence et des lieux d’emploi, on procède usuellement par la méthode à 4 étapes <span class="citation" data-cites="patrickbonnel2001 de2011modelling">(<a href="#ref-patrickbonnel2001" role="doc-biblioref">Patrick Bonnel 2001</a>; <a href="#ref-de2011modelling" role="doc-biblioref">Dios Ortúzar et Willumsen 2011</a>)</span>. Cette méthode consiste dans un premier temps à déterminer le nombre de trajets en partance d’un lieu de résidence ainsi que ceux arrivant au total dans un lieu d’activité. C’est l’étape 1 de génération des trajets. La seconde étape consiste à distribuer les trajets de l’étape 1 entre chaque paire de départ et de destination. C’est l’étape de distribution. La troisième étape est celle du choix modal, où pour chaque trajet (entre chaque origine et chaque destination) considéré se voit affecté un mode de transport. Enfin la quatrième étape du modèle à 4 étapes est celle qui spécifie le trajet et permet d’en connaître les caractéristiques précises, comme la distance parcourue, les axes employées ou les dénivelés effectués. Cette décomposition est un peu arbitraire et ne rend pas compte avec justice de l’état de l’art. Le nombre de trajets effectué dépend en effet des possibilités ouvertes par la géographie qui sont définies par les caractéristiques précises des trajets. L’étape 4 est donc nécessaire pour comprendre l’étape 1, et l’étape 4 demande de connaître les choix modaux pour être utile aux choix fait en 1. L’étape 2 est nécessaire pour explorer les possibilités de trajets. Les imbrications sont nombreuses entre les étapes et la décomposition n’interdit pas d’effectuer des allers et retours entre les diverses étapes.</p>
<p>Nous développons ici un modèle qui permet de distribuer les trajets qui ont été assignés en première étape. Le modèle gravitaire est largement employé dans cette deuxième étape pour prendre en compte le rôle de la distance. Plus un emploi est loin, moins il doit être attractif. Un individu doit donc préférer les emplois près de lui à ceux qui sont éloignés.</p>
<p>Ce modèle gravitaire est loin d’être convainquant et nous discutons dans une première partie de ses insuffisances (<a href="#sec-grav"><span class="quarto-unresolved-ref">sec-grav</span></a>). Le modèle des opportunités intervenantes de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> et le modèle radiatif de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> qui font intervenir le rang de classement des emplois plutôt que la distance (<a href="#sec-rad"><span class="quarto-unresolved-ref">sec-rad</span></a>) et reposent sur une analogie plus adéquate aux échelles géographiques que nous considérons (commune, région) que celle de la gravitation. Nous présentons une version étendue du modèle radiatif qui produit deux résultats principaux :</p>
<ol type="1">
<li><p>au lieu de la distance, c’est le nombre d’emplois accessibles dans un cercle de rayon donné qui détermine le choix individuel.</p></li>
<li><p>nous explicitons la saturation et nous donnons un fondement microscopique au respect des contraintes aux marges (tout individu a un emploi, tout emploi est occupé par un individu) (<a href="#sec-meaps"><span class="quarto-unresolved-ref">sec-meaps</span></a>).</p></li>
</ol>
<p>La formulation est probabiliste et nous en analysons quelques propriétés par des simulations synthétiques (<a href="#sec-synt"><span class="quarto-unresolved-ref">sec-synt</span></a>), en montrant qu’on peut arriver rapidement à simuler un état indépendant des conditions initiales. Nous proposons ensuite une application à l’agglomération de la Rochelle (<a href="#sec-rochelle"><span class="quarto-unresolved-ref">sec-rochelle</span></a>), dans la quelle nous détaillons le processus de construction des données, proposons une procédure d’ajustement et exploitons le modèle ajusté pour des analyses de scénarios.</p>
</section>
<section id="sec-grav" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="sec-grav"><span class="header-section-number">1.1</span> Les insuffisances du modèle gravitaire</h2>
<p>Le modèle gravitaire est employé très fréquemment en économie spatiale <span class="citation" data-cites="handbook2007">(<a href="#ref-handbook2007" role="doc-biblioref">Hensher et Button 2007, chap. 2</a>)</span>. Il semble en effet répondre de façon satisfaisante au premier principe de Tobler :</p>
<blockquote class="blockquote">
<p>Tout est relié mais les choses proches sont plus reliées que les choses éloignées.</p>
</blockquote>
<p>Le modèle gravitaire développe une analogie avec le modèle de la gravitation universelle d’Isaac Newton dont les succès en physique et en mécanique sont immenses. Ce modèle est généralement la pierre angulaire de l’étape de distribution des trajets dans la décomposition à 4 étapes des modèles de transport <span class="citation" data-cites="de2011modelling patrickbonnel2001">(<a href="#ref-de2011modelling" role="doc-biblioref">Dios Ortúzar et Willumsen 2011</a>; <a href="#ref-patrickbonnel2001" role="doc-biblioref">Patrick Bonnel 2001, 160</a>)</span>. Il est également utilisé dans d’autres domaines, comme le commerce international ou l’analyse des épidémies, domaines que nous ne discuterons pas ici.</p>
<section id="les-mauvaises-raisons-du-succès-du-modèle-gravitaire" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="les-mauvaises-raisons-du-succès-du-modèle-gravitaire"><span class="header-section-number">1.1.1</span> Les (mauvaises) raisons du succès du modèle gravitaire</h3>
<p>Formellement, le modèle gravitaire décrit la force d’une relation entre deux objets en fonction de leur distance et de leur masse respective. Par analogie, le modèle gravitaire consiste ici à évaluer le nombre de trajets professionnels entre deux localisations en prenant pour masses le nombre d’habitants au point de départ et le nombre d’emplois au point d’arrivée et, pour distance, une fonction <span class="math inline">f</span> croissante de la distance. On a ainsi, en indiçant les points de départ par <span class="math inline">i</span> et les points d’arrivée par <span class="math inline">j</span> :</p>
<p><span id="eq-gravity"><span class="math display">
T_{i,j} = \frac {N_{hab, i}\times N_{emp, j}} {f(d_{i,j})}
\tag{1.1}</span></span></p>
<p>Les premiers modèles gravitaires ont emprunté la fonction <span class="math inline">f</span> à la physique newtonienne (<span class="math inline">f=1/d^2</span>), mais d’autres formulations ont depuis été proposées. Par exemple, la fonction <span class="math inline">f=e^{-d/\delta}</span> intervient dans les modèles de choix discrets proposés par McFadden <span class="citation" data-cites="ben-akiva2018">(<a href="#ref-ben-akiva2018" role="doc-biblioref">Ben-Akiva et Lerman 2018</a>)</span>. En remplaçant la distance par la notion de coût généralisé du transport, on peut relier cette forme fonctionnelle à un modèle de choix avec une fonction d’utilité aléatoire (<em>random utility model</em>). Il est également possible d’ajuster des formes fonctionnelles plus complexes en ajoutant des paramètres. Le modèle gravitaire arrive alors à reproduire plus ou moins des distributions de distances observées dans des enquêtes de mobilité.</p>
<p>Un raisonnement par minimisation de l’entropie a été proposé par <span class="citation" data-cites="wilson1967">Wilson (<a href="#ref-wilson1967" role="doc-biblioref">1967</a>)</span> pour donner un fondement théorique à l’<a href="#eq-gravity">équation&nbsp;<span class="quarto-unresolved-ref">eq-gravity</span></a>. Le raisonnement est de considérer l’état de référence comme étant celui qui est le plus fréquent dans une distribution aléatoire des choix. <span class="citation" data-cites="wilson1967">Wilson (<a href="#ref-wilson1967" role="doc-biblioref">1967</a>)</span> montre alors que, si la fonction <span class="math inline">f</span> est donnée, l’<a href="#eq-gravity">équation&nbsp;<span class="quarto-unresolved-ref">eq-gravity</span></a> a bien la forme proposée et que c’est le produit des habitants et des emplois qui doit se trouver au numérateur (et non une puissance de l’un ou l’autre par exemple). Mais rien ne permet de trouver un fondement à la forme fonctionnelle de <span class="math inline">f</span>. Le parallèle avec la physique est simple à faire : l’interaction définit le rôle de la distance, la maximisation de l’entropie permet d’en déduire que l’équation macroscopique dépend des masses agrégées, mais ne permet de dire quoique ce soit de plus sur la nature de l’interaction.</p>
<p>Comme le notent <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>, les fondations théoriques et empiriques de la fonction <span class="math inline">f</span> sont au mieux faibles. La multiplication des paramètres pour améliorer l’ajustement n’ont le plus souvent aucune justification théorique. De fait, on perd souvent toute possibilité de donner une signification aux paramètres estimé ce qui rend l’exercice d’ajustement opaque. Les comportements asymptotiques soulignent également des incohérences : par exemple, en faisant tendre vers l’infini les emplois à l’arrivée, le modèle prédit un nombre infini de trajets, même si le nombre de résidents au départ est limité ! Il est également insatisfaisant que le modèle gravitaire soit déterministe et ne permette ni d’expliquer les fluctuations statistiques du nombre de trajets prédits, ni d’évaluer la vraisemblance de différents cas empirique.</p>
<p>Mais la critique la plus forte du modèle gravitaire vient de ses propriétés fondamentales et des conclusions que l’on peut en tirer. Le nombre de trajets entre une origine (la résidence) et une destination (l’emploi) repose sur un simple arbitrage entre distance et quantité de résidents ou d’emplois. Le comportement du modèle aux limites, à nouveau, suscite la perplexité : un seul emploi à l’origine devrait être infiniment préféré un très grand nombre d’emplois un peu plus loin. C’est tout à fait irréaliste et l’on devine déjà que la distance ne joue pas un rôle si direct dans les comportements de mobilité. On voit également que le poids relatif de cet emploi quasi central par rapport aux “masses” d’emplois éloignés va varier de manière irréaliste selon qu’il est plus ou moins proche de l’origine.</p>
<p>Comme le soulignait déjà <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span>, ce n’est peut-être pas tant la distance aux emplois qui est décisive que le rang de ces emplois selon l’ordre des distances. Dans le modèle gravitaire, il faut faire une grande différence entre le cas où le deuxième emploi le plus proche est à 500 m et le cas où il est à 1 km. Si l’on applique le modèle newtonien, il faudrait croire, par exemple, que l’attractivité de ce dernier emploi est divisée par 4. Qui peut croire que 500 m de différence pèsent d’un si grand poids dans une recherche d’emploi ? L’attractivité de l’emploi dépend avant tout du fait qu’il s’agit du deuxième emploi disponible près de chez soi. Empiriquement, il y a peu de doutes que le modèle gravitaire a de piètres performances : il ne parvient pas à expliquer pourquoi, lorsque la densité des emplois est faible autour d’un résident, celui-ci va envisager des trajets plus long pour atteindre des zones denses en emplois ; c’est pourtant une observation très commune qui devrait se retrouver dans une modélisation adéquate.</p>
<p>Assez peu de publications se risquent à une comparaison systématique du modèle gravitaire avec d’autres formulations qui respecteraient la première loi de Tobler. On peut citer <span class="citation" data-cites="heanue1966">Heanue et Pyers (<a href="#ref-heanue1966" role="doc-biblioref">1966</a>)</span> comme une des rares tentatives de ce genre. Le modèle gravitaire semblait moins bon que le modèle des opportunités intervenantes (voir plus loin) s’il n’était pas ajusté de manière <em>ad hoc</em>, comme il est devenu usuel.</p>
<p><span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> donnent quelques exemples pour les Etats-Unis de la difficulté du modèle gravitaire à reproduire les comportements observés en en stylisant quelques régularités. A l’évidence, le modèle gravitaire ne prédit que des destinations proches et néglige complètement les destinations lointaines. Il semble impossible à la forme fonctionnelle <span class="math inline">f(d_{ij})</span> de rendre compte empiriquement à la fois du nombre de trajets courts et du nombre de trajets distants au travers d’un modèle susceptible de rendre compte des trajets dans différentes régions, dès lors que les densités y sont distribuées différemment.</p>
</section>
<section id="le-voile-de-la-contrainte-aux-marges" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="le-voile-de-la-contrainte-aux-marges"><span class="header-section-number">1.1.2</span> Le voile de la contrainte aux marges</h3>
<p>Le modèle gravitaire peut être complexifié pour mieux coller aux données qu’il ne le fait spontanément. Il perd alors un lien clair avec les réflexions théoriques le reliant à la maximisation de l’entropie <span class="citation" data-cites="wilson1967">(<a href="#ref-wilson1967" role="doc-biblioref">Wilson 1967</a>)</span> ou au modèle de choix discret. L’ajustement du modèle devient un exercice factice dans lequel il est difficile d’avoir confiance en particulier dans l’analyse des scénarios modélisés. L’exercice consiste à ajouter une étape de “normalisation” au modèle en incorporant dans le modèle des coefficients correctifs en ligne et en colonne dans la matrice origine-destination, ce qui revient à ajouter des effets fixes à chacun des points de départ et d’arrivée. La formulation du modèle gravitaire est alors modifiée comme suit :</p>
<p><span id="eq-gravmod"><span class="math display">
T_{i,j} = a_i \times b_j \times \frac {N_{hab, i}\times N_{emp, j}} {f(d_{i,j})}
\tag{1.2}</span></span></p>
<p>La détermination des coefficients <span class="math inline">a_i</span> et <span class="math inline">b_j</span> pose de nombreux problèmes. Ces coefficients doivent permettre de respecter les contraintes aux marges : la somme des emplois pour une ligne de résidents doit être égale au nombre des résidents employés dans la zone et la somme des résidents employés sur un lieu d’emploi doit, en colonne donc, être égale au nombre d’emplois en ce lieu) sur les déplacements. On a pour <span class="math inline">a_i</span> :</p>
<p><span id="eq-ai"><span class="math display">
\begin{aligned}
a_i &amp;{}= \frac {\Sigma_j T_{i,j}} {\Sigma_j \frac {b_j \times N_{hab, i} \times N_{emp, j}}{f(d_{i,j})}} \\
&amp;{}= \frac{1}{\Sigma_j \frac{ b_j \times N_{emp,j}}{f(d_{i,j})}}
\end{aligned}
\tag{1.3}</span></span></p>
<p><span class="math inline">\Sigma_j T_{i,j}</span> est généralement directement observé ou estimé lors de l’étape de génération dans les approches dites à 4 étapes. C’est le nombre de départs depuis le point <span class="math inline">i</span> et il est proportionnel aux nombre d’actifs résidant en <span class="math inline">i</span>. De la même façon on peut écrire pour <span class="math inline">b_j</span> une expression symétrique de celle de <span class="math inline">a_i</span>, qui fait intervenir <span class="math inline">\Sigma_i T_{i,j}</span> qui est également observée ou estimé auparavant. C’est le nombre de trajets convergeant vers le point d’arrivée <span class="math inline">j</span>, qui est proportionnel au nombre d’emplois en <span class="math inline">j</span>.</p>
<p><span id="eq-bj"><span class="math display">
\begin{aligned}
b_j &amp;{}= \frac {\Sigma_i T_{i,j}} {\Sigma_i \frac {a_i \times N_{hab, i} \times N_{emp, j}}{f(d_{i,j})}} \\
&amp;{}= \frac{1}{\Sigma_i \frac{a_i \times N_{hab,i}}{f(d_{i,j})}}
\end{aligned}
\tag{1.4}</span></span></p>
<p>La valeur de <span class="math inline">a_i</span>, pour un <span class="math inline">i</span> donné, dépend de l’évaluation de tous les <span class="math inline">b_j</span> et réciproquement l’évaluation de chaque <span class="math inline">b_j</span> dépend de celle de tous les <span class="math inline">a_i</span>. On peut estimer ces coefficients par itérations successives et espérer atteindre de cette manière un point fixe, éventuellement unique à une constante multiplicative près. Des algorithmes de résolution ont donc été proposés dans les principaux manuels. L’application de tels algorithmes (comme celui de Furness, <span class="citation" data-cites="de2011modelling">Dios Ortúzar et Willumsen (<a href="#ref-de2011modelling" role="doc-biblioref">2011</a>)</span>, p.&nbsp;192) peut toutefois modifier considérablement le résultat initial proposé par le modèle gravitaire, au risque d’en trahir la logique et les justifications initiales. En outre, la multiplicité des solutions et le choix retenu par l’algorithme demeure un angle mort de ces méthodes.</p>
<p>Mais surtout, cette procédure itérative se contente de multiplier par des facteurs arbitraires des lignes et des colonnes de la matrice origine-destination. Ceci ne change donc pas les poids relatifs des nombres de déplacements depuis une origine ou vers une destination. Or, si l’on pense que le modèle gravitaire estime mal ces poids relatifs, comme nous l’avons affirmé ci-dessus, alors cette normalisation ne change rien sur le fond : une destination éloignée est si fortement pénalisée dans le modèle gravitaire qu’aucun facteur multiplicatif ne peut faire remonter le nombre de trajets vers cette destination, sans faire crever le plafond au nombre de trajets plus proches.</p>
<p>La procédure de respect des marges aurait pu être formulée différemment, par exemple en utilisant des corrections additives au lieu de corrections multiplicatives ou une combinaison d’additivité et de multiplicativité. Chacune de ces procédures manque toutefois de fondements théoriques et, en toute généralité, peuvent conduire à des équilibres multiples que l’algorithme de résolution va sélectionner sans que l’on puisse justifier quoi que ce soit.</p>
<p>Le succès du modèle gravitaire découle en partie de cette “plasticité” opérationnelle qui permet de l’appliquer à des observations en respectant certaines contraintes observées tout en laissant croire qu’un fondement théorique continue de justifier les opérations. Aussi l’approche gravitaire est-elle largement reprise dans des modèles appliquées (notamment les modèles Land Use Transport Interaction) en dépit de ses défauts, peut-être faute de mieux. Mais le décalage avec les données rend urgent de dépasser cette approche qui survit en se transformant en boîte noire.</p>
</section>
</section>
<section id="sec-rad" class="level2 page-columns page-full" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="sec-rad"><span class="header-section-number">1.2</span> Une première alternative : le modèle radiatif</h2>
<div class="page-columns page-full"><p>Le modèle radiatif est l’une des rares alternatives au modèle gravitaire <span class="citation" data-cites="de2011modelling">(<a href="#ref-de2011modelling" role="doc-biblioref">Dios Ortúzar et Willumsen 2011</a>)</span>. Il reprend les intuitions de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> avec son modèle des “<em>intervening opportunities</em>”, dont la logique est la suivante : un migrant prévoit d’aller dans un endroit distant mais trouve en chemin des opportunités ; il s’interrompt alors en chemin. Cette distraction de son objectif initial est le résultat des opportunités rencontrées en chemins, “intervenantes”. La différence avec le modèle gravitaire est que ce n’est pas la distance qui détermine la destination, mais le nombre de rencontres. La distance et la structure géographique continuent de peser indirectement sur le choix des destinations puisque plus le migrant parcourt une grande distance, plus il a de chances de rencontrer des opportunités. La modélisation initiale de Stouffer souffre toutefois de quelques défauts<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> et ne résout pas les questions de capacité ou de respect des contraintes sur les marges. Mais elle ouvre une autre perspective, où le rôle de la distance est médiatisé par le nombre d’opportunités rencontré, ce qui répond avec élégance aux insuffisances de l’analogie gravitaire.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;Notamment des défauts dans la formalisation qui repose sur une série d’approximation pas toujours explicitées et qui rend le modèle peu manipulable.</p></li></div></div>
<p>Avec Stouffer, c’est ainsi une autre métrique qui est proposée en lieu et place de la simple distance spatiale. Elle est liée à la notion d’accessibilité, c’est-à-dire au nombre d’emplois (et plus généralement d’opportunités) auxquels à accès un individu pour un temps de trajet ou une distance maximaux fixés. Un emploi apparaît ainsi d’autant plus “éloigné” d’un individu qu’il y a d’emplois plus proches de lui. Le modèle gravitaire posait que les individus font une grande différence entre le cas où le deuxième emploi disponible est à 500 m et celui où cet emploi est à 1 km. Dans la nouvelle perspective, il n’y a pas de différence car il s’agit toujours du second emploi rencontré. Autrement dit, la distance est relativisée par la prise en compte du milieu qui est traversé. Plus le milieu est riche en opportunités, moins il est nécessaire d’aller loin et, inversement, plus le milieu est désert, plus il faut se résoudre à aller plus loin.</p>
<p>La proposition de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> répond à certaines failles de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> en proposant un modèle déduit par analogie avec la physique qui explicite le processus sous-jacent. L’appellation découle du modèle radiatif qui décrit l’émission de particules et leur absorption par le milieu qu’elle traverse. L’intuition est la même que celle de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> : tant qu’une particule ne rencontre pas d’obstacle, elle poursuit son chemin. Elle ne s’arrête qu’en rencontrant un site qui peut l’absorber. Plus le milieu est dense en obstacles, plus la particule a des chances de s’arrêter. Dans ce modèle, la distribution des distances parcourues dépend du milieu et de la quantité de sites d’absorption rencontrés.</p>
<p>Plus précisément, dans le modèle de radiation, chaque particule – ou individu – est tirée aléatoirement d’une distribution de probabilité avec une caractéristique <span class="math inline">z</span>. Chaque point d’absorption, qui représente un lieu possible de travail, possède une masse d’emploi <span class="math inline">n_i</span> et se voit attribuer une caractéristique <span class="math inline">z_i</span> qui est aléatoire. Les lieux possibles sont classés par ordre de distance, comme dans le modèle de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> et la particule les rencontre dans cet ordre. Le tirage de <span class="math inline">z_i</span> est construit en tirant <span class="math inline">n_i</span> fois des <span class="math inline">z</span> dans la distribution de probabilité et en prenant le maximum de ces <span class="math inline">z</span>. Plus la masse est grande en <span class="math inline">i</span>, plus le <span class="math inline">z_{max}</span> sera grand. La particule émise est absorbée si son <span class="math inline">z</span> est plus petit que <span class="math inline">z_i</span>. Pour représenter que la particule sera émise si elle n’est pas absorbée par son point de départ, son propre <span class="math inline">z</span> est tiré par la même méthode, c’est-à-dire le maximum de <span class="math inline">m_i</span> tirages où <span class="math inline">m_i</span> est la masse d’opportunités en <span class="math inline">i</span>.</p>
<p>Le résultat principal de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> est particulièrement élégant. La valeur moyenne (notée <span class="math inline">\langle T_{i,j}\rangle</span> ) des trajets partant de <span class="math inline">i</span> et allant en <span class="math inline">j</span> a une expression qui ne dépend pas de la distribution de probabilité des <span class="math inline">z</span>. Elle prend l’expression suivante, où <span class="math inline">s_{i,j}=\Sigma_{k \in (i \rightarrow j)^*} n_k</span> est la somme des opportunités entre <span class="math inline">i</span> (non inclus) et <span class="math inline">j</span> (non inclus) :</p>
<p><span id="eq-rad"><span class="math display">
\langle T_{i,j}\rangle = T_i \times \frac {m_i \times n_j}{(m_i + s_{i,j}) \times (m_i + n_i +s_{i,j})}
\tag{1.5}</span></span></p>
<p>A partir d’hypothèses générales assez simples, on obtient une formulation qui s’apparente au modèle gravitaire en remplaçant la distance par l’accumulation des opportunités entre deux points, dès lors que les opportunités sont classées dans l’ordre des distances. Cette formulation respecte autant que le modèle gravitaire le premier principe de Tobler, mais elle repose sur des hypothèses explicites et permet de mieux représenter les phénomènes déjà évoqués. Un départ dans une zone peu dense produira des trajets plus longs pour trouver un nombre équivalent d’opportunités à des trajets plus courts dans une zone dense. De plus, aucune étape de “normalisation” ad hoc n’est requise et le modèle est probabiliste, ce qui permet de produire des marges d’erreurs et des tests empiriques.</p>
<p>Les applications du modèle radiatif à des données diverses (mouvements pendulaires travail-domicile, appels téléphoniques, migrations, logistique) produisent des distributions de trajets plus proches des données que le modèle gravitaire, mettant à mal l’adage selon lequel le modèle gravitaire serait un “bon” modèle, validé par les données.</p>
<p>On notera que le modèle de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> admet comme cas limite, sous certaines hypothèses de densité des emplois, le modèle gravitaire. En effet, lorsque la densité d’emplois est uniforme dans le plan, alors l’accumulation des opportunités est proportionnelle à la surface et la moyenne de trajets entre <span class="math inline">i</span> et <span class="math inline">j</span> est une fonction en <span class="math inline">1/r^4</span>. Ce cas limite montre sous quelle condition (très particulière) le modèle gravitaire peut être valide. Ce cas limite montre également que la forme fonctionnelle employée dans le modèle gravitaire dépend fortement de la distribution de la densité des opportunités. Et c’est bien là un des éléments qui manque au modèle gravitaire.</p>
<p>Il subsiste deux défauts au modèle radiatif de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>. Le premier est le pendant de son élégance : il n’y a pas de paramètres pour l’ajuster, ce qui limite les capacités du modèle à rendre compte de la richesses des données. La forme calculée de la moyenne des trajets n’est possible que lorsque le processus sous-jacent suit l’hypothèse des auteurs. Un processus différent ne permet d’en déduire une forme fermée.</p>
<p>Pourtant, si l’on veut un modèle de base simple et clair sur le plan conceptuel, on veut aussi pouvoir enrichir le modèle avec des paramètres qui auraient du sens. Or la seule proposition qu’ils font dans ce sens, en introduisant un <span class="math inline">\varepsilon</span> pour modifier le poids du point de départ dans le choix des trajets n’y répond que très partiellement.</p>
<p>Le second défaut est que le modèle ne traite pas le respect des contraintes aux marges, en particulier en colonne. Dans l’<a href="#eq-rad">équation&nbsp;<span class="quarto-unresolved-ref">eq-rad</span></a> le terme <span class="math inline">T_i</span> représente le nombre de départs de <span class="math inline">i</span>. Il joue le rôle des coefficients <span class="math inline">a_i</span> dans le modèle gravitaire sous une forme multiplicative simple. Son interprétation est directe et simple. En revanche, il n’existe pas de pendant aux coefficients <span class="math inline">b_j</span> et il n’est donc pas possible au modèle de tenir compte d’une contrainte capacitaire : un nombre de particules supérieur au nombre d’emplois peuvent être absorbées en <span class="math inline">j</span>.</p>
</section>
<section id="sec-meaps" class="level2 page-columns page-full" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="sec-meaps"><span class="header-section-number">1.3</span> Un modèle ergodique d’absorption avec priorité et saturation (MEAPS)</h2>
<p>Nous proposons maintenant une version étendue et remaniée de l’approche de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> qui répond aux critiques que nous faisons au modèle de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>. Dans cette section, nous présentons le modèle dans sa forme plus simple avant d’en exposer les extensions les plus directes. Des simulations synthétiques permettent alors d’apprécier les grandes lignes du fonctionnement de ce modèle. Nous discutons ensuite des procédures d’estimation envisageables ainsi que du développement de mesures issues de ce modèle.</p>
<section id="rang-choix-des-destinations-et-absorption" class="level3 page-columns page-full" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="rang-choix-des-destinations-et-absorption"><span class="header-section-number">1.3.1</span> Rang, choix des destinations et absorption</h3>
<div class="page-columns page-full"><p>On considère <span class="math inline">I</span> individus et <span class="math inline">J</span> emplois<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> localisés sur un territoire. Ces localisations sont fixes et exogènes, ce qui signifie que l’on ne s’intéresse pas au problème de choix de localisation. Non que ce choix ne soit pas important, mais nous nous intéressons à la distribution des trajets, une fois fixées les localisations. L’idée est que pour déterminer le choix de localisation, il faudra prendre en compte ce que la distribution des trajets, leur longueur ou le coût généralisé qui leur est associé, nous apprend.</p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;Dans ce qui suit on regarde la relation entre résident et emploi ce qui suggère les mobilités domicile travail. C’est principalement pour fixer les idées, mais la relation entre résident et tout type d’aménités peut être abordée de la même façon. Il est également possible de décliner les résident selon des caractéristiques observables et d’indexer le modèle par ces catégories.</p></li></div></div>
<p>On suppose que toutes les localisations sont séparées et qu’il n’y a donc qu’un individu ou qu’un emploi par localisation (les emplois et les individus peuvent être au même endroit, ça ne change rien). Chaque individu <span class="math inline">i</span> classe par ordre de distance croissante les <span class="math inline">J</span> emplois et les examine dans cet ordre. Il a à chaque fois une probabilité <span class="math inline">p_a</span> de prendre l’emploi. Tant qu’il n’est pas pris, il continue sa recherche en passant à l’emploi suivant le plus proche (de son point de départ). La probabilité d’occuper l’emploi <span class="math inline">j</span> est donc égale à la probabilité de ne pas occuper les emplois plus proches multipliée par la probabilité <span class="math inline">p_a</span> d’occuper le poste <span class="math inline">j</span>. En notant <span class="math inline">r_{i}(j)</span> le rang de l’emploi <span class="math inline">j</span> dans le classement des distances depuis <span class="math inline">i</span>, on peut écrire <span class="math inline">\bar F(j)</span> la probabilité de dépasser le <span class="math inline">jème</span> élément :</p>
<p><span id="eq-fbar"><span class="math display">
\bar F(j)=(1-p_a)^{r_i(j)}
\tag{1.6}</span></span></p>
<p>On définit également la probabilité de fuite de la zone considérée. Cette probabilité est celle qu’un individu ne trouve pas parmi les <span class="math inline">J</span> emplois celui qui lui convient et donc qu’il renonce ou cherche plus loin. En supposant pour le moment que cette probabilité est la même pour tous les individus, <span class="math inline">p_f</span>, on peut déterminer <span class="math inline">p_a</span> :</p>
<p><span id="eq-pa"><span class="math display">
p_a = 1-(p_f)^{1/J}
\tag{1.7}</span></span></p>
<p>La probabilité <span class="math inline">P_i(j)</span> de <span class="math inline">i</span> de s’arrêter en <span class="math inline">j</span> est :</p>
<p><span id="eq-pij"><span class="math display">
P_i(j) = (1-p_a)^{r_i(j)-1} \times p_a = {p_f}^{\frac {r_i(j)-1} {J}} \times (1-{p_f}^{1/J})
\tag{1.8}</span></span></p>
<p>Cette expression définit donc la probabilité pour un individu <span class="math inline">i</span> d’occuper l’emploi <span class="math inline">j</span> comme une fonction de la probabilité de fuite, le rang de l’emploi et le nombre total d’emploi. La rang de <span class="math inline">j</span> n’est autre que le nombre d’opportunités cumulées du point de départ de <span class="math inline">i</span> jusqu’à <span class="math inline">j</span> et remplace la distance, comme dans les expressions de <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> ou de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>. Ce nombre n’est autre que l’accessibilité aux emplois de l’individu <span class="math inline">i</span> dans un cercle de rayon <span class="math inline">[ij]</span>, que ce rayon soit défini en utilisant une distance euclidienne ou d’autres mesures comme le temps de parcours en transport en commun en utilisant un réseau de transport.</p>
<p>Chaque emploi a été supposé distinct spatialement des autres. Dans le cas où les emplois ne seraient pas séparés et pourraient s’accumuler en un point ou au sein d’un carreau, la formalisation ne change pas.</p>
<p>La probabilité que l’on s’arrête dans le carreau <span class="math inline">c_d</span> situé à une distance <span class="math inline">d</span> de <span class="math inline">i</span> où se trouvent <span class="math inline">k</span> emplois se déduit de l’<a href="#eq-fbar">équation&nbsp;<span class="quarto-unresolved-ref">eq-fbar</span></a> puisque les <span class="math inline">k</span> emplois ont des rangs successifs. En notant <span class="math inline">s_i(d)=\sum _{j/d_{i,j}&lt;d}1</span> le cumul de tous les emplois qui sont à une distance strictement inférieure à celle du carreau considéré pour <span class="math inline">i</span> (et donc à l’exclusion des <span class="math inline">k</span> emplois du le carreau <span class="math inline">c_d</span>), on a :</p>
<p><span id="eq-picd"><span class="math display">
P_i(i\in c_d) = {p_f}^{s_i(d)/J}\times(1-{p_f}^{ k/J})
\tag{1.9}</span></span></p>
<p>En prenant un développement limité au 1<sup>er</sup> ordre de cette expression (sous l’hypothèse que <span class="math inline">k</span> est petit devant le nombre total d’opportunités <span class="math inline">J</span>) , on obtient, en notant <span class="math inline">\mu=\frac{-log(p_f)}{J}</span> :</p>
<p><span id="eq-picddl"><span class="math display">
P_i(i\in c_d) \approx k\times \mu \times e^{-\mu \times s_i(d)}
\tag{1.10}</span></span></p>
<p>Cette expression fait apparaître clairement le cœur du modèle. La proportion d’emplois venant de <span class="math inline">i</span> dans le carreau est une fonction des emplois dans le carreau multiplié par l’accessibilité jusqu’à ce carreau de <span class="math inline">i</span>.</p>
<div class="page-columns page-full"><p>Lorsque la densité des emplois est constante sur un plan, <span class="math inline">s_i(d)</span> est proportionnel à la surface et le modèle devient une fonction de la distance avec un terme en <span class="math inline">e^{-r^2/\rho^2}</span>. Ici aussi, le comportement de notre modèle rejoint, sous cette condition très particulière d’une répartition homogène des opportunités, celui proposé pour un modèle gravitaire, lorsque celui-ci est spécifié avec une fonction de distance en <span class="math inline">e^{-r/\rho}</span>. La forme favorite du modèle gravitaire se justifierait pour une répartition homogène des opportunités le long d’une droite<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Ce résultat diffère de celui de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>, qui trouvaient un comportement asymptotique en <span class="math inline">1/r^4</span>.</p><div class="no-row-height column-margin column-container"><li id="fn3"><p><sup>3</sup>&nbsp;La littérature sur le commerce international fait un grand usage du modèle gravitaire et on y trouve des développements très riches. Le problème du commerce international est un peu différent de celui de l’analyse des distribution de déplacement parce qu’on observe les flux bilatéraux par produit de façon répétée entre les pays. On dispose ainsi d’une grande quantité d’informations à relier entre elles par la représentation gravitaire. La question du transport est différente en ce que la distance entre origines et destination est bien connue, mais que les trajets bilatéraux ne le sont pas. On dispose en revanche d’information sur la distribution des trajets en fonction de leur distance, de leur motif et des modes employés.</p></li></div></div>
<p>Tout comme dans le modèle de <span class="citation" data-cites="simini2012">Simini et al. (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>, le résultat est sans paramètre, parce que la probabilité de fuite est entièrement déterminée par la contrainte en ligne (l’individu <span class="math inline">i</span> a une espérance égale à 1 - <span class="math inline">p_f</span> de trouver un emploi dans la zone considérée).</p>
</section>
<section id="sec-priorite" class="level3 page-columns page-full" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="sec-priorite"><span class="header-section-number">1.3.2</span> Saturation et priorité</h3>
<div class="page-columns page-full"><p>Il reste encore à prendre en compte la contrainte en colonne, c’est-à-dire le fait que chaque emploi peut être pourvu une fois et une seule. Au lieu d’un ajustement ad hoc qui tombe de nulle part, nous proposons le mécanisme suivant de remplissage des emplois : chaque individu <span class="math inline">i</span> est classé selon un ordre de priorité. L’individu au premier rang est confronté à l’ensemble des emplois et nous calculons ses probabilités de prendre un emploi <span class="math inline">j</span> par la formule précédente (<a href="#eq-pij">équation&nbsp;<span class="quarto-unresolved-ref">eq-pij</span></a>). Les emplois sont alors partiellement remplis à proportion de ces probabilités<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. Le deuxième individu est traité de la même manière, et ainsi de suite, jusqu’à ce qu’un ou plusieurs emplois soient totalement pourvu (lorsque la somme des probabilités dépasse tout juste 1). On retire alors ces emplois de la liste des choix possibles et on continue l’affectation pour les individus suivants sur la liste réduite. A chaque individu ajouté, on peut être amené à retirer d’autres emplois de la liste de recherche.</p><div class="no-row-height column-margin column-container"><li id="fn4"><p><sup>4</sup>&nbsp;En toute rigueur, les probabilités ne s’additionnent pas si simplement et un traitement exact exigerait de tenir compte de probabilités conditionnelles au fait que tel emploi a été pris, ou non, auparavant. La procédure décrite ici est une simplification, en subsituant aux probabilités conditionnelles des espérances.</p></li></div></div>
<p>A la fin de ce processus, tous les individus ont des emplois (à <span class="math inline">p_f</span> près) et tous les emplois sont pourvus dès lors que l’on pose <span class="math inline">I \times p_f = J</span>. Cette attribution avec priorité est Pareto-optimale. Il n’est pas possible d’augmenter la satisfaction d’un individu sans dégrader celle d’un autre. A chaque étape, chaque individu réalise ses choix sans contrainte autre que l’éventuelle saturation provoquée par ses prédécesseurs. Pour augmenter sa satisfaction, c’est-à-dire lui permettre d’occuper en probabilité un emploi mieux classé pour lui, il faudrait dégrader la situation d’un prédécesseur en lui attribuant un emploi plus éloigné pour lui. Cette procédure d’affection avantage les premiers du classement, mais tient compte des choix de chacun.</p>
<p>Formellement, on note <span class="math inline">\phi_u(i,j)</span> la probabilité de disponibilité (<span class="math inline">\phi</span> vaut 0 si l’emploi est complètement pris) de l’emploi <span class="math inline">j</span> pour un ordre de priorité donné <span class="math inline">u</span> au moment où l’individu <span class="math inline">i</span> doit choisir. La probabilité de cet individu <span class="math inline">i</span> de prendre l’emploi <span class="math inline">j</span> s’écrit alors :</p>
<p><span id="eq-puij"><span class="math display">
P_{u, i}(j) = \lambda_{u,i}.\phi_u(i,j). p_a \prod_{l=1}^{r_i^{-1}(j)-1}(1-\lambda_{u,i}. \phi_u(i,r^{-1}(l)).p_a)
\tag{1.11}</span></span></p>
<p>Cette expression est rendue complexe par la nécessité de parcourir les emplois dans l’ordre qui correspond à chaque individu. La probabilité <span class="math inline">p_a</span> doit alors être calculée pour que le taux de fuite de <span class="math inline">i</span> soit inchangé. On suppose que les emplois restants demeurent homogènes tout au long du processus d’affectation. La probabilité de chacun est donc identique et ajustée d’un facteur multiplicatif <span class="math inline">\lambda_{u,i}</span>. Le terme <span class="math inline">\lambda_{u,i}</span> découle ainsi de l’indisponibilité potentielle des emplois. Lorsqu’un emploi est indisponible, l’individu <span class="math inline">i</span>, lorsque c’est son tour de choisir, connait ses cibles potentielles. Il ajuste donc sa probabilité d’absorption de façon à respecter la probabilité de fuite. Nous choisissons cette option afin de continuer à respecter la contrainte en ligne, qui s’exprime par l’<a href="#eq-lambda">équation&nbsp;<span class="quarto-unresolved-ref">eq-lambda</span></a> ci-dessous. Ceci signifie qu’un individu a d’autant plus de chances d’accepter un emploi qu’il reste peu de choix.</p>
<div class="page-columns page-full"><p>Une autre solution serait de considérer que la probabilité de fuite n’est pas conservée et que les indisponibilités se traduisent par une fuite plus élevée. On peut tout à fait envisager des solutions plus complexes. Nous nous en tenons pour l’instant au cas simple où tous les individus ont la même chance de travailler dans la zone considérée<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. Sous cette hypothèse de conservation de la probabilité de fuite, on a :</p><div class="no-row-height column-margin column-container"><li id="fn5"><p><sup>5</sup>&nbsp;En pratique, pour éviter les effets de bord, il faut choisir une zone d’emplois plus grande que la zone des résidents.</p></li></div></div>
<p><span id="eq-lambda"><span class="math display">
\prod_{j=i} ^{J} (1-\lambda_{u,i} \times \phi_u(i,j) \times p_{a})= p_f
\tag{1.12}</span></span></p>
<p>La solution de cette équation est celle d’un polynôme en <span class="math inline">\lambda_{u,i}</span> d’un ordre élevé. Il y a possiblement plusieurs solutions, mais il est nécessaire que <span class="math inline">0&lt;\lambda_{u,i}\times p_a&lt;1</span>, ce qui réduit le nombre de solutions admissibles. On peut en produire une solution approchée par un développement limité à l’ordre 1 en prenant le <span class="math inline">log</span> de l’<a href="#eq-lambda">équation&nbsp;<span class="quarto-unresolved-ref">eq-lambda</span></a> :</p>
<p><span id="eq-lambdadl"><span class="math display">
p_{a} \times \lambda_{u,i} = \frac {-log(p_f)}{\sum_{j=1} ^{J} \phi_u(i,j)}
\tag{1.13}</span></span></p>
<p>On peut vérifier que <span class="math inline">0&lt;\lambda_{u,i}\times p_a&lt;1</span> lorsque <span class="math inline">J</span> est assez grand et que le nombre d’emplois restant demeure élevé (en probabilité) par rapport à <span class="math inline">-log(p_f)</span>.</p>
</section>
<section id="sec-erg" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="sec-erg"><span class="header-section-number">1.3.3</span> Ergodicité</h3>
<p>Chaque ordre de priorité <span class="math inline">u</span> définit une trajectoire possible d’affectation des emplois aux résidents (ou l’inverse). On aboutit à chaque fois à un état possible de l’appariement résidents-emplois d’où l’on déduit les trajets professionnels. Bien entendu, le résultat final dépend de l’ordre de priorité choisi. Pour s’en affranchir, la stratégie usuelle en physique statistique consiste à réitérer la procédure pour tous les ordres possibles de priorité et à considérer la moyenne des résultats obtenus sur les <span class="math inline">I!</span> ordres de priorité possibles.</p>
<p>L’hypothèse ergodique consiste ici à soutenir que cette moyenne sur tous ces ordres de priorité est proche du régime permanent des trajets professionnels sur la zone considérée.</p>
<p>La première grandeur que nous moyennons sur les ordres <span class="math inline">u</span> est la variable de disponibilités <span class="math inline">\phi_u(i,j)</span> de l’emploi <span class="math inline">j</span> pour le résident <span class="math inline">i</span>. Cette moyenne <span class="math inline">\langle\phi\rangle_u(n,j)</span> correspond à la probabilité de disponibilité de l’emploi <span class="math inline">j</span> pour n’importe quel résident après que <span class="math inline">n</span> résidents occupent d’ores et déjà un emploi ou ont fuit la zone. Cette grandeur ne dépend pas de <span class="math inline">i</span>, mais uniquement du nombre de résidents déjà positionnés.</p>
<p>Un deuxième grandeur nous sera utile. Il s’agit de l’accessibilité moyenne aux emplois disponibles. On peut noter <span class="math inline">A_u(i,k)</span> le cumul des emplois qui restent disponibles pour <span class="math inline">i</span> lorsque <span class="math inline">n</span> résidents se sont d’ores et déjà positionnés, en comptant les emplois depuis le plus proche de <span class="math inline">i</span> jusqu’au <span class="math inline">k^{ième}</span> le plus proche. La grandeur qui nous intéresse est la moyenne sur tous les <span class="math inline">n</span> possibles, soit :</p>
<p><span id="eq-an"><span class="math display">
\langle A \rangle_n(i,k) = \langle\sum_{l=1}^k \langle \phi \rangle_u(n, r_i(k)) \rangle _n
\tag{1.14}</span></span></p>
<p>La particularité de cette accessibilité est qu’à mesure que les emplois sont pris (lorsque <span class="math inline">n</span> s’accroît), l’accessibilité se restreint puisqu’elle ne retient que la part encore disponible des emplois proches.</p>
<p>Comme précédemment, nous considérons que la probabilité de fuite d’un individu est une constante. Dans ce cas, la probabilité d’absorption va augmenter au fur et à mesure que les emplois sont pris : moins il reste d’emplois disponibles, plus un résident est prêt à accepter ceux qui restent. La probabilité <span class="math inline">P_a</span> va donc dépendre de <span class="math inline">n</span> et s’écrire ici <span class="math inline">P_{a,n}</span>.</p>
<p>Pour un <span class="math inline">n</span> donné, on a :</p>
<p><span id="eq-pf2"><span class="math display">
P_f=\prod_{k=1}^J(1-P_{a,n}\times \langle \phi \rangle_u(n, r_i(k))
\tag{1.15}</span></span></p>
<p>En passant en <span class="math inline">log</span> et en effectuant un développement limité, on obtient :</p>
<p><span id="eq-logpf"><span class="math display">
log(P_f)=-P_{a,n}\times\sum_{k=1}^J \langle \phi \rangle_u(n,r_i(k))=-P_{a,n}\times(J-(1-P_f)\times n)
\tag{1.16}</span></span></p>
<p>Nous avons alors tous les éléments pour calculer la probabilité <span class="math inline">P_n(i,j)</span> que le résident <span class="math inline">i</span> prenne l’emploi <span class="math inline">j</span> après que <span class="math inline">n</span> résidents se sont déjà positionnés (cf. <a href="#eq-pij">équation&nbsp;<span class="quarto-unresolved-ref">eq-pij</span></a>). En passant alors en <span class="math inline">log</span>, on a :</p>
<p><span id="eq-logpij"><span class="math display">
log(P_{ij})=log(P_{a,n})+log(\langle\phi \rangle_u(n,j))+\sum_{k=1}^{r_i^{-1}(j)}log(1-P_{a,n}\times \langle \phi \rangle_u(n,r_i(k))
\tag{1.17}</span></span></p>
<p>En faisant un développement limité du dernier terme puis la moyenne sur les <span class="math inline">n</span>, il en découle :</p>
<p><span id="eq-logpijapprox"><span class="math display">
log(P_{ij})\approx\langle log(P_{a,n})\rangle _n+\langle\langle\phi\rangle_u(n,j)\rangle_n + \langle A\rangle_n(i, r_i^{-1}(j))
\tag{1.18}</span></span></p>
<p>La probabilité <span class="math inline">P_{ij}</span> s’écrit donc à partir de la probabilité moyenne d’absorption, de l’espérance que l’emploi <span class="math inline">j</span> est disponible et de l’accessibilité moyenne. Sur le plan conceptuel, c’est tout à fait satisfaisant et compréhensible.</p>
</section>
<section id="sec-hetero" class="level3 page-columns page-full" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="sec-hetero"><span class="header-section-number">1.3.4</span> Hétérogénéité de la fuite et de l’absorption</h3>
<p>Nous avons considéré jusqu’à présent le cas où les individus et les emplois étaient homogènes et indiscernables. Cela simplifie le modèle et permet une résolution explicite. Il est cependant possible de complexifier le modèle en levant ces hypothèses en introduisant des paramètres interprétables qui permettent une meilleure prédiction et l’extraction d’informations des données.</p>
<p>Tout d’abord, le paramètre de fuite peut être spécifique à chaque individu. Par exemple, le recensement nous permet de mesurer la proportion d’individu, par commune, qui ont un emploi à plus de 100km de leur domicile. Cette proportion est faible (<span class="math inline">&lt;5\%</span> pour une région comme celle étudiée dans l’application à la Rochelle <a href="#sec-rochelle"><span class="quarto-unresolved-ref">sec-rochelle</span></a>) mais peut varier d’une commune à l’autre. Ces variations peuvent s’expliquer par une géographie particulière ou par des caractéristiques des individus. On peut alors définir une probabilité de fuite <span class="math inline">p_{f,i}</span> pour chaque individu.</p>
<p>Ensuite, le paramètre d’absorption était jusqu’à maintenant identique pour tous les emplois et tous les individus. On peut le rendre dépendant des emplois, <span class="math inline">p_{a,j}</span>, pour marquer un effet fixe spécifique à des emplois. Le recensement nous donne quelques informations sur les trajets professionnels de commune à commune et, donc, sur l’attractivité différentielle entre communes. D’autres données pourraient nous informer à un niveau infra-communal. On pourrait aussi vouloir faire dépendre la probabilité d’absorption de caractéristiques observables des emplois. Des emplois dans une zone dense en emploi peuvent, au-delà de l’effet masse déjà pris en compte, être plus attractifs que des emplois isolés. Dans ce cas, l’absorption dépend de caractéristiques <span class="math inline">X</span> observées et en spécifiant la forme fonctionnelle de <span class="math inline">p_a(X)</span> on peut l’estimer de façon à mieux reproduire l’information sur la distribution des déplacements.</p>
<div class="page-columns page-full"><p>Le modèle présenté est suffisamment flexible pour pouvoir rendre compte de phénomènes plus complexes afin de, à la fois, pouvoir exploiter des données riches et modéliser des comportements (de fuite, d’absorption) qui semblent avoir un sens. Si au lieu d’apparier les individus et les emplois, on s’intéresse au cas du choix des écoles, on peut imaginer que l’absorption de l’école la plus proche est élevée, mais que celles de rang supérieur s’effondrent. Si l’individu est indifférent aux caractéristiques des écoles, hors leur emplacement, il prend l’école la plus proche. Le refus de cette première école peut s’expliquer par une exigence parentale non observable, mais qui se traduit par une distance parcourue plus élevée. Mais le modèle de base rendant compte d’une baisse de l’absorption au-delà du premier rang est déjà assez bon<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn6"><p><sup>6</sup>&nbsp;De façon plus générale, on peut spécifier une loi de la probabilité d’absorption quelconque qui doit vérifier que <span class="math inline">\sum_{k=1,J} p_{i,r_i(k)} = p_{f,i}</span> pour tout <span class="math inline">i</span>. Toute paramétrisation de cette loi de probabilité peut alors être simulée et ajustée sur des données. Si les paramètres ont une interprétation théorique, on peut alors les identifier.</p></li></div></div>
<p>On peut ainsi modifier les probabilités d’absorption en donnant à un groupe particulier de paires individus emplois plus ou moins de chances d’être absorbé. En jouant sur les groupes qui partionnent les paires individus <span class="math inline">\times</span> emplois on peut augmenter ou réduire le nombre de degré de liberté du système. Lorsque seule la probabilité d’absorption est un paramètre, le nombre de degré de liberté est diminué de 1 et le paramètre <span class="math inline">p</span> est déterminé par la condition d’égalité entre le nombre d’emplois pourvus et d’individus. Si on dispose d’une information sur la probabilité de fuite par individu ou par groupe d’individus, le nombre de degré de liberté peut être accru par une probabilité de fuite différenciée selon ces groupes. On peut encore accroître le nombre de degré de liberté en croisant une probabilité d’absorption par groupes d’emplois et groupes d’individus. Le choix de la spécification dépendra de ce que l’on souhaite réaliser et du problème considéré. On verra dans la <a href="#sec-rochelle"><span class="quarto-unresolved-ref">sec-rochelle</span></a> une application en recourant à un grand nombre de degré de liberté afin d’ajuster le modèle sur des données détaillées (donnant pour des paires commune de résidence <span class="math inline">\times</span> commune d’emploi une observation des flux de mobilité professionnels) et de pouvoir procéder à des intrapolations, en projetant les flux à une échelle infra communale tout en respectant les observations, et de pouvoir simuler des scénarios alternatifs en considérant que les <span class="math inline">\lambda_{i,j}</span> sont constants. Dans une publication ultérieure, nous montrerons une détermination parcimonieuse des coefficients correcteurs afin de pouvoir extraire une information pertinente des données de flux entre communes et de pouvoir comparer le pouvoir prédictif de MEAPS à celui d’un modèle gravitaire, à degré de liberté égal.</p>
<p>En indexant par <span class="math inline">i</span> les probabilités de fuite <span class="math inline">p_{f,i}</span> et par <span class="math inline">i,j</span> les coefficients correcteurs <span class="math inline">\lambda_{i,j}</span>, les équations principales du modèle deviennent :</p>
<p><span id="eq-comp1"><span class="math display">
P_{i, u}(j) = \lambda_{i,j} . p_{a} \prod _{l=1} ^{r_{u(i)}(j)-1} {[1-\lambda_{i,r_{u(i)}(l)}. p_{a}.\phi_u(i,r_{u(i)}^{-1}(l))]}
\tag{1.19}</span></span></p>
<p><span id="eq-lambdacomp"><span class="math display">
\prod _{l=1} ^{J} {[1-\lambda_{i,r_{u(i)}(l)}.p_{a}.\phi_u(i,r_{u(i)}^{-1}(l))]}= p_{f,i}
\tag{1.20}</span></span></p>
<div class="page-columns page-full"><p>Il n’est pas possible de donner une forme réduite de cette dernière expression. En revanche, elle est calculable numériquement pour chaque <span class="math inline">u</span>, <span class="math inline">i</span> et <span class="math inline">j</span> en fonction des hypothèses du modèle (<span class="math inline">p_{f,i}</span>, <span class="math inline">p_{a,j}</span>, la structure spatiale des résidents et des emplois) et sert de base à l’algorithme de calcul employé dans les simulations présentées dans la section <a href="#sec-synt"><span class="quarto-unresolved-ref">sec-synt</span></a><a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn7"><p><sup>7</sup>&nbsp;L’implémentation de cette expression est faite dans le fichier <code>meaps.cpp</code> accessible sur le dépôt <code>github.com/xtimbeau/meaps</code></p></li></div></div>
<p>Le modèle ainsi construit est flexible puisqu’on peut spécifier des processus de fuite (contrainte en ligne équivalente à la contrainte <a href="#eq-ai"><span class="quarto-unresolved-ref ref-noprefix">eq-ai</span></a>) et des processus d’absorption qui respecte la contrainte de saturation des emplois (contrainte en ligne équivalente à la contrainte <a href="#eq-bj"><span class="quarto-unresolved-ref ref-noprefix">eq-bj</span></a>) par le processus de priorité décrit en <a href="#sec-priorite"><span class="quarto-unresolved-ref">sec-priorite</span></a>. Le parcours de toutes les permutations possibles permet de s’affranchir d’un ordre de priorité particulier et de définir une solution moyenne au processus. Lorsqu’on analyse le problème avec une grille de taille finie (ou de taille inférieure au nombre <span class="math inline">J</span> d’opportunités), on peut conjecturer un comportement ergodique des quantités moyennes prédites par le modèle. On résout de cette façon explicitement le problème de contrainte aux marges du modèle gravitaire ou du modèle radiatif.</p>
</section>
<section id="synthèse-de-meaps" class="level3" data-number="1.3.5">
<h3 data-number="1.3.5" class="anchored" data-anchor-id="synthèse-de-meaps"><span class="header-section-number">1.3.5</span> Synthèse de MEAPS</h3>
<p>Avant de passer aux simulations, résumons le propos : nous proposons une formulation du problème de distribution des transports qui permet de traiter du respect de la contrainte aux marges avec un processus élémentaire explicite. Cela accroît la validité du modèle et sa possible utilisation dans des applications. Cela permet également d’utiliser l’information donnée par les contraintes de marge et d’en déduire une série d’indicateurs caractérisant la zone étudiée et les tensions entre l’offre et la demande.</p>
<p>La formulation la plus simple du modèle, correspondant à l’hypothèse d’homogénéité des emplois, d’un processus d’absorption homogène (la probabilité d’être absorbée est la même pour tous les individus ou les emplois) et d’une valeur identique de fuite par individu permet de construire une calibration canonique, qui ne dépend que des paramètres de “masse” et de “distance”. On peut alors proposer une version plus riche du modèle, en individualisant la probabilité de fuite, en pondérant les probabilités d’absorption ou encore en proposant un processus d’absorption non binaire et paramétrique. Ces versions peuvent alors être confrontées aux données disponibles, en contrôlant du risque de sur ajustement et en disposant pour chacun des paramètres d’une une référence canonique.</p>
<p>Comme il est d’usage de le discuter en économie, cette approche est structurelle et donne aux paramètres un statut exogène. L’identification sur les données, conditionnellement à ce modèle, peut alors recevoir une interprétation causale.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-ben-akiva2018" class="csl-entry" role="doc-biblioentry">
Ben-Akiva, Moshe, et Steven R. Lerman. 2018. <em>Discrete Choice Analysis: Theory and Application to Travel Demand</em>. Transportation Series. MIT Press.
</div>
<div id="ref-de2011modelling" class="csl-entry" role="doc-biblioentry">
Dios Ortúzar, Juan de, et Luis G Willumsen. 2011. <em>Modelling transport</em>. John wiley &amp; sons.
</div>
<div id="ref-heanue1966" class="csl-entry" role="doc-biblioentry">
Heanue, Kevin E., et Clyde E. Pyers. 1966. <span>«&nbsp;A Comparative Evaluation of Trip Distribution Procedures&nbsp;»</span>. <em>Highway Reserach Record</em>, nᵒ 114: 20‑50.
</div>
<div id="ref-handbook2007" class="csl-entry" role="doc-biblioentry">
Hensher, David A., et Kenneth J. Button, éd. 2007. <span>«&nbsp;Handbook of Transport Modelling&nbsp;»</span>. <em>Handbooks in Transport</em>, septembre. <a href="https://doi.org/10.1108/9780857245670">https://doi.org/10.1108/9780857245670</a>.
</div>
<div id="ref-patrickbonnel2001" class="csl-entry" role="doc-biblioentry">
Patrick Bonnel. 2001. <span>«&nbsp;Prévision de la demande de transport&nbsp;»</span>. Thèse de doctorat, Lyon, France.
</div>
<div id="ref-simini2012" class="csl-entry" role="doc-biblioentry">
Simini, Filippo, Marta C. González, Amos Maritan, et Albert-László Barabási. 2012. <span>«&nbsp;A Universal Model for Mobility and Migration Patterns&nbsp;»</span>. <em>Nature</em> 484 (7392): 96‑100. <a href="https://doi.org/10.1038/nature10856">https://doi.org/10.1038/nature10856</a>.
</div>
<div id="ref-stouffer1940" class="csl-entry" role="doc-biblioentry">
Stouffer, Samuel A. 1940. <span>«&nbsp;Intervening Opportunities: A Theory Relating Mobility and Distance&nbsp;»</span>. <em>American Sociological Review</em> 5 (6): 845. <a href="https://doi.org/10.2307/2084520">https://doi.org/10.2307/2084520</a>.
</div>
<div id="ref-wilson1967" class="csl-entry" role="doc-biblioentry">
Wilson, A. G. 1967. <span>«&nbsp;A Statistical Theory of Spatial Distribution Models&nbsp;»</span>. <em>Transportation Research</em> 1 (3): 253‑69. <a href="https://doi.org/10.1016/0041-1647(67)90035-4">https://doi.org/10.1016/0041-1647(67)90035-4</a>.
</div>
</div>
</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduction générale</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./simsynth.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">MEAPS : Simulations synthétiques</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Code source</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Aspects théoriques de MEAPS"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction {.unnumbered}</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Nous nous intéressons à la mobilité de la vie quotidienne et aux facteurs qui la déterminent. Pour cela nous voulons à la fois connaître le nombre de trajets qu'un individu effectue chaque jour, mais aussi quelles sont les destinations probables de ces trajets, les modes de transport et les temps passés à les effectuer. Cette connaissance suppose une modélisation qui produit un certain nombre de prédictions que l'on peut confronter à l'information dont on dispose. En particulier, on ne dispose pas, à ce jour, d'une information complète des trajets effectués pour chaque individu, même sur un échantillon réduit, vers chacune des destinations possibles, pour chacun des motifs envisageables. On mesure donc soit des distributions de trajets dans la population, par motif et par mode, issues d'enquêtes de mobilité, soit des nombre de trajets reliant telle commune de résidence à telle commune d'activité. L'information, quoique riche, ne couvre pas toute la complexité du phénomène considéré et la modélisation, par des hypothèses sur les comportements, permet de quantifier le lien entre quelques paramètres fondamentaux et les observations.</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>Intuitivement, l'analyse des trajets doit permettre de relier différentes dimensions de la géographie, de l'endroit où les gens habitent, à celui où ils s'affairent, en intégrant le réseau de transport qui leur permet de se déplacer, plus ou moins rapidement, plus ou moins en sécurité, pour un coût plus ou moins élevé.</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>Puisque l'espace est partagé entre les individus, on s'attend à ce que la congestion ou la compétition pour des emplois, des lieux de résidences ou d'autres ressources rares, jouent des rôles à un moment ou un autre.</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>La modélisation doit permettre, autant que possible, d'intégrer ces couches disparates dans un objet que l'on peut confronter aux données dont on dispose.</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>Sur la base de cette modélisation, on doit pouvoir ensuite analyser des changements, que ce soit dans les comportements individuels, dans les masses d'emplois disponibles ou le nombre d'habitants, leur répartition spatiale, ou encore dans la structure du réseau de transport afin de construire des scénarios représentant ce qui pourrait se passer si on changeait quelque chose.</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>La confrontation aux données est alors une étape importante, puisqu'on veut en tirer un diagnostic sur la modélisation et apprécier le potentiel prédictif.</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>Pour modéliser les trajets entre des lieux de résidence et des lieux d'emploi, on procède usuellement par la méthode à 4 étapes <span class="co">[</span><span class="ot">@patrickbonnel2001; @de2011modelling</span><span class="co">]</span>.</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>Cette méthode consiste dans un premier temps à déterminer le nombre de trajets en partance d'un lieu de résidence ainsi que ceux arrivant au total dans un lieu d'activité.</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>C'est l'étape 1 de génération des trajets.</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>La seconde étape consiste à distribuer les trajets de l'étape 1 entre chaque paire de départ et de destination.</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>C'est l'étape de distribution.</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>La troisième étape est celle du choix modal, où pour chaque trajet (entre chaque origine et chaque destination) considéré se voit affecté un mode de transport.</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>Enfin la quatrième étape du modèle à 4 étapes est celle qui spécifie le trajet et permet d'en connaître les caractéristiques précises, comme la distance parcourue, les axes employées ou les dénivelés effectués.</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>Cette décomposition est un peu arbitraire et ne rend pas compte avec justice de l'état de l'art.</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>Le nombre de trajets effectué dépend en effet des possibilités ouvertes par la géographie qui sont définies par les caractéristiques précises des trajets.</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>L'étape 4 est donc nécessaire pour comprendre l'étape 1, et l'étape 4 demande de connaître les choix modaux pour être utile aux choix fait en 1.</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>L'étape 2 est nécessaire pour explorer les possibilités de trajets.</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>Les imbrications sont nombreuses entre les étapes et la décomposition n'interdit pas d'effectuer des allers et retours entre les diverses étapes.</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>Nous développons ici un modèle qui permet de distribuer les trajets qui ont été assignés en première étape.</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>Le modèle gravitaire est largement employé dans cette deuxième étape pour prendre en compte le rôle de la distance.</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>Plus un emploi est loin, moins il doit être attractif.</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>Un individu doit donc préférer les emplois près de lui à ceux qui sont éloignés.</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>Ce modèle gravitaire est loin d'être convainquant et nous discutons dans une première partie de ses insuffisances (@sec-grav).</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>Le modèle des opportunités intervenantes de @stouffer1940 et le modèle radiatif de @simini2012 qui font intervenir le rang de classement des emplois plutôt que la distance (@sec-rad) et reposent sur une analogie plus adéquate aux échelles géographiques que nous considérons (commune, région) que celle de la gravitation.</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>Nous présentons une version étendue du modèle radiatif qui produit deux résultats principaux :</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>au lieu de la distance, c'est le nombre d'emplois accessibles dans un cercle de rayon donné qui détermine le choix individuel.</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>nous explicitons la saturation et nous donnons un fondement microscopique au respect des contraintes aux marges (tout individu a un emploi, tout emploi est occupé par un individu) (@sec-meaps).</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>La formulation est probabiliste et nous en analysons quelques propriétés par des simulations synthétiques (@sec-synt), en montrant qu'on peut arriver rapidement à simuler un état indépendant des conditions initiales.</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>Nous proposons ensuite une application à l'agglomération de la Rochelle (@sec-rochelle), dans la quelle nous détaillons le processus de construction des données, proposons une procédure d'ajustement et exploitons le modèle ajusté pour des analyses de scénarios.</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="fu">## Les insuffisances du modèle gravitaire {#sec-grav}</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>Le modèle gravitaire est employé très fréquemment en économie spatiale <span class="co">[</span><span class="ot">@handbook2007, chapitre 2</span><span class="co">]</span>.</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>Il semble en effet répondre de façon satisfaisante au premier principe de Tobler :</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Tout est relié mais les choses proches sont plus reliées que les choses éloignées.</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>Le modèle gravitaire développe une analogie avec le modèle de la gravitation universelle d'Isaac Newton dont les succès en physique et en mécanique sont immenses.</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>Ce modèle est généralement la pierre angulaire de l'étape de distribution des trajets dans la décomposition à 4 étapes des modèles de transport <span class="co">[</span><span class="ot">@de2011modelling; @patrickbonnel2001 p.160</span><span class="co">]</span>.</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>Il est également utilisé dans d'autres domaines, comme le commerce international ou l'analyse des épidémies, domaines que nous ne discuterons pas ici.</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="fu">### Les (mauvaises) raisons du succès du modèle gravitaire</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>Formellement, le modèle gravitaire décrit la force d'une relation entre deux objets en fonction de leur distance et de leur masse respective.</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>Par analogie, le modèle gravitaire consiste ici à évaluer le nombre de trajets professionnels entre deux localisations en prenant pour masses le nombre d'habitants au point de départ et le nombre d'emplois au point d'arrivée et, pour distance, une fonction $f$ croissante de la distance.</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>On a ainsi, en indiçant les points de départ par $i$ et les points d'arrivée par $j$ :</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>T_{i,j} = \frac {N_{hab, i}\times N_{emp, j}} {f(d_{i,j})}</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gravity}</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>Les premiers modèles gravitaires ont emprunté la fonction $f$ à la physique newtonienne ($f=1/d^2$), mais d'autres formulations ont depuis été proposées.</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>Par exemple, la fonction $f=e^{-d/\delta}$ intervient dans les modèles de choix discrets proposés par McFadden <span class="co">[</span><span class="ot">@ben-akiva2018</span><span class="co">]</span>.</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>En remplaçant la distance par la notion de coût généralisé du transport, on peut relier cette forme fonctionnelle à un modèle de choix avec une fonction d'utilité aléatoire (*random utility model*).</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>Il est également possible d'ajuster des formes fonctionnelles plus complexes en ajoutant des paramètres.</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>Le modèle gravitaire arrive alors à reproduire plus ou moins des distributions de distances observées dans des enquêtes de mobilité.</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>Un raisonnement par minimisation de l'entropie a été proposé par @wilson1967 pour donner un fondement théorique à l'@eq-gravity.</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>Le raisonnement est de considérer l'état de référence comme étant celui qui est le plus fréquent dans une distribution aléatoire des choix.</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>@wilson1967 montre alors que, si la fonction $f$ est donnée, l'@eq-gravity a bien la forme proposée et que c'est le produit des habitants et des emplois qui doit se trouver au numérateur (et non une puissance de l'un ou l'autre par exemple).</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>Mais rien ne permet de trouver un fondement à la forme fonctionnelle de $f$.</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>Le parallèle avec la physique est simple à faire : l'interaction définit le rôle de la distance, la maximisation de l'entropie permet d'en déduire que l'équation macroscopique dépend des masses agrégées, mais ne permet de dire quoique ce soit de plus sur la nature de l'interaction.</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>Comme le notent @simini2012, les fondations théoriques et empiriques de la fonction $f$ sont au mieux faibles.</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>La multiplication des paramètres pour améliorer l'ajustement n'ont le plus souvent aucune justification théorique.</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>De fait, on perd souvent toute possibilité de donner une signification aux paramètres estimé ce qui rend l'exercice d'ajustement opaque.</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>Les comportements asymptotiques soulignent également des incohérences : par exemple, en faisant tendre vers l'infini les emplois à l'arrivée, le modèle prédit un nombre infini de trajets, même si le nombre de résidents au départ est limité !</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>Il est également insatisfaisant que le modèle gravitaire soit déterministe et ne permette ni d'expliquer les fluctuations statistiques du nombre de trajets prédits, ni d'évaluer la vraisemblance de différents cas empirique.</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>Mais la critique la plus forte du modèle gravitaire vient de ses propriétés fondamentales et des conclusions que l'on peut en tirer.</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>Le nombre de trajets entre une origine (la résidence) et une destination (l'emploi) repose sur un simple arbitrage entre distance et quantité de résidents ou d'emplois.</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>Le comportement du modèle aux limites, à nouveau, suscite la perplexité : un seul emploi à l'origine devrait être infiniment préféré un très grand nombre d'emplois un peu plus loin.</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>C'est tout à fait irréaliste et l'on devine déjà que la distance ne joue pas un rôle si direct dans les comportements de mobilité.</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>On voit également que le poids relatif de cet emploi quasi central par rapport aux "masses" d'emplois éloignés va varier de manière irréaliste selon qu'il est plus ou moins proche de l'origine.</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>Comme le soulignait déjà @stouffer1940, ce n'est peut-être pas tant la distance aux emplois qui est décisive que le rang de ces emplois selon l'ordre des distances.</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>Dans le modèle gravitaire, il faut faire une grande différence entre le cas où le deuxième emploi le plus proche est à 500 m et le cas où il est à 1 km.</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>Si l'on applique le modèle newtonien, il faudrait croire, par exemple, que l'attractivité de ce dernier emploi est divisée par 4.</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>Qui peut croire que 500 m de différence pèsent d'un si grand poids dans une recherche d'emploi ?</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>L'attractivité de l'emploi dépend avant tout du fait qu'il s'agit du deuxième emploi disponible près de chez soi.</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>Empiriquement, il y a peu de doutes que le modèle gravitaire a de piètres performances : il ne parvient pas à expliquer pourquoi, lorsque la densité des emplois est faible autour d'un résident, celui-ci va envisager des trajets plus long pour atteindre des zones denses en emplois ; c'est pourtant une observation très commune qui devrait se retrouver dans une modélisation adéquate.</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>Assez peu de publications se risquent à une comparaison systématique du modèle gravitaire avec d'autres formulations qui respecteraient la première loi de Tobler.</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>On peut citer @heanue1966 comme une des rares tentatives de ce genre.</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>Le modèle gravitaire semblait moins bon que le modèle des opportunités intervenantes (voir plus loin) s'il n'était pas ajusté de manière *ad hoc*, comme il est devenu usuel.</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>@simini2012 donnent quelques exemples pour les Etats-Unis de la difficulté du modèle gravitaire à reproduire les comportements observés en en stylisant quelques régularités.</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>A l'évidence, le modèle gravitaire ne prédit que des destinations proches et néglige complètement les destinations lointaines.</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>Il semble impossible à la forme fonctionnelle $f(d_{ij})$ de rendre compte empiriquement à la fois du nombre de trajets courts et du nombre de trajets distants au travers d'un modèle susceptible de rendre compte des trajets dans différentes régions, dès lors que les densités y sont distribuées différemment.</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="fu">### Le voile de la contrainte aux marges</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>Le modèle gravitaire peut être complexifié pour mieux coller aux données qu'il ne le fait spontanément.</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>Il perd alors un lien clair avec les réflexions théoriques le reliant à la maximisation de l'entropie <span class="co">[</span><span class="ot">@wilson1967</span><span class="co">]</span> ou au modèle de choix discret.</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>L'ajustement du modèle devient un exercice factice dans lequel il est difficile d'avoir confiance en particulier dans l'analyse des scénarios modélisés.</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>L'exercice consiste à ajouter une étape de "normalisation" au modèle en incorporant dans le modèle des coefficients correctifs en ligne et en colonne dans la matrice origine-destination, ce qui revient à ajouter des effets fixes à chacun des points de départ et d'arrivée.</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>La formulation du modèle gravitaire est alors modifiée comme suit :</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>T_{i,j} = a_i \times b_j \times \frac {N_{hab, i}\times N_{emp, j}} {f(d_{i,j})}</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gravmod}</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>La détermination des coefficients $a_i$ et $b_j$ pose de nombreux problèmes.</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>Ces coefficients doivent permettre de respecter les contraintes aux marges : la somme des emplois pour une ligne de résidents doit être égale au nombre des résidents employés dans la zone et la somme des résidents employés sur un lieu d'emploi doit, en colonne donc, être égale au nombre d'emplois en ce lieu) sur les déplacements.</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>On a pour $a_i$ :</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>a_i &amp;{}= \frac {\Sigma_j T_{i,j}} {\Sigma_j \frac {b_j \times N_{hab, i} \times N_{emp, j}}{f(d_{i,j})}} <span class="sc">\\</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>&amp;{}= \frac{1}{\Sigma_j \frac{ b_j \times N_{emp,j}}{f(d_{i,j})}}</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>$$ {#eq-ai}</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>$\Sigma_j T_{i,j}$ est généralement directement observé ou estimé lors de l'étape de génération dans les approches dites à 4 étapes.</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>C'est le nombre de départs depuis le point $i$ et il est proportionnel aux nombre d'actifs résidant en $i$.</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>De la même façon on peut écrire pour $b_j$ une expression symétrique de celle de $a_i$, qui fait intervenir $\Sigma_i T_{i,j}$ qui est également observée ou estimé auparavant.</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>C'est le nombre de trajets convergeant vers le point d'arrivée $j$, qui est proportionnel au nombre d'emplois en $j$.</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>b_j &amp;{}= \frac {\Sigma_i T_{i,j}} {\Sigma_i \frac {a_i \times N_{hab, i} \times N_{emp, j}}{f(d_{i,j})}} <span class="sc">\\</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>&amp;{}= \frac{1}{\Sigma_i \frac{a_i \times N_{hab,i}}{f(d_{i,j})}}</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>$$ {#eq-bj}</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>La valeur de $a_i$, pour un $i$ donné, dépend de l'évaluation de tous les $b_j$ et réciproquement l'évaluation de chaque $b_j$ dépend de celle de tous les $a_i$.</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>On peut estimer ces coefficients par itérations successives et espérer atteindre de cette manière un point fixe, éventuellement unique à une constante multiplicative près.</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>Des algorithmes de résolution ont donc été proposés dans les principaux manuels.</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>L'application de tels algorithmes (comme celui de Furness, @de2011modelling, p. 192) peut toutefois modifier considérablement le résultat initial proposé par le modèle gravitaire, au risque d'en trahir la logique et les justifications initiales.</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>En outre, la multiplicité des solutions et le choix retenu par l'algorithme demeure un angle mort de ces méthodes.</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>Mais surtout, cette procédure itérative se contente de multiplier par des facteurs arbitraires des lignes et des colonnes de la matrice origine-destination.</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>Ceci ne change donc pas les poids relatifs des nombres de déplacements depuis une origine ou vers une destination.</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>Or, si l'on pense que le modèle gravitaire estime mal ces poids relatifs, comme nous l'avons affirmé ci-dessus, alors cette normalisation ne change rien sur le fond : une destination éloignée est si fortement pénalisée dans le modèle gravitaire qu'aucun facteur multiplicatif ne peut faire remonter le nombre de trajets vers cette destination, sans faire crever le plafond au nombre de trajets plus proches.</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>La procédure de respect des marges aurait pu être formulée différemment, par exemple en utilisant des corrections additives au lieu de corrections multiplicatives ou une combinaison d'additivité et de multiplicativité.</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>Chacune de ces procédures manque toutefois de fondements théoriques et, en toute généralité, peuvent conduire à des équilibres multiples que l'algorithme de résolution va sélectionner sans que l'on puisse justifier quoi que ce soit.</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>Le succès du modèle gravitaire découle en partie de cette "plasticité" opérationnelle qui permet de l'appliquer à des observations en respectant certaines contraintes observées tout en laissant croire qu'un fondement théorique continue de justifier les opérations.</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>Aussi l'approche gravitaire est-elle largement reprise dans des modèles appliquées (notamment les modèles Land Use Transport Interaction) en dépit de ses défauts, peut-être faute de mieux.</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>Mais le décalage avec les données rend urgent de dépasser cette approche qui survit en se transformant en boîte noire.</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a><span class="fu">## Une première alternative : le modèle radiatif {#sec-rad}</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>Le modèle radiatif est l'une des rares alternatives au modèle gravitaire <span class="co">[</span><span class="ot">@de2011modelling</span><span class="co">]</span>.</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>Il reprend les intuitions de @stouffer1940 avec son modèle des "*intervening opportunities*", dont la logique est la suivante : un migrant prévoit d'aller dans un endroit distant mais trouve en chemin des opportunités ; il s'interrompt alors en chemin.</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>Cette distraction de son objectif initial est le résultat des opportunités rencontrées en chemins, "intervenantes".</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>La différence avec le modèle gravitaire est que ce n'est pas la distance qui détermine la destination, mais le nombre de rencontres.</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>La distance et la structure géographique continuent de peser indirectement sur le choix des destinations puisque plus le migrant parcourt une grande distance, plus il a de chances de rencontrer des opportunités.</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>La modélisation initiale de Stouffer souffre toutefois de quelques défauts<span class="ot">[^1]</span> et ne résout pas les questions de capacité ou de respect des contraintes sur les marges.</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>Mais elle ouvre une autre perspective, où le rôle de la distance est médiatisé par le nombre d'opportunités rencontré, ce qui répond avec élégance aux insuffisances de l'analogie gravitaire.</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>Notamment des défauts dans la formalisation qui repose sur une série d'approximation pas toujours explicitées et qui rend le modèle peu manipulable.</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>Avec Stouffer, c'est ainsi une autre métrique qui est proposée en lieu et place de la simple distance spatiale.</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>Elle est liée à la notion d'accessibilité, c'est-à-dire au nombre d'emplois (et plus généralement d'opportunités) auxquels à accès un individu pour un temps de trajet ou une distance maximaux fixés.</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>Un emploi apparaît ainsi d'autant plus "éloigné" d'un individu qu'il y a d'emplois plus proches de lui.</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>Le modèle gravitaire posait que les individus font une grande différence entre le cas où le deuxième emploi disponible est à 500 m et celui où cet emploi est à 1 km.</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>Dans la nouvelle perspective, il n'y a pas de différence car il s'agit toujours du second emploi rencontré.</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>Autrement dit, la distance est relativisée par la prise en compte du milieu qui est traversé.</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>Plus le milieu est riche en opportunités, moins il est nécessaire d'aller loin et, inversement, plus le milieu est désert, plus il faut se résoudre à aller plus loin.</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>La proposition de @simini2012 répond à certaines failles de @stouffer1940 en proposant un modèle déduit par analogie avec la physique qui explicite le processus sous-jacent.</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>L'appellation découle du modèle radiatif qui décrit l'émission de particules et leur absorption par le milieu qu'elle traverse.</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>L'intuition est la même que celle de @stouffer1940 : tant qu'une particule ne rencontre pas d'obstacle, elle poursuit son chemin.</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>Elle ne s'arrête qu'en rencontrant un site qui peut l'absorber.</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>Plus le milieu est dense en obstacles, plus la particule a des chances de s'arrêter.</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>Dans ce modèle, la distribution des distances parcourues dépend du milieu et de la quantité de sites d'absorption rencontrés.</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>Plus précisément, dans le modèle de radiation, chaque particule -- ou individu -- est tirée aléatoirement d'une distribution de probabilité avec une caractéristique $z$.</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>Chaque point d'absorption, qui représente un lieu possible de travail, possède une masse d'emploi $n_i$ et se voit attribuer une caractéristique $z_i$ qui est aléatoire.</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>Les lieux possibles sont classés par ordre de distance, comme dans le modèle de @stouffer1940 et la particule les rencontre dans cet ordre.</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>Le tirage de $z_i$ est construit en tirant $n_i$ fois des $z$ dans la distribution de probabilité et en prenant le maximum de ces $z$.</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>Plus la masse est grande en $i$, plus le $z_{max}$ sera grand.</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>La particule émise est absorbée si son $z$ est plus petit que $z_i$.</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>Pour représenter que la particule sera émise si elle n'est pas absorbée par son point de départ, son propre $z$ est tiré par la même méthode, c'est-à-dire le maximum de $m_i$ tirages où $m_i$ est la masse d'opportunités en $i$.</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>Le résultat principal de @simini2012 est particulièrement élégant.</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>La valeur moyenne (notée $\langle T_{i,j}\rangle$ ) des trajets partant de $i$ et allant en $j$ a une expression qui ne dépend pas de la distribution de probabilité des $z$.</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>Elle prend l'expression suivante, où $s_{i,j}=\Sigma_{k \in (i \rightarrow j)^*} n_k$ est la somme des opportunités entre $i$ (non inclus) et $j$ (non inclus) :</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>\langle T_{i,j}\rangle = T_i \times \frac {m_i \times n_j}{(m_i + s_{i,j}) \times (m_i + n_i +s_{i,j})}</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>$$ {#eq-rad}</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>A partir d'hypothèses générales assez simples, on obtient une formulation qui s'apparente au modèle gravitaire en remplaçant la distance par l'accumulation des opportunités entre deux points, dès lors que les opportunités sont classées dans l'ordre des distances.</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>Cette formulation respecte autant que le modèle gravitaire le premier principe de Tobler, mais elle repose sur des hypothèses explicites et permet de mieux représenter les phénomènes déjà évoqués.</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>Un départ dans une zone peu dense produira des trajets plus longs pour trouver un nombre équivalent d'opportunités à des trajets plus courts dans une zone dense.</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>De plus, aucune étape de "normalisation" ad hoc n'est requise et le modèle est probabiliste, ce qui permet de produire des marges d'erreurs et des tests empiriques.</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>Les applications du modèle radiatif à des données diverses (mouvements pendulaires travail-domicile, appels téléphoniques, migrations, logistique) produisent des distributions de trajets plus proches des données que le modèle gravitaire, mettant à mal l'adage selon lequel le modèle gravitaire serait un "bon" modèle, validé par les données.</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>On notera que le modèle de @simini2012 admet comme cas limite, sous certaines hypothèses de densité des emplois, le modèle gravitaire.</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>En effet, lorsque la densité d'emplois est uniforme dans le plan, alors l'accumulation des opportunités est proportionnelle à la surface et la moyenne de trajets entre $i$ et $j$ est une fonction en $1/r^4$.</span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>Ce cas limite montre sous quelle condition (très particulière) le modèle gravitaire peut être valide.</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>Ce cas limite montre également que la forme fonctionnelle employée dans le modèle gravitaire dépend fortement de la distribution de la densité des opportunités.</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>Et c'est bien là un des éléments qui manque au modèle gravitaire.</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>Il subsiste deux défauts au modèle radiatif de @simini2012.</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>Le premier est le pendant de son élégance : il n'y a pas de paramètres pour l'ajuster, ce qui limite les capacités du modèle à rendre compte de la richesses des données.</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>La forme calculée de la moyenne des trajets n'est possible que lorsque le processus sous-jacent suit l'hypothèse des auteurs.</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>Un processus différent ne permet d'en déduire une forme fermée.</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>Pourtant, si l'on veut un modèle de base simple et clair sur le plan conceptuel, on veut aussi pouvoir enrichir le modèle avec des paramètres qui auraient du sens. Or la seule proposition qu'ils font dans ce sens, en introduisant un $\varepsilon$ pour modifier le poids du point de départ dans le choix des trajets n'y répond que très partiellement.</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>Le second défaut est que le modèle ne traite pas le respect des contraintes aux marges, en particulier en colonne.</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>Dans l'@eq-rad le terme $T_i$ représente le nombre de départs de $i$.</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>Il joue le rôle des coefficients $a_i$ dans le modèle gravitaire sous une forme multiplicative simple.</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>Son interprétation est directe et simple.</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>En revanche, il n'existe pas de pendant aux coefficients $b_j$ et il n'est donc pas possible au modèle de tenir compte d'une contrainte capacitaire : un nombre de particules supérieur au nombre d'emplois peuvent être absorbées en $j$.</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a><span class="fu">## Un modèle ergodique d'absorption avec priorité et saturation (MEAPS) {#sec-meaps}</span></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>Nous proposons maintenant une version étendue et remaniée de l'approche de @stouffer1940 qui répond aux critiques que nous faisons au modèle de @simini2012.</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>Dans cette section, nous présentons le modèle dans sa forme plus simple avant d'en exposer les extensions les plus directes.</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>Des simulations synthétiques permettent alors d'apprécier les grandes lignes du fonctionnement de ce modèle.</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>Nous discutons ensuite des procédures d'estimation envisageables ainsi que du développement de mesures issues de ce modèle.</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a><span class="fu">### Rang, choix des destinations et absorption</span></span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>On considère $I$ individus et $J$ emplois<span class="ot">[^2]</span> localisés sur un territoire.</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>Ces localisations sont fixes et exogènes, ce qui signifie que l'on ne s'intéresse pas au problème de choix de localisation.</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>Non que ce choix ne soit pas important, mais nous nous intéressons à la distribution des trajets, une fois fixées les localisations.</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>L'idée est que pour déterminer le choix de localisation, il faudra prendre en compte ce que la distribution des trajets, leur longueur ou le coût généralisé qui leur est associé, nous apprend.</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>Dans ce qui suit on regarde la relation entre résident et emploi ce qui suggère les mobilités domicile travail.</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>    C'est principalement pour fixer les idées, mais la relation entre résident et tout type d'aménités peut être abordée de la même façon.</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>    Il est également possible de décliner les résident selon des caractéristiques observables et d'indexer le modèle par ces catégories.</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>On suppose que toutes les localisations sont séparées et qu'il n'y a donc qu'un individu ou qu'un emploi par localisation (les emplois et les individus peuvent être au même endroit, ça ne change rien).</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>Chaque individu $i$ classe par ordre de distance croissante les $J$ emplois et les examine dans cet ordre.</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>Il a à chaque fois une probabilité $p_a$ de prendre l'emploi.</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>Tant qu'il n'est pas pris, il continue sa recherche en passant à l'emploi suivant le plus proche (de son point de départ).</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>La probabilité d'occuper l'emploi $j$ est donc égale à la probabilité de ne pas occuper les emplois plus proches multipliée par la probabilité $p_a$ d'occuper le poste $j$.</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>En notant $r_{i}(j)$ le rang de l'emploi $j$ dans le classement des distances depuis $i$, on peut écrire $\bar F(j)$ la probabilité de dépasser le $jème$ élément :</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>\bar F(j)=(1-p_a)^{r_i(j)}</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>$$ {#eq-fbar}</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>On définit également la probabilité de fuite de la zone considérée.</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>Cette probabilité est celle qu'un individu ne trouve pas parmi les $J$ emplois celui qui lui convient et donc qu'il renonce ou cherche plus loin.</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>En supposant pour le moment que cette probabilité est la même pour tous les individus, $p_f$, on peut déterminer $p_a$ :</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>p_a = 1-(p_f)^{1/J}</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>$$ {#eq-pa}</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>La probabilité $P_i(j)$ de $i$ de s'arrêter en $j$ est :</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>P_i(j) = (1-p_a)^{r_i(j)-1} \times p_a = {p_f}^{\frac {r_i(j)-1} {J}} \times (1-{p_f}^{1/J})</span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>$$ {#eq-pij}</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>Cette expression définit donc la probabilité pour un individu $i$ d'occuper l'emploi $j$ comme une fonction de la probabilité de fuite, le rang de l'emploi et le nombre total d'emploi.</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>La rang de $j$ n'est autre que le nombre d'opportunités cumulées du point de départ de $i$ jusqu'à $j$ et remplace la distance, comme dans les expressions de @stouffer1940 ou de @simini2012.</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>Ce nombre n'est autre que l'accessibilité aux emplois de l'individu $i$ dans un cercle de rayon $<span class="co">[</span><span class="ot">ij</span><span class="co">]</span>$, que ce rayon soit défini en utilisant une distance euclidienne ou d'autres mesures comme le temps de parcours en transport en commun en utilisant un réseau de transport.</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>Chaque emploi a été supposé distinct spatialement des autres.</span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>Dans le cas où les emplois ne seraient pas séparés et pourraient s'accumuler en un point ou au sein d'un carreau, la formalisation ne change pas.</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>La probabilité que l'on s'arrête dans le carreau $c_d$ situé à une distance $d$ de $i$ où se trouvent $k$ emplois se déduit de l'@eq-fbar puisque les $k$ emplois ont des rangs successifs.</span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>En notant $s_i(d)=\sum _{j/d_{i,j}&lt;d}1$ le cumul de tous les emplois qui sont à une distance strictement inférieure à celle du carreau considéré pour $i$ (et donc à l'exclusion des $k$ emplois du le carreau $c_d$), on a :</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>P_i(i\in c_d) = {p_f}^{s_i(d)/J}\times(1-{p_f}^{ k/J})</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>$$ {#eq-picd}</span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>En prenant un développement limité au 1^er^ ordre de cette expression (sous l'hypothèse que $k$ est petit devant le nombre total d'opportunités $J$) , on obtient, en notant $\mu=\frac{-log(p_f)}{J}$ :</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>P_i(i\in c_d) \approx k\times \mu \times e^{-\mu \times s_i(d)}</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>$$ {#eq-picddl}</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>Cette expression fait apparaître clairement le cœur du modèle.</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>La proportion d'emplois venant de $i$ dans le carreau est une fonction des emplois dans le carreau multiplié par l'accessibilité jusqu'à ce carreau de $i$.</span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>Lorsque la densité des emplois est constante sur un plan, $s_i(d)$ est proportionnel à la surface et le modèle devient une fonction de la distance avec un terme en $e^{-r^2/\rho^2}$.</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>Ici aussi, le comportement de notre modèle rejoint, sous cette condition très particulière d'une répartition homogène des opportunités, celui proposé pour un modèle gravitaire, lorsque celui-ci est spécifié avec une fonction de distance en $e^{-r/\rho}$.</span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>La forme favorite du modèle gravitaire se justifierait pour une répartition homogène des opportunités le long d'une droite<span class="ot">[^3]</span>.</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>Ce résultat diffère de celui de @simini2012, qui trouvaient un comportement asymptotique en $1/r^4$.</span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span>La littérature sur le commerce international fait un grand usage du modèle gravitaire et on y trouve des développements très riches.</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>    Le problème du commerce international est un peu différent de celui de l'analyse des distribution de déplacement parce qu'on observe les flux bilatéraux par produit de façon répétée entre les pays.</span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>    On dispose ainsi d'une grande quantité d'informations à relier entre elles par la représentation gravitaire.</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>    La question du transport est différente en ce que la distance entre origines et destination est bien connue, mais que les trajets bilatéraux ne le sont pas.</span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>    On dispose en revanche d'information sur la distribution des trajets en fonction de leur distance, de leur motif et des modes employés.</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>Tout comme dans le modèle de @simini2012, le résultat est sans paramètre, parce que la probabilité de fuite est entièrement déterminée par la contrainte en ligne (l'individu $i$ a une espérance égale à 1 - $p_f$ de trouver un emploi dans la zone considérée).</span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a><span class="fu">### Saturation et priorité {#sec-priorite}</span></span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>Il reste encore à prendre en compte la contrainte en colonne, c'est-à-dire le fait que chaque emploi peut être pourvu une fois et une seule.</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>Au lieu d'un ajustement ad hoc qui tombe de nulle part, nous proposons le mécanisme suivant de remplissage des emplois : chaque individu $i$ est classé selon un ordre de priorité.</span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>L'individu au premier rang est confronté à l'ensemble des emplois et nous calculons ses probabilités de prendre un emploi $j$ par la formule précédente (@eq-pij).</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>Les emplois sont alors partiellement remplis à proportion de ces probabilités<span class="ot">[^4]</span>.</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>Le deuxième individu est traité de la même manière, et ainsi de suite, jusqu'à ce qu'un ou plusieurs emplois soient totalement pourvu (lorsque la somme des probabilités dépasse tout juste 1).</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>On retire alors ces emplois de la liste des choix possibles et on continue l'affectation pour les individus suivants sur la liste réduite.</span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>A chaque individu ajouté, on peut être amené à retirer d'autres emplois de la liste de recherche.</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: </span>En toute rigueur, les probabilités ne s'additionnent pas si simplement et un traitement exact exigerait de tenir compte de probabilités conditionnelles au fait que tel emploi a été pris, ou non, auparavant.</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>    La procédure décrite ici est une simplification, en subsituant aux probabilités conditionnelles des espérances.</span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a>A la fin de ce processus, tous les individus ont des emplois (à $p_f$ près) et tous les emplois sont pourvus dès lors que l'on pose $I \times p_f = J$.</span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>Cette attribution avec priorité est Pareto-optimale.</span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>Il n'est pas possible d'augmenter la satisfaction d'un individu sans dégrader celle d'un autre.</span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>A chaque étape, chaque individu réalise ses choix sans contrainte autre que l'éventuelle saturation provoquée par ses prédécesseurs.</span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>Pour augmenter sa satisfaction, c'est-à-dire lui permettre d'occuper en probabilité un emploi mieux classé pour lui, il faudrait dégrader la situation d'un prédécesseur en lui attribuant un emploi plus éloigné pour lui.</span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>Cette procédure d'affection avantage les premiers du classement, mais tient compte des choix de chacun.</span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>Formellement, on note $\phi_u(i,j)$ la probabilité de disponibilité ($\phi$ vaut 0 si l'emploi est complètement pris) de l'emploi $j$ pour un ordre de priorité donné $u$ au moment où l'individu $i$ doit choisir.</span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>La probabilité de cet individu $i$ de prendre l'emploi $j$ s'écrit alors :</span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a>P_{u, i}(j) = \lambda_{u,i}.\phi_u(i,j). p_a \prod_{l=1}^{r_i^{-1}(j)-1}(1-\lambda_{u,i}. \phi_u(i,r^{-1}(l)).p_a)</span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>$$ {#eq-puij}</span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a>Cette expression est rendue complexe par la nécessité de parcourir les emplois dans l'ordre qui correspond à chaque individu.</span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>La probabilité $p_a$ doit alors être calculée pour que le taux de fuite de $i$ soit inchangé.</span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>On suppose que les emplois restants demeurent homogènes tout au long du processus d'affectation.</span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>La probabilité de chacun est donc identique et ajustée d'un facteur multiplicatif $\lambda_{u,i}$.</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>Le terme $\lambda_{u,i}$ découle ainsi de l'indisponibilité potentielle des emplois.</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>Lorsqu'un emploi est indisponible, l'individu $i$, lorsque c'est son tour de choisir, connait ses cibles potentielles.</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>Il ajuste donc sa probabilité d'absorption de façon à respecter la probabilité de fuite.</span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>Nous choisissons cette option afin de continuer à respecter la contrainte en ligne, qui s'exprime par l'@eq-lambda ci-dessous.</span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>Ceci signifie qu'un individu a d'autant plus de chances d'accepter un emploi qu'il reste peu de choix.</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>Une autre solution serait de considérer que la probabilité de fuite n'est pas conservée et que les indisponibilités se traduisent par une fuite plus élevée.</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a>On peut tout à fait envisager des solutions plus complexes.</span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>Nous nous en tenons pour l'instant au cas simple où tous les individus ont la même chance de travailler dans la zone considérée<span class="ot">[^5]</span>.</span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>Sous cette hypothèse de conservation de la probabilité de fuite, on a :</span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a><span class="ot">[^5]: </span>En pratique, pour éviter les effets de bord, il faut choisir une zone d'emplois plus grande que la zone des résidents.</span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>\prod_{j=i} ^{J} (1-\lambda_{u,i} \times \phi_u(i,j) \times p_{a})= p_f</span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a>$$ {#eq-lambda}</span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a>La solution de cette équation est celle d'un polynôme en $\lambda_{u,i}$ d'un ordre élevé.</span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a>Il y a possiblement plusieurs solutions, mais il est nécessaire que $0&lt;\lambda_{u,i}\times p_a&lt;1$, ce qui réduit le nombre de solutions admissibles.</span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a>On peut en produire une solution approchée par un développement limité à l'ordre 1 en prenant le $log$ de l'@eq-lambda :</span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a>p_{a} \times \lambda_{u,i} = \frac {-log(p_f)}{\sum_{j=1} ^{J} \phi_u(i,j)}</span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a>$$ {#eq-lambdadl}</span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a>On peut vérifier que $0&lt;\lambda_{u,i}\times p_a&lt;1$ lorsque $J$ est assez grand et que le nombre d'emplois restant demeure élevé (en probabilité) par rapport à $-log(p_f)$.</span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ergodicité {#sec-erg}</span></span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a>Chaque ordre de priorité $u$ définit une trajectoire possible d'affectation des emplois aux résidents (ou l'inverse).</span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a>On aboutit à chaque fois à un état possible de l'appariement résidents-emplois d'où l'on déduit les trajets professionnels.</span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>Bien entendu, le résultat final dépend de l'ordre de priorité choisi.</span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>Pour s'en affranchir, la stratégie usuelle en physique statistique consiste à réitérer la procédure pour tous les ordres possibles de priorité et à considérer la moyenne des résultats obtenus sur les $I!$ ordres de priorité possibles.</span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>L'hypothèse ergodique consiste ici à soutenir que cette moyenne sur tous ces ordres de priorité est proche du régime permanent des trajets professionnels sur la zone considérée.</span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>La première grandeur que nous moyennons sur les ordres $u$ est la variable de disponibilités $\phi_u(i,j)$ de l'emploi $j$ pour le résident $i$.</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>Cette moyenne $\langle\phi\rangle_u(n,j)$ correspond à la probabilité de disponibilité de l'emploi $j$ pour n'importe quel résident après que $n$ résidents occupent d'ores et déjà un emploi ou ont fuit la zone.</span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>Cette grandeur ne dépend pas de $i$, mais uniquement du nombre de résidents déjà positionnés.</span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a>Un deuxième grandeur nous sera utile.</span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>Il s'agit de l'accessibilité moyenne aux emplois disponibles.</span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a>On peut noter $A_u(i,k)$ le cumul des emplois qui restent disponibles pour $i$ lorsque $n$ résidents se sont d'ores et déjà positionnés, en comptant les emplois depuis le plus proche de $i$ jusqu'au $k^{ième}$ le plus proche.</span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a>La grandeur qui nous intéresse est la moyenne sur tous les $n$ possibles, soit :</span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>\langle A \rangle_n(i,k) = \langle\sum_{l=1}^k \langle \phi \rangle_u(n, r_i(k)) \rangle _n</span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a>$$ {#eq-an}</span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>La particularité de cette accessibilité est qu'à mesure que les emplois sont pris (lorsque $n$ s'accroît), l'accessibilité se restreint puisqu'elle ne retient que la part encore disponible des emplois proches.</span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>Comme précédemment, nous considérons que la probabilité de fuite d'un individu est une constante.</span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a>Dans ce cas, la probabilité d'absorption va augmenter au fur et à mesure que les emplois sont pris : moins il reste d'emplois disponibles, plus un résident est prêt à accepter ceux qui restent.</span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>La probabilité $P_a$ va donc dépendre de $n$ et s'écrire ici $P_{a,n}$.</span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>Pour un $n$ donné, on a :</span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>P_f=\prod_{k=1}^J(1-P_{a,n}\times \langle \phi \rangle_u(n, r_i(k))</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>$$ {#eq-pf2}</span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>En passant en $log$ et en effectuant un développement limité, on obtient :</span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a>log(P_f)=-P_{a,n}\times\sum_{k=1}^J \langle \phi \rangle_u(n,r_i(k))=-P_{a,n}\times(J-(1-P_f)\times n)</span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a>$$ {#eq-logpf}</span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a>Nous avons alors tous les éléments pour calculer la probabilité $P_n(i,j)$ que le résident $i$ prenne l'emploi $j$ après que $n$ résidents se sont déjà positionnés (cf. @eq-pij).</span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a>En passant alors en $log$, on a :</span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>log(P_{ij})=log(P_{a,n})+log(\langle\phi \rangle_u(n,j))+\sum_{k=1}^{r_i^{-1}(j)}log(1-P_{a,n}\times \langle \phi \rangle_u(n,r_i(k))</span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>$$ {#eq-logpij}</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a>En faisant un développement limité du dernier terme puis la moyenne sur les $n$, il en découle :</span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a>log(P_{ij})\approx\langle log(P_{a,n})\rangle _n+\langle\langle\phi\rangle_u(n,j)\rangle_n + \langle A\rangle_n(i, r_i^{-1}(j))</span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a>$$ {#eq-logpijapprox}</span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>La probabilité $P_{ij}$ s'écrit donc à partir de la probabilité moyenne d'absorption, de l'espérance que l'emploi $j$ est disponible et de l'accessibilité moyenne.</span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>Sur le plan conceptuel, c'est tout à fait satisfaisant et compréhensible.</span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hétérogénéité de la fuite et de l'absorption {#sec-hetero}</span></span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>Nous avons considéré jusqu'à présent le cas où les individus et les emplois étaient homogènes et indiscernables.</span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>Cela simplifie le modèle et permet une résolution explicite.</span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a>Il est cependant possible de complexifier le modèle en levant ces hypothèses en introduisant des paramètres interprétables qui permettent une meilleure prédiction et l'extraction d'informations des données.</span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>Tout d'abord, le paramètre de fuite peut être spécifique à chaque individu.</span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>Par exemple, le recensement nous permet de mesurer la proportion d'individu, par commune, qui ont un emploi à plus de 100km de leur domicile.</span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a>Cette proportion est faible ($&lt;5\%$ pour une région comme celle étudiée dans l'application à la Rochelle @sec-rochelle) mais peut varier d'une commune à l'autre.</span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>Ces variations peuvent s'expliquer par une géographie particulière ou par des caractéristiques des individus.</span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>On peut alors définir une probabilité de fuite $p_{f,i}$ pour chaque individu.</span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a>Ensuite, le paramètre d'absorption était jusqu'à maintenant identique pour tous les emplois et tous les individus.</span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a>On peut le rendre dépendant des emplois, $p_{a,j}$, pour marquer un effet fixe spécifique à des emplois.</span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>Le recensement nous donne quelques informations sur les trajets professionnels de commune à commune et, donc, sur l'attractivité différentielle entre communes.</span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>D'autres données pourraient nous informer à un niveau infra-communal.</span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a>On pourrait aussi vouloir faire dépendre la probabilité d'absorption de caractéristiques observables des emplois.</span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a>Des emplois dans une zone dense en emploi peuvent, au-delà de l'effet masse déjà pris en compte, être plus attractifs que des emplois isolés.</span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a>Dans ce cas, l'absorption dépend de caractéristiques $X$ observées et en spécifiant la forme fonctionnelle de $p_a(X)$ on peut l'estimer de façon à mieux reproduire l'information sur la distribution des déplacements.</span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a>Le modèle présenté est suffisamment flexible pour pouvoir rendre compte de phénomènes plus complexes afin de, à la fois, pouvoir exploiter des données riches et modéliser des comportements (de fuite, d'absorption) qui semblent avoir un sens. Si au lieu d'apparier les individus et les emplois, on s'intéresse au cas du choix des écoles, on peut imaginer que l'absorption de l'école la plus proche est élevée, mais que celles de rang supérieur s'effondrent.</span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>Si l'individu est indifférent aux caractéristiques des écoles, hors leur emplacement, il prend l'école la plus proche.</span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a>Le refus de cette première école peut s'expliquer par une exigence parentale non observable, mais qui se traduit par une distance parcourue plus élevée.</span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a>Mais le modèle de base rendant compte d'une baisse de l'absorption au-delà du premier rang est déjà assez bon<span class="ot">[^6]</span>.</span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a><span class="ot">[^6]: </span>De façon plus générale, on peut spécifier une loi de la probabilité d'absorption quelconque qui doit vérifier que $\sum_{k=1,J} p_{i,r_i(k)} = p_{f,i}$ pour tout $i$.</span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a>    Toute paramétrisation de cette loi de probabilité peut alors être simulée et ajustée sur des données.</span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a>    Si les paramètres ont une interprétation théorique, on peut alors les identifier.</span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>On peut ainsi modifier les probabilités d'absorption en donnant à un groupe particulier de paires individus emplois plus ou moins de chances d'être absorbé.</span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a>En jouant sur les groupes qui partionnent les paires individus $\times$ emplois on peut augmenter ou réduire le nombre de degré de liberté du système.</span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a>Lorsque seule la probabilité d'absorption est un paramètre, le nombre de degré de liberté est diminué de 1 et le paramètre $p$ est déterminé par la condition d'égalité entre le nombre d'emplois pourvus et d'individus.</span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a>Si on dispose d'une information sur la probabilité de fuite par individu ou par groupe d'individus, le nombre de degré de liberté peut être accru par une probabilité de fuite différenciée selon ces groupes.</span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a>On peut encore accroître le nombre de degré de liberté en croisant une probabilité d'absorption par groupes d'emplois et groupes d'individus.</span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a>Le choix de la spécification dépendra de ce que l'on souhaite réaliser et du problème considéré.</span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a>On verra dans la @sec-rochelle une application en recourant à un grand nombre de degré de liberté afin d'ajuster le modèle sur des données détaillées (donnant pour des paires commune de résidence $\times$ commune d'emploi une observation des flux de mobilité professionnels) et de pouvoir procéder à des intrapolations, en projetant les flux à une échelle infra communale tout en respectant les observations, et de pouvoir simuler des scénarios alternatifs en considérant que les $\lambda_{i,j}$ sont constants.</span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a>Dans une publication ultérieure, nous montrerons une détermination parcimonieuse des coefficients correcteurs afin de pouvoir extraire une information pertinente des données de flux entre communes et de pouvoir comparer le pouvoir prédictif de MEAPS à celui d'un modèle gravitaire, à degré de liberté égal.</span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a>En indexant par $i$ les probabilités de fuite $p_{f,i}$ et par $i,j$ les coefficients correcteurs $\lambda_{i,j}$, les équations principales du modèle deviennent :</span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a>P_{i, u}(j) = \lambda_{i,j} . p_{a} \prod _{l=1} ^{r_{u(i)}(j)-1} {[1-\lambda_{i,r_{u(i)}(l)}. p_{a}.\phi_u(i,r_{u(i)}^{-1}(l))]}</span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a>$$ {#eq-comp1}</span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a>\prod _{l=1} ^{J} {[1-\lambda_{i,r_{u(i)}(l)}.p_{a}.\phi_u(i,r_{u(i)}^{-1}(l))]}= p_{f,i}</span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a>$$ {#eq-lambdacomp}</span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a>Il n'est pas possible de donner une forme réduite de cette dernière expression.</span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a>En revanche, elle est calculable numériquement pour chaque $u$, $i$ et $j$ en fonction des hypothèses du modèle ($p_{f,i}$, $p_{a,j}$, la structure spatiale des résidents et des emplois) et sert de base à l'algorithme de calcul employé dans les simulations présentées dans la section @sec-synt<span class="ot">[^7]</span>.</span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a><span class="ot">[^7]: </span>L'implémentation de cette expression est faite dans le fichier <span class="in">`meaps.cpp`</span> accessible sur le dépôt <span class="in">`github.com/xtimbeau/meaps`</span></span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-471"><a href="#cb1-471" aria-hidden="true" tabindex="-1"></a>Le modèle ainsi construit est flexible puisqu'on peut spécifier des processus de fuite (contrainte en ligne équivalente à la contrainte <span class="co">[</span><span class="ot">-@eq-ai</span><span class="co">]</span>) et des processus d'absorption qui respecte la contrainte de saturation des emplois (contrainte en ligne équivalente à la contrainte <span class="co">[</span><span class="ot">-@eq-bj</span><span class="co">]</span>) par le processus de priorité décrit en @sec-priorite.</span>
<span id="cb1-472"><a href="#cb1-472" aria-hidden="true" tabindex="-1"></a>Le parcours de toutes les permutations possibles permet de s'affranchir d'un ordre de priorité particulier et de définir une solution moyenne au processus.</span>
<span id="cb1-473"><a href="#cb1-473" aria-hidden="true" tabindex="-1"></a>Lorsqu'on analyse le problème avec une grille de taille finie (ou de taille inférieure au nombre $J$ d'opportunités), on peut conjecturer un comportement ergodique des quantités moyennes prédites par le modèle.</span>
<span id="cb1-474"><a href="#cb1-474" aria-hidden="true" tabindex="-1"></a>On résout de cette façon explicitement le problème de contrainte aux marges du modèle gravitaire ou du modèle radiatif.</span>
<span id="cb1-475"><a href="#cb1-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-476"><a href="#cb1-476" aria-hidden="true" tabindex="-1"></a><span class="fu">### Synthèse de MEAPS</span></span>
<span id="cb1-477"><a href="#cb1-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-478"><a href="#cb1-478" aria-hidden="true" tabindex="-1"></a>Avant de passer aux simulations, résumons le propos : nous proposons une formulation du problème de distribution des transports qui permet de traiter du respect de la contrainte aux marges avec un processus élémentaire explicite.</span>
<span id="cb1-479"><a href="#cb1-479" aria-hidden="true" tabindex="-1"></a>Cela accroît la validité du modèle et sa possible utilisation dans des applications.</span>
<span id="cb1-480"><a href="#cb1-480" aria-hidden="true" tabindex="-1"></a>Cela permet également d'utiliser l'information donnée par les contraintes de marge et d'en déduire une série d'indicateurs caractérisant la zone étudiée et les tensions entre l'offre et la demande.</span>
<span id="cb1-481"><a href="#cb1-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-482"><a href="#cb1-482" aria-hidden="true" tabindex="-1"></a>La formulation la plus simple du modèle, correspondant à l'hypothèse d'homogénéité des emplois, d'un processus d'absorption homogène (la probabilité d'être absorbée est la même pour tous les individus ou les emplois) et d'une valeur identique de fuite par individu permet de construire une calibration canonique, qui ne dépend que des paramètres de "masse" et de "distance".</span>
<span id="cb1-483"><a href="#cb1-483" aria-hidden="true" tabindex="-1"></a>On peut alors proposer une version plus riche du modèle, en individualisant la probabilité de fuite, en pondérant les probabilités d'absorption ou encore en proposant un processus d'absorption non binaire et paramétrique.</span>
<span id="cb1-484"><a href="#cb1-484" aria-hidden="true" tabindex="-1"></a>Ces versions peuvent alors être confrontées aux données disponibles, en contrôlant du risque de sur ajustement et en disposant pour chacun des paramètres d'une une référence canonique.</span>
<span id="cb1-485"><a href="#cb1-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-486"><a href="#cb1-486" aria-hidden="true" tabindex="-1"></a>Comme il est d'usage de le discuter en économie, cette approche est structurelle et donne aux paramètres un statut exogène.</span>
<span id="cb1-487"><a href="#cb1-487" aria-hidden="true" tabindex="-1"></a>L'identification sur les données, conditionnellement à ce modèle, peut alors recevoir une interprétation causale.</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>