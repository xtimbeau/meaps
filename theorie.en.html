<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Maxime Parodi">
<meta name="author" content="Xavier Timbeau">
<meta name="keywords" content="modèle gravitaire, modèle radiatif, mobilités">

<title>MEAPS - MEAPS: Modelling commuter flows</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/iconify-1.0.8/iconify-icon.min.js"></script>
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-KF6Z4B486X"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-KF6Z4B486X', { 'anonymize_ip': true});
</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="MEAPS - MEAPS: Modelling commuter flows">
<meta property="og:description" content="The gravity model used to distribute journeys between an origin and a destination poorly represents the influence of distance on choices. Drawing on the ‹intervening opportunities› model of Stouffer (1940) and the radiative model of Simini et al. (2012), we construct an ergodic model of absorption with priority and saturation (MEAPS) that makes it possible to construct these choices on clear and flexible microscopic foundations. The model accommodates different formulations of stochastic processes that allow fundamental parameters to be estimated and interpreted. We validate the theoretical model on synthetic data, then in two associated documents (Parodi et Timbeau, 2024b, 2024a) We propose an estimate of MEAPS and a detailed comparison with the gravity model and its most common variants. We then use this modelling to construct a high-resolution map of CO2 emissions in La Rochelle.  r  wordcountaddin::word_count('theorie.qmd') words.">
<meta property="og:image" content="https://preview.meaps.fr/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="MEAPS">
<meta name="twitter:title" content="MEAPS - MEAPS: Modelling commuter flows">
<meta name="twitter:description" content="The gravity model used to distribute journeys between an origin and a destination poorly represents the influence of distance on choices. Drawing on the ‹intervening opportunities› model of Stouffer (1940) and the radiative model of Simini et al. (2012), we construct an ergodic model of absorption with priority and saturation (MEAPS) that makes it possible to construct these choices on clear and flexible microscopic foundations. The model accommodates different formulations of stochastic processes that allow fundamental parameters to be estimated and interpreted. We validate the theoretical model on synthetic data, then in two associated documents (Parodi et Timbeau, 2024b, 2024a) We propose an estimate of MEAPS and a detailed comparison with the gravity model and its most common variants. We then use this modelling to construct a high-resolution map of CO2 emissions in La Rochelle.  r  wordcountaddin::word_count('theorie.qmd') words.">
<meta name="twitter:image" content="https://preview.meaps.fr/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="MEAPS: Modelling commuter flows">
<meta name="citation_abstract" content="The gravity model used to distribute journeys between an origin and a destination poorly represents the influence of distance on choices. Drawing on the &amp;amp;#039;intervening opportunities' model of @stouffer1940 and the radiative model of @simini2012, we construct an ergodic model of absorption with priority and saturation (MEAPS) that makes it possible to construct these choices on clear and flexible microscopic foundations. The model accommodates different formulations of stochastic processes that allow fundamental parameters to be estimated and interpreted. We validate the theoretical model on synthetic data, then in two associated documents [@meaps2024a; @meaps2024b] We propose an estimate of MEAPS and a detailed comparison with the gravity model and its most common variants. We then use this modelling to construct a high-resolution map of CO~~2~~ emissions in La Rochelle. &amp;lt;br&amp;gt; 13955 words.">
<meta name="citation_keywords" content="modèle gravitaire,modèle radiatif,mobilités">
<meta name="citation_author" content="Maxime Parodi">
<meta name="citation_author" content="Xavier Timbeau">
<meta name="citation_publication_date" content="2023-05-02">
<meta name="citation_cover_date" content="2023-05-02">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2023-05-02">
<meta name="citation_fulltext_html_url" content="https://preview.meaps.fr">
<meta name="citation_language" content="fr">
<meta name="citation_journal_title" content="Document de travail de l&amp;amp;#039;OFCE n°2023-14">
<meta name="citation_reference" content="citation_title=Estimer des flux de navetteurs avec un modèle gravitaire : application géomatique en région Provence-Alpes-Côte d’Azur (France)&amp;amp;amp;lt;sup&amp;gt;1&amp;lt;/sup&amp;gt;;,citation_author=Didier Josselin;,citation_author=Samuel Carpentier-Postel;,citation_author=Frédéric Audard;,citation_author=Safaâ Amarouch;,citation_author=Jean-Baptiste Durand;,citation_author=Nathalie Brachet;,citation_author=Mathieu Coulon;,citation_author=Louisette Garcin;,citation_publication_date=2020-09-01;,citation_cover_date=2020-09-01;,citation_year=2020;,citation_fulltext_html_url=http://dx.doi.org/10.1139/geomat-2020-0009;,citation_issue=3;,citation_doi=10.1139/geomat-2020-0009;,citation_volume=74;,citation_language=fr;,citation_journal_title=Geomatica;">
<meta name="citation_reference" content="citation_title=Toward a better understanding of the intervening opportunities model;,citation_author=Earl R. Ruiter;,citation_publication_date=1967;,citation_cover_date=1967;,citation_year=1967;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/0041164767900949;,citation_issue=1;,citation_doi=https://doi.org/10.1016/0041-1647(67)90094-9;,citation_volume=1;,citation_journal_title=Transportation Research;">
<meta name="citation_reference" content="citation_title=Spatial Flows and Spatial Patterns;,citation_author=A S Fotheringham;,citation_publication_date=1984-04-01;,citation_cover_date=1984-04-01;,citation_year=1984;,citation_fulltext_html_url=https://doi.org/10.1068/a160529;,citation_issue=4;,citation_doi=10.1068/a160529;,citation_volume=16;,citation_language=en;,citation_journal_title=Environment and Planning A: Economy and Space;">
<meta name="citation_reference" content="citation_title=Spatial Flows and Competing Central Places: Towards a General Theory of Hierarchical Interaction;,citation_author=T J Fik;,citation_author=G F Mulligan;,citation_publication_date=1990-04-01;,citation_cover_date=1990-04-01;,citation_year=1990;,citation_fulltext_html_url=https://doi.org/10.1068/a220527;,citation_issue=4;,citation_doi=10.1068/a220527;,citation_volume=22;,citation_language=en;,citation_journal_title=Environment and Planning A: Economy and Space;">
<meta name="citation_reference" content="citation_title=Human Mobility in a Continuum Approach;,citation_author=Filippo Simini;,citation_author=Amos Maritan;,citation_author=Zoltán Néda;,citation_publication_date=2013-03-28;,citation_cover_date=2013-03-28;,citation_year=2013;,citation_fulltext_html_url=https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0060069;,citation_issue=3;,citation_doi=10.1371/journal.pone.0060069;,citation_volume=8;,citation_language=en;,citation_journal_title=PLOS ONE;">
<meta name="citation_reference" content="citation_title=Systematic comparison of trip distribution laws and models;,citation_author=Maxime Lenormand;,citation_author=Aleix Bassolas;,citation_author=José J. Ramasco;,citation_publication_date=2016-02-01;,citation_cover_date=2016-02-01;,citation_year=2016;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0966692315002422;,citation_doi=10.1016/j.jtrangeo.2015.12.008;,citation_volume=51;,citation_journal_title=Journal of Transport Geography;">
<meta name="citation_reference" content="citation_title=Limits of Predictability in Commuting Flows in the Absence of Data for Calibration;,citation_author=Yingxiang Yang;,citation_author=Carlos Herrera;,citation_author=Nathan Eagle;,citation_author=Marta C. González;,citation_publication_date=2014-07-11;,citation_cover_date=2014-07-11;,citation_year=2014;,citation_fulltext_html_url=https://www.nature.com/articles/srep05662;,citation_issue=1;,citation_doi=10.1038/srep05662;,citation_volume=4;,citation_language=en;,citation_journal_title=Scientific Reports;">
<meta name="citation_reference" content="citation_title=A Method of Fitting the Gravity Model Based on the Poisson Distribution*;,citation_author=Robin Flowerdew;,citation_author=Murray Aitkin;,citation_publication_date=1982;,citation_cover_date=1982;,citation_year=1982;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1467-9787.1982.tb00744.x;,citation_issue=2;,citation_doi=10.1111/j.1467-9787.1982.tb00744.x;,citation_volume=22;,citation_language=en;,citation_journal_title=Journal of Regional Science;">
<meta name="citation_reference" content="citation_title=Categorical data analysis;,citation_author=Alan Agresti;,citation_publication_date=2002-07-03;,citation_cover_date=2002-07-03;,citation_year=2002;,citation_fulltext_html_url=http://dx.doi.org/10.1002/0471249688;,citation_doi=10.1002/0471249688;,citation_journal_title=Wiley Series in Probability and Statistics;">
<meta name="citation_reference" content="citation_title=The multivariate poisson-log normal distribution;,citation_author=J. Aitchison;,citation_author=C. H. Ho;,citation_publication_date=1989-12-01;,citation_cover_date=1989-12-01;,citation_year=1989;,citation_fulltext_html_url=https://doi.org/10.1093/biomet/76.4.643;,citation_issue=4;,citation_doi=10.1093/biomet/76.4.643;,citation_volume=76;,citation_journal_title=Biometrika;">
<meta name="citation_reference" content="citation_title=MEAPS : Modéliser les flux de navetteurs;,citation_author=Maxime Parodi;,citation_author=Xavier Timbeau;,citation_publication_date=2023-05-02;,citation_cover_date=2023-05-02;,citation_year=2023;,citation_fulltext_html_url=https://preview.meaps.fr/theorie.html;,citation_issue=15-2023;,citation_journal_title=Document de travail de l’OFCE;">
<meta name="citation_reference" content="citation_title=MEAPS&amp;amp;amp;gravitaire : Estimations à la rochelle;,citation_author=Maxime Parodi;,citation_author=Xavier Timbeau;,citation_publication_date=2024-02-02;,citation_cover_date=2024-02-02;,citation_year=2024;,citation_fulltext_html_url=https://preview.meaps.fr/larochelle.html;,citation_issue=4-2024;,citation_journal_title=Document de travail de l’OFCE;">
<meta name="citation_reference" content="citation_title=La ville compacte : Une solution aux émissions de gaz à effet de serre;,citation_author=Maxime Parodi;,citation_author=Xavier Timbeau;,citation_publication_date=2024-01-30;,citation_cover_date=2024-01-30;,citation_year=2024;,citation_fulltext_html_url=https://preview.meaps.fr/trajets.html;,citation_issue=5-2024;,citation_journal_title=Document de travail de l’OFCE;">
<meta name="citation_reference" content="citation_title=Handbook of transport modelling;,citation_editor=David A. Hensher;,citation_editor=Kenneth J. Button;,citation_publication_date=2007-09-14;,citation_cover_date=2007-09-14;,citation_year=2007;,citation_fulltext_html_url=http://dx.doi.org/10.1108/9780857245670;,citation_doi=10.1108/9780857245670;,citation_journal_title=Handbooks in Transport;">
<meta name="citation_reference" content="citation_title=La décomposition de l’empreinte carbone de la demande finale de la france par postes de consommation : Transport, alimentation, habitat, équipements et services;,citation_author=Manuel Baude;,citation_publication_date=2022-07-01;,citation_cover_date=2022-07-01;,citation_year=2022;,citation_fulltext_html_url=https://www.statistiques.developpement-durable.gouv.fr/sites/default/files/2022-07/document_travail_59_decomposition_empreinte_carbone_juillet2022.pdf;,citation_technical_report_institution=Ministère de la transition écologique et de la cohésion des territoires;,citation_technical_report_number=59;,citation_series_title=Document de travail;">
<meta name="citation_reference" content="citation_title=Handbook of regional and urban economics;,citation_editor=Gilles Duranton;,citation_editor=J. Vernon Henderson;,citation_editor=William Strange;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_fulltext_html_url=https://EconPapers.repec.org/RePEc:eee:reghes:5;,citation_volume=5;">
<meta name="citation_reference" content="citation_title=A statistical theory of spatial distribution models;,citation_author=A. G. Wilson;,citation_publication_date=1967-11;,citation_cover_date=1967-11;,citation_year=1967;,citation_fulltext_html_url=http://dx.doi.org/10.1016/0041-1647(67)90035-4;,citation_issue=3;,citation_doi=10.1016/0041-1647(67)90035-4;,citation_volume=1;,citation_language=en;,citation_journal_title=Transportation Research;">
<meta name="citation_reference" content="citation_title=Discrete choice analysis: Theory and application to travel demand;,citation_author=Moshe Ben-Akiva;,citation_author=Steven R. Lerman;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_language=en-US;,citation_series_title=Transportation series;">
<meta name="citation_reference" content="citation_title=A comparative evaluation of trip distribution procedures;,citation_author=Kevin E. Heanue;,citation_author=Clyde E. Pyers;,citation_publication_date=1966;,citation_cover_date=1966;,citation_year=1966;,citation_issue=114;,citation_journal_title=Highway Reserach Record;">
<meta name="citation_reference" content="citation_title=Intervening opportunities: A theory relating mobility and distance;,citation_author=Samuel A. Stouffer;,citation_publication_date=1940-12;,citation_cover_date=1940-12;,citation_year=1940;,citation_fulltext_html_url=http://dx.doi.org/10.2307/2084520;,citation_issue=6;,citation_doi=10.2307/2084520;,citation_volume=5;,citation_journal_title=American Sociological Review;">
<meta name="citation_reference" content="citation_title=Modelling transport;,citation_author=Juan Dios Ortúzar;,citation_author=Luis G Willumsen;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;">
<meta name="citation_reference" content="citation_title=Prévision de la demande de transport;,citation_author=undefined Patrick Bonnel;,citation_publication_date=2001-12-01;,citation_cover_date=2001-12-01;,citation_year=2001;,citation_language=français;">
<meta name="citation_reference" content="citation_title=A universal model for mobility and migration patterns;,citation_author=Filippo Simini;,citation_author=Marta C. González;,citation_author=Amos Maritan;,citation_author=Albert-László Barabási;,citation_publication_date=2012-02-26;,citation_cover_date=2012-02-26;,citation_year=2012;,citation_fulltext_html_url=http://dx.doi.org/10.1038/nature10856;,citation_issue=7392;,citation_doi=10.1038/nature10856;,citation_volume=484;,citation_language=en;,citation_journal_title=Nature;">
<meta name="citation_reference" content="citation_title=Theorie economique de l’accessibilite urbaine;,citation_author=G. Koenig;,citation_publication_date=1974-03;,citation_cover_date=1974-03;,citation_year=1974;,citation_fulltext_html_url=http://dx.doi.org/10.2307/3500570;,citation_issue=2;,citation_doi=10.2307/3500570;,citation_volume=25;,citation_journal_title=Revue économique;">
<meta name="citation_reference" content="citation_title=Indicators of urban accessibility: Theory and application;,citation_author=G. Koenig;,citation_publication_date=1980-06;,citation_cover_date=1980-06;,citation_year=1980;,citation_fulltext_html_url=http://dx.doi.org/10.1007/bf00167128;,citation_issue=2;,citation_doi=10.1007/bf00167128;,citation_volume=9;,citation_language=en;,citation_journal_title=Transportation;">
<meta name="citation_reference" content="citation_title=Evidence-Based Transit and Land Use Sketch Planning Using Interactive Accessibility Methods on Combined Schedule and Headway-Based Networks;,citation_author=Matthew Wigginton Conway;,citation_author=Andrew Byrd;,citation_author=Marco Linden;,citation_publication_date=2017-01;,citation_cover_date=2017-01;,citation_year=2017;,citation_fulltext_html_url=http://dx.doi.org/10.3141/2653-06;,citation_issue=1;,citation_doi=10.3141/2653-06;,citation_volume=2653;,citation_language=en;,citation_journal_title=Transportation Research Record: Journal of the Transportation Research Board;">
<meta name="citation_reference" content="citation_title=Accounting for uncertainty and variation in accessibility metrics for public transport sketch planning;,citation_author=Matthew Wigginton Conway;,citation_author=Andrew Byrd;,citation_author=Michael Van Eggermond;,citation_publication_date=2018-07-23;,citation_cover_date=2018-07-23;,citation_year=2018;,citation_fulltext_html_url=http://dx.doi.org/10.5198/jtlu.2018.1074;,citation_issue=1;,citation_doi=10.5198/jtlu.2018.1074;,citation_volume=11;,citation_journal_title=Journal of Transport and Land Use;">
<meta name="citation_reference" content="citation_title=Getting Charlie off the MTA: a multiobjective optimization method to account for cost constraints in public transit accessibility metrics;,citation_author=Matthew Wigginton Conway;,citation_author=Anson F. Stewart;,citation_publication_date=2019-04-30;,citation_cover_date=2019-04-30;,citation_year=2019;,citation_fulltext_html_url=http://dx.doi.org/10.1080/13658816.2019.1605075;,citation_issue=9;,citation_doi=10.1080/13658816.2019.1605075;,citation_volume=33;,citation_language=en;,citation_journal_title=International Journal of Geographical Information Science;">
<meta name="citation_reference" content="citation_title=r5r: Rapid realistic routing on multimodal transport networks with R5 in r;,citation_author=Rafael H. M. Pereira;,citation_author=Marcus Saraiva undefined;,citation_author=Daniel Herszenhut undefined;,citation_author=Carlos Kaue Vieira Braga undefined;,citation_author=Matthew Wigginton Conway undefined;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_doi=10.32866/001c.21262;">
<meta name="citation_reference" content="citation_title=Planet dump retrieved from https://planet.osm.org;,citation_author=OpenStreetMap contributors;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_fulltext_html_url=https://www.openstreetmap.org;">
<meta name="citation_reference" content="citation_title=Revenus, pauvreté et niveau de vie en 2017 - données carroyées. Dispositif fichier localisé social et fiscal (filosofi);,citation_author=undefined INSEE;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://www.insee.fr/fr/statistiques/6214811?sommaire=6215217;,citation_publisher=INSEE;">
<meta name="citation_reference" content="citation_title=Mobilités professionnelles en 2019 : Déplacements domicile - lieu de travail recensement de la population - base flux de mobilité;,citation_author=undefined INSEE;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://www.insee.fr/fr/statistiques/6454112;,citation_publisher=INSEE;">
<meta name="citation_reference" content="citation_title=EMP 2019 résultats détaillés de l’enquête mobilité des personnes de 2019;,citation_author=undefined SDES;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://www.statistiques.developpement-durable.gouv.fr/resultats-detailles-de-lenquete-mobilite-des-personnes-de-2019;,citation_publisher=SDES, Ministère de la transition écologique et de la cohésion des territoires;">
<meta name="citation_reference" content="citation_title=Creating an executable paper is a journey through Open Science;,citation_author=Jana Lasser;,citation_publication_date=2020-08-19;,citation_cover_date=2020-08-19;,citation_year=2020;,citation_fulltext_html_url=http://dx.doi.org/10.1038/s42005-020-00403-4;,citation_issue=1;,citation_doi=10.1038/s42005-020-00403-4;,citation_volume=3;,citation_language=en;,citation_journal_title=Communications Physics;">
<meta name="citation_reference" content="citation_title=On Information and Sufficiency;,citation_author=S. Kullback;,citation_author=R. A. Leibler;,citation_publication_date=1951-03;,citation_cover_date=1951-03;,citation_year=1951;,citation_fulltext_html_url=http://dx.doi.org/10.1214/aoms/1177729694;,citation_issue=1;,citation_doi=10.1214/aoms/1177729694;,citation_volume=22;,citation_language=en;,citation_journal_title=The Annals of Mathematical Statistics;">
<meta name="citation_reference" content="citation_title=An R-squared measure of goodness of fit for some common nonlinear regression models;,citation_author=A. Colin Cameron;,citation_author=Frank A. G. Windmeijer;,citation_publication_date=1997-04;,citation_cover_date=1997-04;,citation_year=1997;,citation_fulltext_html_url=http://dx.doi.org/10.1016/S0304-4076(96)01818-0;,citation_issue=2;,citation_doi=10.1016/s0304-4076(96)01818-0;,citation_volume=77;,citation_language=en;,citation_journal_title=Journal of Econometrics;">
<meta name="citation_reference" content="citation_title=Foreword;,citation_author=Gilles Duranton;,citation_author=Vernon Henderson;,citation_author=William Strange;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_fulltext_html_url=http://dx.doi.org/10.1016/b978-0-444-59517-1.09998-0;,citation_doi=10.1016/b978-0-444-59517-1.09998-0;,citation_inbook_title=undefined;">
<meta name="citation_reference" content="citation_title=Compactness versus Sprawl: A Review of Recent Evidence from the United States;,citation_author=Reid Ewing;,citation_author=Shima Hamidi;,citation_publication_date=2015-11-01;,citation_cover_date=2015-11-01;,citation_year=2015;,citation_fulltext_html_url=https://doi.org/10.1177/0885412215595439;,citation_issue=4;,citation_doi=10.1177/0885412215595439;,citation_volume=30;,citation_language=en;,citation_journal_title=Journal of Planning Literature;">
<meta name="citation_reference" content="citation_title=Compactness versus Sprawl: A Review of Recent Evidence from the United States;,citation_author=Reid Ewing;,citation_author=Shima Hamidi;,citation_publication_date=2015-11-01;,citation_cover_date=2015-11-01;,citation_year=2015;,citation_fulltext_html_url=https://doi.org/10.1177/0885412215595439;,citation_issue=4;,citation_doi=10.1177/0885412215595439;,citation_volume=30;,citation_language=en;,citation_journal_title=Journal of Planning Literature;">
<meta name="citation_reference" content="citation_title=Urban form and driving: Evidence from US cities;,citation_author=Gilles Duranton;,citation_author=Matthew A. Turner;,citation_publication_date=2018-11;,citation_cover_date=2018-11;,citation_year=2018;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S0094119018300871;,citation_doi=10.1016/j.jue.2018.10.003;,citation_volume=108;,citation_language=en;,citation_journal_title=Journal of Urban Economics;">
<meta name="citation_reference" content="citation_title=The impact of urban form on vehicle ownership;,citation_author=Matthew J. Holian;,citation_publication_date=2020-01;,citation_cover_date=2020-01;,citation_year=2020;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S0165176519303830;,citation_doi=10.1016/j.econlet.2019.108763;,citation_volume=186;,citation_language=en;,citation_journal_title=Economics Letters;">
<meta name="citation_reference" content="citation_title=An empirical analysis of urban form, transport, and global warming;,citation_author=Fabio Grazi;,citation_author=Jeroen C. J. M. Van Den Bergh;,citation_author=Jos N. Van Ommeren;,citation_publication_date=2008-10-01;,citation_cover_date=2008-10-01;,citation_year=2008;,citation_fulltext_html_url=http://www.iaee.org/en/publications/ejarticle.aspx?id=2279;,citation_issue=4;,citation_doi=10.5547/ISSN0195-6574-EJ-Vol29-No4-5;,citation_volume=29;,citation_journal_title=The Energy Journal;">
<meta name="citation_reference" content="citation_title=Does Compact Development Make People Drive Less?;,citation_author=Mark R. Stevens;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_fulltext_html_url=https://www.tandfonline.com/doi/epdf/10.1080/01944363.2016.1240044?needAccess=true&amp;amp;amp;role=button;,citation_issue=1;,citation_volume=38;,citation_language=en;,citation_journal_title=Journal of the American Planning Association;">
<meta name="citation_reference" content="citation_title=Sustainability and Cities: Overcoming Automobile Dependence;,citation_author=Peter Newman;,citation_author=Jeffrey Kenworthy;,citation_publication_date=1999-02;,citation_cover_date=1999-02;,citation_year=1999;,citation_language=en;">
<meta name="citation_reference" content="citation_title=Travel demand and the 3Ds: Density, diversity, and design;,citation_author=Robert Cervero;,citation_author=Kara Kockelman;,citation_publication_date=1997-09;,citation_cover_date=1997-09;,citation_year=1997;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S1361920997000096;,citation_issue=3;,citation_doi=10.1016/S1361-9209(97)00009-6;,citation_volume=2;,citation_language=en;,citation_journal_title=Transportation Research Part D: Transport and Environment;">
<meta name="citation_reference" content="citation_title=Mixed Use by Default: How the Europeans (Don’t) Zone;,citation_author=Sonia Hirt;,citation_publication_date=2012-11-01;,citation_cover_date=2012-11-01;,citation_year=2012;,citation_fulltext_html_url=https://doi.org/10.1177/0885412212451029;,citation_issue=4;,citation_doi=10.1177/0885412212451029;,citation_volume=27;,citation_language=en;,citation_journal_title=Journal of Planning Literature;">
<meta name="citation_reference" content="citation_title=Comparing the impacts of local land use and urban spatial structure on household VMT and GHG emissions;,citation_author=Sungwon Lee;,citation_author=Bumsoo Lee;,citation_publication_date=2020-04;,citation_cover_date=2020-04;,citation_year=2020;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S0966692319304971;,citation_doi=10.1016/j.jtrangeo.2020.102694;,citation_volume=84;,citation_language=en;,citation_journal_title=Journal of Transport Geography;">
<meta name="citation_reference" content="citation_title=Three Challenges for the Compact City as a Sustainable Urban Form: Household Consumption of Energy and Transport in Eight Residential Areas in the Greater Oslo Region;,citation_author=Erling Holden;,citation_author=Ingrid T. Norland;,citation_publication_date=2005-11-01;,citation_cover_date=2005-11-01;,citation_year=2005;,citation_fulltext_html_url=https://doi.org/10.1080/00420980500332064;,citation_issue=12;,citation_doi=10.1080/00420980500332064;,citation_volume=42;,citation_language=en;,citation_journal_title=Urban Studies;">
<meta name="citation_reference" content="citation_title=Quelles interactions entre les marchés de la mobilité à courte et à longue distance&nbsp;?;,citation_author=Jean-Pierre Orfeuil;,citation_author=Danièle Soleyret;,citation_publication_date=2002-10-01;,citation_cover_date=2002-10-01;,citation_year=2002;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0761898002000134;,citation_doi=10.1016/S0761-8980(02)00013-4;,citation_volume=76;,citation_journal_title=Recherche - Transports - Sécurité;">
<meta name="citation_reference" content="citation_title=La contrainte énergétique doit-elle réguler la ville ou les véhicules ? Mobilités urbaines et réalisme écologique;,citation_author=Marie-Hélène Massot;,citation_author=Jean-Pierre Orfeuil;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_fulltext_html_url=https://www.persee.fr/doc/aru_0180-930x_2007_num_103_1_2710;,citation_issue=1;,citation_doi=10.3406/aru.2007.2710;,citation_volume=103;,citation_language=fre;,citation_journal_title=Les Annales de la Recherche Urbaine;">
<meta name="citation_reference" content="citation_title=Forme urbaine et mobilités de loisirs : l’« effet barbecue » sur le grill;,citation_author=Sébastien Munafò;,citation_publication_date=2017-10-16;,citation_cover_date=2017-10-16;,citation_year=2017;,citation_fulltext_html_url=https://journals.openedition.org/cybergeo/28634;,citation_doi=10.4000/cybergeo.28634;,citation_language=fr;,citation_journal_title=Cybergeo: European Journal of Geography;">
<meta name="citation_reference" content="citation_title=The compensation hypothesis in barcelona measured through the ecological footprint of mobility and housing;,citation_author=Ivan Muñiz;,citation_author=Daniel Calatayud;,citation_author=Roger Dobaño;,citation_publication_date=2013-05-01;,citation_cover_date=2013-05-01;,citation_year=2013;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S016920461300025X;,citation_doi=10.1016/j.landurbplan.2013.02.004;,citation_volume=113;,citation_journal_title=Landscape and Urban Planning;">
<meta name="citation_reference" content="citation_title=Jobs-housing balancing and regional mobility;,citation_author=Robert Cervero;,citation_publication_date=1989-06-30;,citation_cover_date=1989-06-30;,citation_year=1989;,citation_fulltext_html_url=https://doi.org/10.1080/01944368908976014;,citation_issue=2;,citation_doi=10.1080/01944368908976014;,citation_volume=55;,citation_journal_title=Journal of the American Planning Association;">
<meta name="citation_reference" content="citation_title=Planning the Built Environment and Land Use Towards Deep Decarbonization of the United States;,citation_author=David Hsu;,citation_author=Clinton J. Andrews;,citation_author=Albert T. Han;,citation_author=Carolyn G. Loh;,citation_author=Anna C. Osland;,citation_author=Christopher P. Zegras;,citation_publication_date=2023-08-01;,citation_cover_date=2023-08-01;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1177/08854122221097977;,citation_issue=3;,citation_doi=10.1177/08854122221097977;,citation_volume=38;,citation_language=en;,citation_journal_title=Journal of Planning Literature;">
<meta name="citation_reference" content="citation_title=The compact city: A successful, desirable and achievable urban form?;,citation_editor=Mike Jenks;,citation_editor=Katie Williams;,citation_editor=Elizabeth Burton;,citation_publication_date=2003-09-02;,citation_cover_date=2003-09-02;,citation_year=2003;,citation_fulltext_html_url=http://dx.doi.org/10.4324/9780203362372-12;,citation_doi=10.4324/9780203362372-12;,citation_inbook_title=undefined;">
<meta name="citation_reference" content="citation_title=Compact city: A plan for a liveable urban environment;,citation_author=G. B. Dantzig;,citation_author=G. B. Dantzig;,citation_author=T. L. Saaty;,citation_publication_date=1973;,citation_cover_date=1973;,citation_year=1973;,citation_fulltext_html_url=https://books.google.fr/books?id=PTeIQgAACAAJ;">
<meta name="citation_reference" content="citation_title=The death and life of great american cities;,citation_author=J. Jacobs;,citation_publication_date=1961;,citation_cover_date=1961;,citation_year=1961;,citation_fulltext_html_url=https://books.google.fr/books?id=5FdHAAAAMAAJ;,citation_series_title=A vintage book;">
<meta name="citation_reference" content="citation_title=Zoned out: Regulation, markets, and choices in transportation and metropolitan land use;,citation_author=J. Levine;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_fulltext_html_url=https://books.google.fr/books?id=HTCl9W9rg3oC;">
<meta name="citation_reference" content="citation_title=Sustainability and Cities: Overcoming Automobile Dependence;,citation_author=Peter Newman;,citation_author=Jeffrey Kenworthy;,citation_publication_date=1999-02;,citation_cover_date=1999-02;,citation_year=1999;,citation_language=en;">
<meta name="citation_reference" content="citation_title=Cities and automobile dependence;,citation_author=Peter Newman;,citation_author=Jeffrey Kenworthy;,citation_publication_date=1989;,citation_cover_date=1989;,citation_year=1989;">
<meta name="citation_reference" content="citation_title=Gasoline Consumption and Cities;,citation_author=Peter Newman;,citation_author=Jeffrey Kenworthy;,citation_publication_date=1989;,citation_cover_date=1989;,citation_year=1989;,citation_fulltext_html_url=https://www.tandfonline.com/doi/epdf/10.1080/01944368908975398?needAccess=true&amp;amp;amp;role=button;,citation_doi=10.1080/01944368908975398;,citation_volume=Winter 1989;,citation_language=en;,citation_journal_title=Journal of the Amrican Planning Association;">
<meta name="citation_reference" content="citation_title=Testing newman and kenworthy’s theory of density and automobile dependence;,citation_author=Reid Ewing;,citation_author=Shima Hamidi;,citation_author=Guang Tian;,citation_author=David Proffitt;,citation_author=Stefania Tonin;,citation_author=Laura Fregolent;,citation_publication_date=2017-01-27;,citation_cover_date=2017-01-27;,citation_year=2017;,citation_doi=10.1177/0739456X16688767;,citation_volume=38;,citation_journal_title=Journal of Planning Education and Research;">
<meta name="citation_reference" content="citation_title=Travel and the built environment;,citation_author=Reid Ewing;,citation_author=Robert Cervero;,citation_publication_date=2010-06-21;,citation_cover_date=2010-06-21;,citation_year=2010;,citation_fulltext_html_url=https://doi.org/10.1080/01944361003766766;,citation_issue=3;,citation_doi=10.1080/01944361003766766;,citation_volume=76;,citation_journal_title=Journal of the American Planning Association;">
<meta name="citation_reference" content="citation_title=Are compact cities environmentally friendly?;,citation_author=Carl Gaigné;,citation_author=Stéphane Riou;,citation_author=Jacques-François Thisse;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S0094119012000186;,citation_issue=2-3;,citation_doi=10.1016/j.jue.2012.04.001;,citation_volume=72;,citation_language=en;,citation_journal_title=Journal of Urban Economics;">
<meta name="citation_reference" content="citation_title=Review of International Modeling Literature: Transit, Land Use, and Auto Pricing Strategies to Reduce Vehicle Miles Traveled and Greenhouse Gas Emissions;,citation_author=Caroline Rodier;,citation_publication_date=2009-01-01;,citation_cover_date=2009-01-01;,citation_year=2009;,citation_fulltext_html_url=https://doi.org/10.3141/2132-01;,citation_issue=1;,citation_doi=10.3141/2132-01;,citation_volume=2132;,citation_language=en;,citation_journal_title=Transportation Research Record;">
<meta name="citation_reference" content="citation_title=Is los angeles-style sprawl desirable?;,citation_author=Reid Ewing;,citation_publication_date=1997-03-31;,citation_cover_date=1997-03-31;,citation_year=1997;,citation_fulltext_html_url=https://doi.org/10.1080/01944369708975728;,citation_issue=1;,citation_doi=10.1080/01944369708975728;,citation_volume=63;,citation_journal_title=Journal of the American Planning Association;">
<meta name="citation_reference" content="citation_title=Are compact cities a desirable planning goal?;,citation_author=Peter Gordon;,citation_author=Harry W. Richardson;,citation_publication_date=1997-03-31;,citation_cover_date=1997-03-31;,citation_year=1997;,citation_fulltext_html_url=https://doi.org/10.1080/01944369708975727;,citation_issue=1;,citation_doi=10.1080/01944369708975727;,citation_volume=63;,citation_journal_title=Journal of the American Planning Association;">
<meta name="citation_reference" content="citation_title=A sustainable future through the compact city? Urban intensification in the united kingdom;,citation_author=Mike Jenks;,citation_author=Katie Williams;,citation_author=Elizabeth Burton;,citation_publication_date=1996-01-01;,citation_cover_date=1996-01-01;,citation_year=1996;,citation_volume=1;,citation_journal_title=Environments by Design;">
<meta name="citation_reference" content="citation_title=Influence of Urban Form on Travel Behaviour in Four Neighbourhoods of Shanghai;,citation_author=Haixiao Pan;,citation_author=Qing Shen;,citation_author=Ming Zhang;,citation_publication_date=2009-02-01;,citation_cover_date=2009-02-01;,citation_year=2009;,citation_fulltext_html_url=https://doi.org/10.1177/0042098008099355;,citation_issue=2;,citation_doi=10.1177/0042098008099355;,citation_volume=46;,citation_language=en;,citation_journal_title=Urban Studies;">
<meta name="citation_reference" content="citation_title=Introduction to the theory of complex systems;,citation_author=Stefan Thurner;,citation_author=Peter Klimek;,citation_author=Rudolf Hanel;,citation_publication_date=2018-11-22;,citation_cover_date=2018-11-22;,citation_year=2018;,citation_fulltext_html_url=http://dx.doi.org/10.1093/oso/9780198821939.001.0001;,citation_doi=10.1093/oso/9780198821939.001.0001;">
<meta name="citation_reference" content="citation_title=Adapting cities to climate change: A systemic modelling approach;,citation_author=V. Masson;,citation_author=C. Marchadier;,citation_author=L. Adolphe;,citation_author=R. Aguejdad;,citation_author=P. Avner;,citation_author=M. Bonhomme;,citation_author=G. Bretagne;,citation_author=X. Briottet;,citation_author=B. Bueno;,citation_author=C. Munck;,citation_author=O. Doukari;,citation_author=S. Hallegatte;,citation_author=J. Hidalgo;,citation_author=T. Houet;,citation_author=J. Le Bras;,citation_author=A. Lemonsu;,citation_author=N. Long;,citation_author=M. -P. Moine;,citation_author=T. Morel;,citation_author=L. Nolorgues;,citation_author=G. Pigeon;,citation_author=J. -L. Salagnac;,citation_author=V. Viguié;,citation_author=K. Zibouche;,citation_publication_date=2014-12-01;,citation_cover_date=2014-12-01;,citation_year=2014;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S2212095514000212;,citation_doi=10.1016/j.uclim.2014.03.004;,citation_volume=10;,citation_journal_title=Urban Climate;,citation_series_title=ICUC8: The 8th international conference on urban climate and the 10th symposium on the urban environment;">
<meta name="citation_reference" content="citation_title=The New Science of Cities;,citation_author=Michael Batty;,citation_publication_date=2013-11-01;,citation_cover_date=2013-11-01;,citation_year=2013;,citation_fulltext_html_url=https://direct.mit.edu/books/book/3422/The-New-Science-of-Cities;,citation_doi=10.7551/mitpress/9399.001.0001;,citation_language=en;">
<meta name="citation_reference" content="citation_title=Introduction to urban science: Evidence and theory of cities as complex systems;,citation_author=Luís Bettencourt;,citation_publication_date=2021-01-01;,citation_cover_date=2021-01-01;,citation_year=2021;,citation_doi=10.7551/mitpress/13909.001.0001;">
<meta name="citation_reference" content="citation_title=Le quart des ménages les plus aisés à l’origine de 35;,citation_author=undefined SDES;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://www.statistiques.developpement-durable.gouv.fr/sites/default/files/2023-07/datalab_essentiel_314_emission_ges_mobilites_juillet2023_0.pdf;">
<meta name="citation_reference" content="citation_title=12 Human Settlements, Infrastructure, and Spatial Planning;,citation_author=Karen C Seto;,citation_author=Shobhakar Dhakal;,citation_author=Anthony Bigio;,citation_author=Hilda Blanco;,citation_author=Gian Carlo Delgado;,citation_author=David Dewar;,citation_author=Luxin Huang;,citation_author=Atsushi Inaba;,citation_author=Arun Kansal;,citation_author=Shuaib Lwasa;,citation_author=James McMahon;,citation_author=Daniel B Müller;,citation_author=Jin Murakami;,citation_author=Harini Nagendra;,citation_author=Anu Ramaswami;,citation_author=Antonio Bento;,citation_author=Michele Betsill;,citation_author=Harriet Bulkeley;,citation_author=Abel Chavez;,citation_author=Peter Christensen;,citation_author=Felix Creutzig;,citation_author=Michail Fragkias;,citation_author=Burak Güneralp;,citation_author=Leiwen Jiang;,citation_author=Peter Marcotullio;,citation_author=David McCollum;,citation_author=Adam Millard-Ball;,citation_author=Paul Pichler;,citation_author=Serge Salat;,citation_author=Cecilia Tacoli;,citation_author=Helga Weisz;,citation_author=Timm Zwickel;,citation_author=Robert Cervero;,citation_author=Julio Torres Martinez;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_fulltext_html_url=https://www.ipcc.ch/site/assets/uploads/2018/02/ipcc_wg3_ar5_chapter12.pdf;,citation_language=en;,citation_inbook_title=undefined;">
<meta name="citation_reference" content="citation_title=Urban systems and other settlements;,citation_author=undefined Lwasa, S.;,citation_author=K. C. Seto;,citation_author=X. Bai;,citation_author=H. Blanco;,citation_author=K. R. Gurney;,citation_author=Ş. Kılkış;,citation_author=O. Lucon;,citation_author=J. Murakami;,citation_author=J. Pan;,citation_author=A. Sharifi;,citation_author=Y. Yamagata;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://www.ipcc.ch/report/ar6/wg3/downloads/report/IPCC_AR6_WGIII_Chapter08.pdf;,citation_inbook_title=undefined;">
<meta name="citation_reference" content="citation_title=10. transport;,citation_author=P. Jaramillo;,citation_author=S. Kahn Ribeiro;,citation_author=P. Newman;,citation_author=S. Dhar;,citation_author=O. E. Diemuodeke;,citation_author=T. Kajino;,citation_author=D. S. Lee;,citation_author=S. B. Nugroho;,citation_author=X. Ou;,citation_author=A. Hammer Strømman;,citation_author=J. Whitehead;,citation_publication_date=2023-08-17;,citation_cover_date=2023-08-17;,citation_year=2023;,citation_fulltext_html_url=http://dx.doi.org/10.1017/9781009157926.012;,citation_doi=10.1017/9781009157926.012;,citation_inbook_title=undefined;">
<meta name="citation_reference" content="citation_title=Post-growth planning;,citation_author=Federico Savini;,citation_author=António Ferreira;,citation_author=Kim Carlotta Schönfeld;,citation_publication_date=2022-03-23;,citation_cover_date=2022-03-23;,citation_year=2022;,citation_fulltext_html_url=http://dx.doi.org/10.4324/9781003160984;,citation_doi=10.4324/9781003160984;">
<meta name="citation_reference" content="citation_title=Exploratory data analysis;,citation_author=John W. Tukey;,citation_publication_date=1977;,citation_cover_date=1977;,citation_year=1977;">
<meta name="citation_reference" content="citation_title=The impact of residential density on vehicle usage and energy consumption;,citation_author=David Brownstone;,citation_author=Thomas F. Golob;,citation_publication_date=2009-01;,citation_cover_date=2009-01;,citation_year=2009;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S0094119008001095;,citation_issue=1;,citation_doi=10.1016/j.jue.2008.09.002;,citation_volume=65;,citation_language=en;,citation_journal_title=Journal of Urban Economics;">
<meta name="citation_reference" content="citation_title=A queuing model with state dependent service rates;,citation_author=R. W. Conway;,citation_author=W. L. Maxwell;,citation_publication_date=1962;,citation_cover_date=1962;,citation_year=1962;,citation_issue=2;,citation_volume=12;,citation_journal_title=Journal of Industrial Engineering;">
<meta name="citation_reference" content="citation_title=The measurement of urban travel demand;,citation_author=Daniel McFadden;,citation_publication_date=1974-11;,citation_cover_date=1974-11;,citation_year=1974;,citation_fulltext_html_url=http://dx.doi.org/10.1016/0047-2727(74)90003-6;,citation_issue=4;,citation_doi=10.1016/0047-2727(74)90003-6;,citation_volume=3;,citation_language=en;,citation_journal_title=Journal of Public Economics;">
<meta name="citation_reference" content="citation_title=A New Set of Spatial-Interaction Models: The Theory of Competing Destinations;,citation_author=A S Fotheringham;,citation_publication_date=1983-01-01;,citation_cover_date=1983-01-01;,citation_year=1983;,citation_fulltext_html_url=https://doi.org/10.1177/0308518X8301500103;,citation_issue=1;,citation_doi=10.1177/0308518X8301500103;,citation_volume=15;,citation_language=en;,citation_journal_title=Environment and Planning A: Economy and Space;">
<meta name="citation_reference" content="citation_title=The carbon ‘carprint’ of urbanization: New evidence from french cities;,citation_author=Camille Blaudin de Thé;,citation_author=Benjamin Carantino;,citation_author=Miren Lafourcade;,citation_publication_date=2021-07-01;,citation_cover_date=2021-07-01;,citation_year=2021;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0166046221000533;,citation_doi=10.1016/j.regsciurbeco.2021.103693;,citation_volume=89;,citation_journal_title=Regional Science and Urban Economics;">
<meta name="citation_reference" content="citation_title=SCoT La Rochelle Aunis : les émissions moyennes des habitants du territoire pour leurs mobilités quotidiennes;,citation_author=Paul Lempérière;,citation_author=David Miet;,citation_author=Maxime Parodi;,citation_author=Lucas Pouvreau;,citation_author=Valentin Stulhfauth;,citation_author=Xavier Timbeau;,citation_publication_date=2023-04-11;,citation_cover_date=2023-04-11;,citation_year=2023;,citation_fulltext_html_url=https://publications.vv.energy/la-rochelle-aunis-carbone.html;,citation_language=fr;">
<meta name="citation_reference" content="citation_title=Who lives where?;,citation_author=Jacques Lévy;,citation_author=Jean Coldefy;,citation_author=Sébastien Piantoni;,citation_author=Julien François;,citation_publication_date=2023-05;,citation_cover_date=2023-05;,citation_year=2023;,citation_fulltext_html_url=https://hal.science/hal-04105977;">
<meta name="citation_reference" content="citation_title=How accessibility shapes land use;,citation_author=Walter G. Hansen;,citation_publication_date=1959-05-01;,citation_cover_date=1959-05-01;,citation_year=1959;,citation_fulltext_html_url=https://doi.org/10.1080/01944365908978307;,citation_issue=2;,citation_doi=10.1080/01944365908978307;,citation_volume=25;,citation_journal_title=Journal of the American Institute of Planners;">
<meta name="citation_reference" content="citation_title=Measuring Accessibility: A Review and Proposal;,citation_author=G H Pirie;,citation_publication_date=1979-03-01;,citation_cover_date=1979-03-01;,citation_year=1979;,citation_fulltext_html_url=https://doi.org/10.1068/a110299;,citation_issue=3;,citation_doi=10.1068/a110299;,citation_volume=11;,citation_language=en;,citation_journal_title=Environment and Planning A: Economy and Space;">
<meta name="citation_reference" content="citation_title=Le territoire des hommes;,citation_author=Jean Poulit;,citation_publication_date=2005;,citation_cover_date=2005;,citation_year=2005;,citation_fulltext_html_url=https://editionslesperegrines.fr/fr/books/le-territoire-des-hommes;">
<meta name="citation_reference" content="citation_title=Gravity versus radiation models: On the importance of scale and heterogeneity in commuting flows;,citation_author=A. Paolo Masucci;,citation_author=Joan Serras;,citation_author=Anders Johansson;,citation_author=Michael Batty;,citation_publication_date=2013-08-22;,citation_cover_date=2013-08-22;,citation_year=2013;,citation_fulltext_html_url=https://link.aps.org/doi/10.1103/PhysRevE.88.022812;,citation_issue=2;,citation_doi=10.1103/PhysRevE.88.022812;,citation_volume=88;,citation_journal_title=Physical Review E;">
<meta name="citation_reference" content="citation_title=Modèle de radiation et modèle gravitaire - Du formalisme à l’usage;,citation_author=Hadrien Commenges;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_fulltext_html_url=https://rig.revuesonline.com/articles/lvrig/abs/2016/01/lvrig261p79/lvrig261p79.html;,citation_issue=1;,citation_doi=10.3166/RIG.26.79-95;,citation_volume=26;,citation_language=fr;,citation_journal_title=Revue Internationale de Géomatique;">
<meta name="citation_reference" content="citation_title=Constrained Variants of the Gravity Model and Spatial Dependence: Model Specification and Estimation Issues;,citation_author=Daniel A. Griffith;,citation_author=Manfred M. Fischer;,citation_editor=Roberto Patuelli;,citation_editor=Giuseppe Arbia;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_fulltext_html_url=https://doi.org/10.1007/978-3-319-30196-9_3;,citation_doi=10.1007/978-3-319-30196-9_3;,citation_language=en;,citation_inbook_title=undefined;">
<meta name="citation_reference" content="citation_title=Les interactions spatiales. Quelques conséquences de l’introduction du modèle radiatif;,citation_author=Jean-Michel Floch;,citation_author=Patrick Sillard;,citation_publication_date=2019-02-08;,citation_cover_date=2019-02-08;,citation_year=2019;,citation_fulltext_html_url=https://thema.univ-fcomte.fr/theoq/pdf/2019/communications/2019_Floch.pdf;,citation_journal_title=Colloque Théo Quant 2019;">
<meta name="citation_reference" content="citation_title=Gravity models of spatial interaction behavior;,citation_author=Ashish Sen;,citation_author=Tony E. Smith;,citation_publication_date=1995;,citation_cover_date=1995;,citation_year=1995;,citation_fulltext_html_url=http://link.springer.com/10.1007/978-3-642-79880-1;,citation_doi=10.1007/978-3-642-79880-1;,citation_series_title=Advances in spatial and network economics;">
</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://www.ofce.fr/" class="navbar-brand navbar-brand-logo">
    <img src="./www/ofce_m.png" alt="OFCE" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Recherche"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Basculer la navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text"><iconify-icon inline="" icon="game-icons:mesh-network"></iconify-icon> MEAPS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./theorie.html"> 
<span class="menu-text"><iconify-icon inline="" icon="fluent:clipboard-math-formula-16-regular"></iconify-icon> Théorie</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./larochelle.html"> <i class="bi bi-database-check" role="img">
</i> 
<span class="menu-text">Estimations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./trajets.html"> 
<span class="menu-text"><iconify-icon inline="" icon="gis:statistic-map"></iconify-icon> Projection</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./presentations.html"> 
<span class="menu-text"><iconify-icon inline="" icon="ri:presentation-line"></iconify-icon> Présentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./references.html"> <i class="bi bi-book" role="img">
</i> 
<span class="menu-text">Références</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> <i class="bi bi-person-circle" role="img">
</i> 
<span class="menu-text">A propos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/xtimbeau/meaps"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"> </span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Basculer en mode lecteur">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
   <p class="wp">
    Document de travail<br>de l’
    <img src="site_libs/quarto-contrib/quarto-project/ofce/wp/ofce_m.png" width="30" height="15" style="margin:0px -4px">
    &nbsp;n°15-2023</p>
  
    <h2 id="toc-title">Sur cette page</h2>
   
  <ul>
  <li><a href="#tobler-does-not-imply-gravity" id="toc-tobler-does-not-imply-gravity" class="nav-link active" data-scroll-target="#tobler-does-not-imply-gravity"><span class="header-section-number">1</span> Tobler dœs not imply gravity</a></li>
  <li><a href="#sec-theorie" id="toc-sec-theorie" class="nav-link" data-scroll-target="#sec-theorie"><span class="header-section-number">2</span> Gravity modelling</a>
  <ul class="collapse">
  <li><a href="#sec-grav" id="toc-sec-grav" class="nav-link" data-scroll-target="#sec-grav"><span class="header-section-number">2.1</span> The inadequacies of the gravity model</a></li>
  <li><a href="#sec-rad" id="toc-sec-rad" class="nav-link" data-scroll-target="#sec-rad"><span class="header-section-number">2.2</span> A first alternative: the radiative model</a></li>
  </ul></li>
  <li><a href="#sec-meaps" id="toc-sec-meaps" class="nav-link" data-scroll-target="#sec-meaps"><span class="header-section-number">3</span> MEAPS: an Ergodic Absorption Model with Priority and Saturation</a>
  <ul class="collapse">
  <li><a href="#ranking-destination-choice-and-absorption" id="toc-ranking-destination-choice-and-absorption" class="nav-link" data-scroll-target="#ranking-destination-choice-and-absorption"><span class="header-section-number">3.1</span> Ranking, destination choice and absorption</a></li>
  <li><a href="#sec-priorite" id="toc-sec-priorite" class="nav-link" data-scroll-target="#sec-priorite"><span class="header-section-number">3.2</span> Saturation and priority</a></li>
  <li><a href="#sec-erg" id="toc-sec-erg" class="nav-link" data-scroll-target="#sec-erg"><span class="header-section-number">3.3</span> Ergodicity</a></li>
  <li><a href="#sec-hetero" id="toc-sec-hetero" class="nav-link" data-scroll-target="#sec-hetero"><span class="header-section-number">3.4</span> Heterogeneity of leakage and absorption</a></li>
  </ul></li>
  <li><a href="#sec-synth" id="toc-sec-synth" class="nav-link" data-scroll-target="#sec-synth"><span class="header-section-number">4</span> Synthetic simulations</a>
  <ul class="collapse">
  <li><a href="#sec-3p2s" id="toc-sec-3p2s" class="nav-link" data-scroll-target="#sec-3p2s"><span class="header-section-number">4.1</span> Three centres and satellites</a></li>
  <li><a href="#sec-compgravsynth" id="toc-sec-compgravsynth" class="nav-link" data-scroll-target="#sec-compgravsynth"><span class="header-section-number">4.2</span> Comparison with the gravity model</a></li>
  <li><a href="#sec-estimation" id="toc-sec-estimation" class="nav-link" data-scroll-target="#sec-estimation"><span class="header-section-number">4.3</span> Estimation procedure</a></li>
  <li><a href="#sec-ergemp" id="toc-sec-ergemp" class="nav-link" data-scroll-target="#sec-ergemp"><span class="header-section-number">4.4</span> Ergodicity in practice</a></li>
  <li><a href="#localised-tension-by-job" id="toc-localised-tension-by-job" class="nav-link" data-scroll-target="#localised-tension-by-job"><span class="header-section-number">4.5</span> Localised tension by job</a></li>
  <li><a href="#synthetic-simulation-in-shiny" id="toc-synthetic-simulation-in-shiny" class="nav-link" data-scroll-target="#synthetic-simulation-in-shiny"><span class="header-section-number">4.6</span> Synthetic simulation in Shiny</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Autres formats</h2><ul><li><a href="MEAPS aspects theoriques.pdf"><i class="bi bi-file-pdf"></i>PDF (wp)</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
  <div class="quarto-title">
        <h1 class="title">MEAPS: Modelling commuter flows</h1>
        
      </div>

  
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Auteurs</div>
    <div class="quarto-title-meta-heading">Affiliations</div>

      <div class="quarto-title-meta-contents">
      <p class="author">Maxime Parodi <a href="mailto:maxime.parodi@sciencespo.fr" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0009-0008-2543-5234" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="http://www.ofce.fr">
              OFCE, Sciences Po Paris
              </a>
            </p>
        </div>
        <div class="quarto-title-meta-contents">
      <p class="author">Xavier Timbeau <a href="mailto:xavier.timbeau@sciencespo.fr" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-6198-5953" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="http://www.ofce.fr">
              OFCE, Ecole Urbaine, Sciences Po Paris
              </a>
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Publié le</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2 mai 2023</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modifié le</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">31 mars 2024</p>
      </div>
    </div>
    
    
    
      
      <div>
      <div class="keywords">
        <div class="quarto-title-meta-heading">Mots clés</div>
        <p>modèle gravitaire, modèle radiatif, mobilités</p>
      </div>
    </div>
    </div>
    <div class="quarto-title">
    <div class="abstract">
      <div class="quarto-title-meta-heading">Résumé</div>  
      The gravity model used to distribute journeys between an origin and a destination poorly represents the influence of distance on choices. Drawing on <span style="white-space:nowrap">the ‹</span>intervening opportunities› model of <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> and the radiative model of <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>, we construct an ergodic model of absorption with priority and saturation (MEAPS) that makes it possible to construct these choices on clear and flexible microscopic foundations. The model accommodates different formulations of stochastic processes that allow fundamental parameters to be estimated and interpreted. We validate the theoretical model on synthetic data, then in two associated documents <span class="citation" data-cites="meaps2024a meaps2024b">(<a href="#ref-meaps2024a" role="doc-biblioref">Parodi et Timbeau, 2024b</a>, <a href="#ref-meaps2024b" role="doc-biblioref">2024a</a>)</span> We propose an estimate of MEAPS and a detailed comparison with the gravity model and its most common variants. We then use this modelling to construct a high-resolution map of CO<del>2</del> emissions in La Rochelle. <br> 13955 words.
    </div>
  </div>
  </header>


<section id="tobler-does-not-imply-gravity" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="tobler-does-not-imply-gravity"><span class="header-section-number">1</span> Tobler dœs not imply gravity</h2>
<p>In the analysis of spatial phenomena, distance plays an important role. This is sometimes referred to as Tobler’s principle:</p>
<blockquote class="blockquote">
<p>Everything is connected, but things that are close are more connected than things that are far away.</p>
</blockquote>
<p>If we take the example of the geographical matching of jobs and residents, proximity to the job is an inescapable factor, even if other factors come into play in the choice of a job: salary, skills, etc. The role of distance in the choice of a job is generally assessed using a gravity model. The role of distance in job choice is generally assessed using a gravity model. Few alternatives have been studied in the literature, and the gravity model has become a standard, a tool that can be forgotten in favour of taking other factors into account.</p>
<p>However, when we looked at the mobility of daily life on a detailed geographical <span style="white-space:nowrap">scale –</span> the 200 metre <span style="white-space:nowrap">square –</span> we came up against the limitations of the gravity model, particularly when it came to deciding on scenarios for relocating jobs. These limitations stem from the fact that the gravity model reduces Tobler’s principle to a homogeneous measure of distance. It is possible to significantly improve our understanding of territories by shifting from distance to transport times according to the different possible modes. Even more finely, it is possible to move to a notion of the generalised cost of a journey, which takes into account different aspects of that journey (its monetary cost, comfort, reliability, etc.). However, these improvements to <span style="white-space:nowrap">the ‹</span>metric<span style="white-space:nowrap">› –</span> undeniable though they <span style="white-space:nowrap">are –</span> merely change the input to the gravity model, without questioning it. This model suffers from a more fundamental flaw: it evacuates what makes space specific by trying to reduce it to a one-dimensional variable; it evacuates the fact that space is inhabited and that each place is also defined by its neighbourhood.</p>
<p>For example, the gravity model treats dense urban environments and rural areas in the same way. You’d think, for example, that a half-hour car journey would be just as hard for a yellow waistcoat as it is for a Parisian. However, this is clearly not the case: people living in rural areas make virtue out of necessity and even end up enjoying these long daily journeys, whereas people living in highly urbanised areas consider alternatives because they have a wider range of options to satisfy their demands. The flaw in the gravity model here is not simply a matter of subjective relationships to journey times. More fundamentally, the fault lies in the fact that this model dœs not see space; it dœs not see what the territory offers; it dœs not see that in urban areas the offer (of jobs, services, etc.) is more compact and that this changes the way relative distances and relative costs are treated. The consequence of this blindness is that the supply in the area is treated as if it were homogeneous. Suppose, for example, that the public authorities want to create an industrial estate offering new jobs. The gravity model would lead us to believe that residents of rural areas, because they are so scattered, are usually too far from the new employment zone to be interested: in the trade-off between the usefulness of the job and the cost of the journey, the latter quickly becomes so high that it seems preferable to give up the job. However, the real trade-off is far from being so simplistic because, of course, an individual who cannot find a job nearby will resign himself to travelling further to work than someone who lives near a dynamic economic centre. Distance dœs not carry the same weight depending on the amount of supply in the neighbourhood.</p>
<p>Faced with these anomalies linked to the gravity model, we propose to use another analogy: that of a flow of particles passing through a material made up of heterogeneous absorption sites. If someone is looking for a job in an area rich in jobs, the chance of being satisfied near their point of departure will be high, as is the chance of a particle being rapidly absorbed when it is surrounded by absorbing sites. Conversely, if jobs are not very dense where you live, the distance you have to travel is likely to be greater, like a particle crossing an area of vacuum. In fact, the chance of being absorbed dœs not depend directly on the distance to the receiving site; it depends on the number of sites that are crossed before it. Or, to put it another way, it depends on the rank of this site in the ranking of sites from closest to furthest away. This analogy can already be found in <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> and <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>. However, the models they have developed can still be improved, in particular by modelling the fact that absorption sites can have a limited capacity. The neighbourhood then plays a role both in terms of jobs, which are more or less dense around me, and also in terms of competitors for this resource, who are themselves more or less dense around me.</p>
<p>We therefore propose a model that takes account of absorption and saturation. It is stochastic in nature and, using statistical physics reasoning, we can conjecture that the main predictions are stationary. We have called it the Ergodic Absorption and Saturation Model, or MEAPS for short.</p>
<p>This model also respects the principle that what is close <span style="white-space:nowrap">plays –</span> all other things being <span style="white-space:nowrap">equal –</span> a more important role than what is far away. But instead of distance, we use rank in the distance ranking. The difference may seem minor, but it addresses the issue of spatial heterogeneity and the density of the environments crossed. In the gravity model, there always comes a time when, to take yet another example, the school is too far away and it’s no <span style="white-space:nowrap">longer ‹</span>worth› the cost. In the perspective initiated by Stouffer, and taken up again here, the nearest school, that of rank 1, however far away it may be, remains useful precisely because it is the nearest. The remarkable series of documentaries entitled <span style="white-space:nowrap">« </span>Les chemins de l’école<span style="white-space:nowrap"> »</span> underlines perfectly that the nearest school is always worthwhile, even if schoolchildren have to walk several hours to get there.</p>
<p>The analogy used allows us to consider the matching process as the result of a search procedure that examines opportunities in the order of their proximity. Such a procedure makes it possible to specify behaviours that serve as a reference and as a null hypothesis for confronting the data. Marginal amendments to this search procedure could produce a better fit and be interpreted directly. For the time being, we are ignoring all the other determinants of the match, such as salary, skills required or offered, and sector of activity. We fit a reduced model to the distance argument on rich data, taken from the French census and measuring flows between communes of residence and communes of employment. Under the assumption that all jobs differ only in their location, we achieve a much better fit than the gravity model. More refined <span style="white-space:nowrap">data –</span> assuming it <span style="white-space:nowrap">exists –</span> could further improve the fit by introducing wage or skill differentials, for example. However, taking more rigorous account of geography seems to us to be an essential first step, since it modifies the quality of the fit by at least an order of magnitude.</p>
<p>The approach is therefore structural: it is a frustrated model that defines the way in which the data can be interpreted. The data without the model means little, the model without the data is mere speculation, and, following Kant’s injunction, we combine the one with the other to describe reality.</p>
<p>This document describes the construction of the theoretical model. In it we develop our critique of the gravity model <strong>?@sec-theory</strong> the analogy with the radiative model <a href="#sec-meaps" class="quarto-xref">section&nbsp;3</a>. The complete model is not solvable in a closed form. We therefore describe an algorithm for simulating it. In the second part <a href="#sec-synth" class="quarto-xref">section&nbsp;4</a> we analyse the main properties of the theoretical model on synthetic simulations, i.e.&nbsp;generated from known processes. In particular, this allows us to give plausibility, in the absence of a demonstration, to the ergodicity property of the model, which conditions the possibility of simulating it.</p>
<p>In two other papers, we estimate the model on real data and make a detailed comparison with the gravity model and its most common variants (<a href="./larochelle.html">Estimates at La Rochelle</a>). We then use this modelling to discuss the link between density and CO<del>2</del> (<a href="./trajets.html">Compact city</a>). We are building a high-resolution map of CO<del>2</del> emissions in La Rochelle using a projection that incorporates frequency and pattern association behaviour for different household categories.</p>
</section>
<section id="sec-theorie" class="level2 page-columns page-full" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-theorie"><span class="header-section-number">2</span> Gravity modelling</h2>
<p>To model journeys between places of residence and places of employment, we usually use the 4-step method <span class="citation" data-cites="patrickbonnel2001 de2011modelling">(<a href="#ref-de2011modelling" role="doc-biblioref">Dios Ortúzar et Willumsen, 2011</a>&nbsp;; <a href="#ref-patrickbonnel2001" role="doc-biblioref">Patrick Bonnel, 2001</a>)</span>. This method involves firstly determining the number of journeys originating from a place of residence and, secondly, the number of journeys arriving in total at a place of work. This is stage 1 of trip generation. The second stage consists of distributing the journeys from stage 1 between each origin-destination pair. This is the distribution stage. The third stage is the modal choice stage, in which an appropriate mode of transport is associated with each journey. Finally, the fourth stage of the model is the one that specifies the journey and provides information about its precise characteristics, such as the route taken or the gradients travelled, in order to deduce congestion forecasts in particular. This breakdown is somewhat arbitrary and dœs not do justice to the state of the art in terms of best practice for articulating these 4 moments. For example, the number of journeys made depends on the possibilities opened up by geography, which are defined by the precise characteristics of the journeys. Step 4 is therefore necessary to understand step 1, and step 4 requires knowledge of modal choices to be useful for the choices made in step 1. Step 2 is necessary to explore trip possibilities. There are many overlaps between the stages, and the breakdown dœs not preclude going back and forth between the various stages.</p>
<p>The model we are developing relates to stage 2, that of the distribution of journeys between the different origin-destination pairs, or residence-jobs. The gravity model is largely dominant in this second stage to take into account the role of distance in the trade-off between different destinations.</p>
<p>In the first part we discuss the shortcomings of the gravity model <a href="#sec-grav" class="quarto-xref">section&nbsp;2.1</a>. We then present the intervening opportunities model of <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> and the radiative model of <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> and <span class="citation" data-cites="simini2013">Simini, Maritan et Néda (<a href="#ref-simini2013" role="doc-biblioref">2013</a>)</span>. Both models use the job ranking rather than the distance <a href="#sec-rad" class="quarto-xref">section&nbsp;2.2</a> based on an analogy that is more appropriate to the geographical scales we are considering (municipality, region) than that of gravitation. Finally, in line with these approaches, we are developing a model based on the following two ideas:</p>
<ol type="1">
<li><p>Individuals make their trade-offs not as a direct function of distance, but as a function of the rank (in the order of distances) of the opportunities available to them. Another way of looking at it is that the number of jobs available in a circle of given radius is a better metric than distance.</p></li>
<li><p>Each destination has a limited capacity, so we need to introduce a notion of saturation that forces individuals to look elsewhere. In this way, we provide a microscopic basis for respecting the constraints at the margins (every individual has a job, every job is occupied by an individual) and introduce the neighbourhood both at the destination and at the origin.</p></li>
</ol>
<p>The final formulation is probabilistic and we analyse some of its properties using synthetic simulations (<a href="#sec-synth" class="quarto-xref">section&nbsp;4</a>), showing that we can quickly simulate a state that is independent of the initial conditions.</p>
<section id="sec-grav" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-grav"><span class="header-section-number">2.1</span> The inadequacies of the gravity model</h3>
<p>The gravity model develops an analogy with Isaac Newton’s model of universal gravitation, whose successes in physics and mechanics are indisputable. This model is the cornerstone of the path distribution stage <span class="citation" data-cites="sen1995 de2011modelling patrickbonnel2001">(<a href="#ref-de2011modelling" role="doc-biblioref">Dios Ortúzar et Willumsen, 2011</a>&nbsp;; <a href="#ref-patrickbonnel2001" role="doc-biblioref">Patrick Bonnel, 2001, p.&nbsp;160</a>&nbsp;; <a href="#ref-sen1995" role="doc-biblioref">Sen et Smith, 1995</a>)</span>. It is also used in other fields, such as international trade and the analysis of epidemics, which we will not discuss here.</p>
<section id="the-wrong-reasons-for-the-success-of-the-gravity-model" class="level4">
<h4 class="anchored" data-anchor-id="the-wrong-reasons-for-the-success-of-the-gravity-model">The (wrong) reasons for the success of the gravity model</h4>
<p>Formally, the gravity model describes the strength of a relationship between two objects as a function of their respective distance and mass. By analogy, the gravity model consists here of evaluating the number of business trips between two locations by taking as the masses the number of inhabitants at the point of departure and the number of jobs at the point of arrival and, as the denominator, a function of <span class="math inline">f</span>increasing function of distance[^1]. Thus, if we indicate the starting points by<span class="math inline">i</span> and the end points by <span class="math inline">j</span> :</p>
<p>[^1] The distance can be any metric that distinguishes points in space. The Euclidean distance comes to mind, but the model can also be adapted to take into account distances through transport networks, journey times to take account of different speeds by mode, by type of road used, by time of day, or to compare modes for which distance is of little significance (public transport, because of waiting times and specific lanes). We can also consider a full cost (including both the time and monetary cost of the mode of transport) or a generalised cost including the perceived comfort or safety associated with the mode of transport. Following <span class="citation" data-cites="koenig1980">Koenig (<a href="#ref-koenig1980" role="doc-biblioref">1980</a>)</span>, we can use logsum to take into account the variety of solutions for getting to a destination.</p>
<p><span id="eq-gravity"><span class="math display">
T_{i,j} = \frac {N_{hab, i}\times N_{emp, j}} {f(d_{i,j})}
\tag{1}</span></span></p>
<p>The first gravity models borrowed the function <span class="math inline">f</span> function from Newtonian physics (<span class="math inline">f=d^2</span>), but other formulations have since been proposed. For example, the function <span class="math inline">f=e^{d/\delta}</span>function is used in the discrete choice models proposed by McFadden <span class="citation" data-cites="mcfadden1974d">(<a href="#ref-ben" role="doc-biblioref"><strong>ben?</strong></a>)</span>. By replacing distance with the notion of generalised transport cost, this functional form can be linked to a choice model with a random utility function (<em>random utility model</em>). It is also possible to adjust more complex functional forms by adding parameters. The gravity model can then more or less reproduce the distance distributions observed in mobility surveys.</p>
<p>Entropy minimisation reasoning was proposed by <span class="citation" data-cites="wilson1967">Wilson (<a href="#ref-wilson1967" role="doc-biblioref">1967</a>)</span> to provide a theoretical basis for <a href="#eq-gravity" class="quarto-xref">équation&nbsp;1</a>. He considers the reference state to be that which is most frequent in a random distribution of choices. <span class="citation" data-cites="wilson1967">Wilson (<a href="#ref-wilson1967" role="doc-biblioref">1967</a>)</span> then shows that, if the function <span class="math inline">f</span> is given, <a href="#eq-gravity" class="quarto-xref">équation&nbsp;1</a> has the proposed form and that it is the product of inhabitants and jobs that must be in the numerator (and not a power of one or the other, for example). But there is nothing to support the functional form of <span class="math inline">f</span>. The parallel with physics is easy to draw: interaction defines the role of distance, maximisation of entropy allows us to deduce that the macroscopic equation depends on the aggregate masses, but dœs not allow us to say anything more about the nature of the interaction.</p>
<p>As <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> notes, the theoretical and empirical foundations of the <span class="math inline">f</span> function are weak at best. The multiplication of parameters to improve the fit often has no theoretical justification. In fact, it is often impossible to give any meaning to the estimated parameters, which makes the adjustment exercise opaque. The asymptotic behaviours also highlight inconsistencies: for example, by making the number of jobs at the point of arrival tend towards infinity, the model predicts an infinite number of journeys, even though the number of residents at the point of departure is limited! It is also unsatisfactory that the gravity model is deterministic and dœs not explain the statistical fluctuations in the number of predicted journeys, nor dœs it assess the likelihood of different empirical cases.</p>
<p>But the strongest criticism of the gravity model comes from its fundamental properties and the conclusions that can be drawn from them. The number of journeys between an origin (residence) and a destination (employment) is based on a simple trade-off between distance and the number of residents or jobs. Once again, the behaviour of the model at the limits is perplexing: a single job at the origin should be infinitely preferred to a very large number of jobs a little further away. This is completely unrealistic, and we can already guess that distance dœs not play such a direct role in mobility behaviour. We can also see that the relative weight of this quasi-central job in relation to the <span style="white-space:nowrap">« </span>masses<span style="white-space:nowrap"> »</span> of distant jobs will vary unrealistically depending on how close it is to the origin.</p>
<p>As <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> already pointed out, it is perhaps not so much the distance to jobs that is decisive as the rank of these jobs in the order of distances. In the gravity model, there is a big difference between the case where the second nearest job is 500 m away and the case where it is 1 km away. If we apply the Newtonian model, we would have to believe, for example, that the attractiveness of the latter job is divided by 4. Who can believe that a 500 m difference is such a significant factor in a job search? The attractiveness of the job depends above all on the fact that it is the second job available close to home. Empirically, there is little doubt that the gravity model performs poorly: it fails to explain why, when the density of jobs is low around a resident, he or she will envisage longer journeys to reach areas with a high density of jobs; yet this is a very common observation that should be reflected in adequate modelling.</p>
<p><span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> give a few examples for the United States of the difficulty of the gravity model in reproducing observed behaviour by stylising a few regularities. Clearly, the gravity model only predicts nearby destinations and completely ignores distant destinations. It seems impossible for the functional form <span class="math inline">f(d_{ij})</span> to empirically account for both the number of short journeys and the number of long-distance journeys using a model that can account for journeys in different regions, given that densities are distributed differently.</p>
<p>There are relatively few publications that systematically compare the gravity model with other formulations that respect Tobler’s first law. <span class="citation" data-cites="heanue1966">Heanue et Pyers (<a href="#ref-heanue1966" role="doc-biblioref">1966</a>)</span> is one of the first attempts of this kind. Recent work by <span class="citation" data-cites="lenormand2016 jean-michelfloch2019">Commenges (<a href="#ref-commenges2016" role="doc-biblioref">2016</a>)</span> confirm what <span class="citation" data-cites="masucci2013">Masucci <em>et al.</em> (<a href="#ref-masucci2013" role="doc-biblioref">2013</a>)</span> concluded after the initial publication of the radiative model: the extended gravity model would have better explanatory power with regard to inter-communal mobility flows, this constant holding for many zones considered in several countries. The usual extension of the gravity model is to write, where<span class="math inline">c</span>, <span class="math inline">\alpha</span>, <span class="math inline">\beta</span> and <span class="math inline">\delta</span> are positive parameters:</p>
<p><span id="eq-grave"><span class="math display">
T_{i,j} = c \frac {N_{hab, i}^\alpha \times N_{emp, j}^\beta} {d_{i,j}^\delta}
\tag{2}</span></span></p>
<p>Estimated parameters <span class="math inline">\alpha</span> and <span class="math inline">\beta</span> are usually less than 1, which relates to a problem raised by <span class="citation" data-cites="simini2013">Simini, Maritan et Néda (<a href="#ref-simini2013" role="doc-biblioref">2013</a>)</span>: in this form the gravity model is non-separable. If we consider an area in which there are assets (origin) or jobs (destination) and we decide to separate it into two distinct areas 1 and 2 as close as possible, the flows <span class="math inline">T_1</span> and <span class="math inline">T_2</span> predicted by the estimated form of <a href="#eq-grave" class="quarto-xref">équation&nbsp;2</a> are not the sum of the flow that would be obtained from the two zones combined. The reason for the separation is that the spatial unit of aggregation (<em>Modifiable Areal Unit Problem</em>) or by distinguishing sub-populations (e.g.&nbsp;by sector, by household category) within the initial zone. This more detailed description can be achieved with different flow behaviours (which justifies the distinction), but in the limited case where these populations cannot be distinguished, there is no reason to expect different behaviours.</p>
<p>The separability property at both origin and destination is verified for the radiative model. As <span class="citation" data-cites="simini2013">Simini, Maritan et Néda (<a href="#ref-simini2013" role="doc-biblioref">2013</a>)</span> suggest, the parameters <span class="math inline">\alpha</span> and <span class="math inline">\beta</span> of the gravity model can be explained through the radiative model (see below). They summarise the additional spatial information, and depend on the joint spatial distribution of masses at origins and destinations. However, these two parameters are highly dependent on the spatial structure, the unit division and the sub-perimeters considered. In this sense, we return to <span class="citation" data-cites="fotheringham1983">Fotheringham (<a href="#ref-fotheringham1983" role="doc-biblioref">1983</a>)</span>’s analysis that the gravity model lacks essential spatial information about neighbourhoods.</p>
</section>
<section id="sec-voilemarge" class="level4">
<h4 class="anchored" data-anchor-id="sec-voilemarge">The veil of constraint at the margins</h4>
<p>The gravity model can be made even more complex to fit the data better than it spontaneously dœs. It then loses a clear link with the theoretical reflections linking it to the maximisation of entropy. <span class="citation" data-cites="wilson1967">(<a href="#ref-wilson1967" role="doc-biblioref">Wilson, 1967</a>)</span> or the discrete choice model. The adjustment of the model becomes a dummy exercise in which it is difficult to have confidence, particularly in the analysis of the scenarios modelled. The exercise consists of adding a <span style="white-space:nowrap">« </span>normalisation<span style="white-space:nowrap"> »</span> step by incorporating corrective cœfficients in the rows and columns of the origin-destination matrix, which amounts to adding fixed effects to each of the departure and arrival points. The formulation of the gravity model is then modified as follows:</p>
<p><span id="eq-gravmod"><span class="math display">
T_{i,j} = a_i \times b_j \times \frac {N_{hab, i}^\alpha \times N_{emp, j}^\beta} {f(d_{i,j})}
\tag{3}</span></span></p>
<p>Determining the cœfficients <span class="math inline">a_i</span> and <span class="math inline">b_j</span> cœfficients poses a number of problems. These cœfficients must make it possible to respect the constraints at the margins: the sum of jobs for a row of residents must be equal to the number of residents employed in the zone and the sum of residents employed at a place of employment must, in column form, be equal to the number of jobs at that place. For <span class="math inline">a_i</span> (en remarquant que <span class="math inline">\Sigma_j T_{ij} = N_{hab,i}</span> and <span class="math inline">\Sigma_i T_{ij} = N_{emp,j}</span> :</p>
<p><span id="eq-ai"><span class="math display">
\begin{aligned}
a_i &amp;{}= \frac {\Sigma_j T_{i,j}} {\Sigma_j \frac {b_j \times N_{hab, i}^\alpha \times N_{emp, j}^\beta}{f(d_{i,j})}} \
&amp;{}= \frac{N_{hab}^{1-\alpha}} {\Sigma_j \frac{ b_j \times N_{emp,j}^\beta}{f(d_{i,j})}}
\end{aligned}
\tag{4}</span></span></p>
<p><span class="math inline">\Sigma_j T_{i,j}</span> is generally directly observed or estimated during the generation stage in so-called 4-stage approaches. It is the number of departures from the <span class="math inline">i</span> point and is proportional to the number of working people residing in <span class="math inline">i</span>. In the same way, for <span class="math inline">b_j</span> a symmetrical expression to that of <span class="math inline">a_i</span> which involves <span class="math inline">\Sigma_i T_{i,j}</span> which is also observed or estimated beforehand. This is the number of journeys converging on the arrival point <span class="math inline">j</span> which is proportional to the number of jobs in <span class="math inline">j</span>.</p>
<p><span id="eq-bj"><span class="math display">
\begin{aligned}
b_j &amp;{}= \frac {\Sigma_i T_{i,j}}
{\Sigma_i \frac {a_i \times N_{hab, i}^\alpha \times N_{emp, j}^\beta} {f(d_{i,j})}} \
&amp;{}= \frac{N_{emp, j}^{1-\beta}}{\Sigma_i \frac{a_i \times N_{hab,i}^{\alpha}}{f(d_{i,j})}}
\end{aligned}
\tag{5}</span></span></p>
<p>The value of <span class="math inline">a_i</span> for a <span class="math inline">i</span> depends on the evaluation of all the <span class="math inline">b_j</span> and conversely the evaluation of each <span class="math inline">b_j</span> depends on that of all the <span class="math inline">a_i</span>. We can estimate these cœfficients by successive iterations and hope in this way to reach a fixed point, possibly unique to within a multiplicative constant. Solving algorithms have therefore been proposed in the main textbooks. The application of such algorithms (such as Furness’ <span class="citation" data-cites="de2011modelling">Dios Ortúzar et Willumsen (<a href="#ref-de2011modelling" role="doc-biblioref">2011</a>)</span>, p.&nbsp;192) modifies the result proposed by the expression of the <a href="#eq-grave" class="quarto-xref">équation&nbsp;2</a> gravity model, at the risk of betraying its logic and initial justifications. Indeed, the <span class="math inline">a_i</span> and <span class="math inline">b_j</span> are modifiers of the masses of assets and jobs. To make the gravity model work, you have <span style="white-space:nowrap">to ‹</span>cheat› on the masses. Furthermore, the multiplicity of solutions and the choice made by the algorithm remain a blind spot in these methods.</p>
<p>The procedure for respecting the margins could have been formulated differently, for example by using additive corrections instead of multiplicative corrections or a combination of additivity and multiplicativity. In any case, there is no guarantee that there is a single, understandable solution. In general, these procedures can lead to multiple equilibria that the solution algorithm will select without any justification whatsœver. Above all, however, each of these procedures lacks theoretical foundations. <span class="math inline">a_i</span> and <span class="math inline">b_j</span> are never more than <span style="white-space:nowrap">« </span>patches<span style="white-space:nowrap"> »</span>; they do not correspond to any interpretable characteristic of the geographical area studied.</p>
<p>Compliance with the margin constraint is the global counterpart of the local separability constraint. These two properties illustrate the inability of the simple gravity model to respect the fundamental aspects of the problem. The <span style="white-space:nowrap">operational ‹</span>plasticity› of the gravity model means that it can be applied to observations while respecting the observed constraints, while allowing us to believe that a theoretical foundation continues to justify the operations. As a result, the gravity approach is widely used in applied models (notably the <em>Land Use Transport Interaction</em>) despite its major shortcomings, perhaps for want of anything better. But the gap with the data makes it urgent to move beyond this approach, which survives by becoming a black box.</p>
</section>
</section>
<section id="sec-rad" class="level3 page-columns page-full" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-rad"><span class="header-section-number">2.2</span> A first alternative: the radiative model</h3>
<p>The radiative model is one of the few alternatives to the gravity model <span class="citation" data-cites="de2011modelling">(<a href="#ref-de2011modelling" role="doc-biblioref">Dios Ortúzar et Willumsen, 2011</a>)</span>. It takes up the intuitions of <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> and the <span style="white-space:nowrap">« </span><em>intervening opportunities</em><span style="white-space:nowrap"> »</span>The logic behind this is as follows: a migrant plans to go to a distant place but finds opportunities along the way. This distraction from their initial objective is the result of <span style="white-space:nowrap">« </span>intervening<span style="white-space:nowrap"> »</span> opportunities encountered along the way. The difference with the gravity model is that it is not distance that determines the destination, but the number of encounters. Distance and geographical structure continue to have an indirect influence on the choice of destination, since the greater the distance travelled by the migrant, the greater the chance of encountering opportunities. However, Stouffer’s initial model suffers from a number of shortcomings<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> and dœs not resolve the issues of capacity or compliance with constraints on margins. But it dœs open up another perspective, where the role of distance is mediated by the number of opportunities encountered, which elegantly addresses the shortcomings of the gravity analogy.</p>
<div class="no-row-height column-margin column-container"><p><sup>1</sup>&nbsp;In particular, there are flaws in the formalisation, which is based on a series of approximations that are not always made explicit, making the model difficult to manipulate.</p></div><p>With Stouffer, another metric is proposed in place of the simple spatial distance. It is linked to the notion of accessibility[^3] i.e.&nbsp;the number of jobs (and more generally opportunities) to which an individual has access for a given maximum travel time or distance. The closer a job is to an individual, the further away it is from him or her. The gravity model assumed that individuals make a big difference between the case where the second available job is 500 m away and the case where this job is 1 km away. In the new perspective, there is no difference because it is always the second job encountered. In other words, distance is put into perspective by taking into account the environment that is crossed. The richer the environment in terms of opportunities, the less necessary it is to go far, and conversely, the more deserted the environment, the further you have to go. This model has had many applications, notably in Chicago <span class="citation" data-cites="ruiter1967">(<a href="#ref-ruiter1967" role="doc-biblioref">Ruiter, 1967</a>)</span>.</p>
<p>[^3] The concept of accessibility was probably introduced by <span class="citation" data-cites="hansen1959">Hansen (<a href="#ref-hansen1959" role="doc-biblioref">1959</a>)</span>. <span class="citation" data-cites="pirie1979">Pirie (<a href="#ref-pirie1979" role="doc-biblioref">1979</a>)</span> provides a review of the literature. G. Kœning <span class="citation" data-cites="koenig1974 koenig1980">(<a href="#ref-koenig1974" role="doc-biblioref">Koenig, 1974</a>, <a href="#ref-koenig1980" role="doc-biblioref">1980</a>)</span> developed it theoretically and applied it to France. <span class="citation" data-cites="jeanpoulit2005">Poulit (<a href="#ref-jeanpoulit2005" role="doc-biblioref">2005</a>)</span> gives a fascinating account of how it was applied by the Ponts et Chaussées civil engineering body in France from the 1970s to the 1990s.</p>
<p>The <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> proposal addresses some of the shortcomings of <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> by proposing a model inspired by radiation physics. This describes the emission of particles and their absorption by the medium through which they pass. The intuition is the same as that of <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span>: as long as a particle dœs not encounter an obstacle, it continues on its way. It only stops when it encounters a site that can absorb it, according to a certain probability. The more obstacles there are in the environment, the more likely the particle is to stop. In this model, the distribution of distances travelled depends on the medium and the number of absorption sites encountered.</p>
<p>More precisely, in the radiation model, each <span style="white-space:nowrap">particle –</span> or <span style="white-space:nowrap">individual –</span> is drawn at random from a probability distribution with a characteristic <span class="math inline">z</span>. Each absorption point, which represents a possible place of work, has a mass of employment <span class="math inline">n_i</span> and is assigned a characteristic <span class="math inline">z_i</span> which is random. The possible locations are ordered by distance, as in <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span>’s model, and the particle encounters them in that order. The draw of <span class="math inline">z_i</span> is constructed by drawing <span class="math inline">n_i</span> times from <span class="math inline">z</span> in the probability distribution and taking the maximum of these <span class="math inline">z</span>. The greater the mass in <span class="math inline">i</span> the greater the <span class="math inline">z_{max}</span> will be greater. The emitted particle is absorbed if its <span class="math inline">z</span> is smaller than <span class="math inline">z_i</span>. To represent that the particle will be emitted if it is not absorbed by its starting point, its own <span class="math inline">z</span> is drawn by the same method, i.e.&nbsp;the maximum of <span class="math inline">m_i</span> draws where <span class="math inline">m_i</span> is the number of opportunities in <span class="math inline">i</span>.</p>
<p>The main result of <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> is particularly elegant. The average value (noted <span class="math inline">\langle T_{i,j}\rangle</span> ) of routes starting from <span class="math inline">i</span> and going to <span class="math inline">j</span> has an expression that dœs not depend on the probability distribution of the <span class="math inline">z</span>. It takes the following expression, where <span class="math inline">s_{i,j}=\Sigma_{k \in (i \rightarrow j)^*} n_k</span> is the sum of the opportunities between <span class="math inline">i</span> (not included) and <span class="math inline">j</span> (not included):</p>
<p><span id="eq-rad"><span class="math display">
\langle T_{i,j}\rangle = T_i \times \frac {m_i \times n_j}{(m_i + s_{i,j}) \times (m_i + n_i +s_{i,j})}
\tag{6}</span></span></p>
<p>Based on fairly simple general assumptions, we obtain a formulation that is similar to that of the gravity model, replacing distance by the accumulation of opportunities between two points, as long as the opportunities are ranked in order of distance. This formulation respects Tobler’s first principle as much as the gravity model, but it is based on explicit hypotheses and provides a better representation of the phenomena already mentioned. A departure from a sparsely populated area will produce longer journeys in order to find an equivalent number of opportunities to shorter journeys in a densely populated area. In addition, there is no <span style="white-space:nowrap">« </span>normalisation<span style="white-space:nowrap"> »</span> stage. <em>ad hoc</em> is required and the model is probabilistic, which means that margins of error and empirical tests can be produced.</p>
<p>Applications of the radiative model to a variety of data (work-home commuting, telephone calls, migration, logistics) produce path distributions that are closer to the data than the gravity model, challenging the belief that the gravity model is <span style="white-space:nowrap">a ‹</span>good› model, validated by the data.</p>
<p>Note that the <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> model admits the gravity model as a limiting case, under certain assumptions about job density. Indeed, when job density is uniform, the accumulation of opportunities is proportional to surface area and the average number of journeys between <span class="math inline">i</span> and <span class="math inline">j</span> is a function of <span class="math inline">1/r^4</span> (see also <span class="citation" data-cites="ruiter1967">Ruiter (<a href="#ref-ruiter1967" role="doc-biblioref">1967</a>)</span>). This limiting case shows under which (very particular) condition the gravity model can be valid. This limiting case also shows that the functional form used in the gravity model depends strongly on the distribution of the density of opportunities, i.e.&nbsp;the effects of the neighbourhood. And this is one of the elements missing from the gravity model.</p>
<div id="tip-fother" class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Encadré</strong>&nbsp;1<strong>.</strong> Fotheringham’s competing opportunities model
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The competing opportunities model of <span class="citation" data-cites="fotheringham1983">Fotheringham (<a href="#ref-fotheringham1983" role="doc-biblioref">1983</a>)</span> leads to a criticism close to that of the gravity model. The argument is that the gravity model cannot distinguish between different spatial configurations, except when it is constrained in rows (each individual occupies one and only one job) or in rows and columns (each job is occupied by one and only one individual). Fotheringham <span class="citation" data-cites="fotheringham1983">Fotheringham (<a href="#ref-fotheringham1984" role="doc-biblioref">1984</a>)</span> concludes that the usual estimation of the gravity model is biased by an omitted variable that represents spatial structure. The competing opportunities model is based on an accessibility index (different from the one we will use next) which measures for each individual and each opportunity<span class="math inline">j</span> how accessible it is to other individuals (<span class="math inline">k \neq i</span>) by the expression <span class="math inline">A_{ij}=\sum_{p \neq i,j}M_p/d_{pj}</span>. This term introduces the spatial structure, because an opportunity surrounded by individuals has a higher accessibility index. It follows from the interpretation of the constraint procedure of the gravity model. Added to the gravity model with a parameter ( <span class="math inline">f_{ij} = I_i M_j^\beta d_{ij}^\delta A_{ij}^\phi \mu_{ij}</span> where <span class="math inline">I_i</span> is the number of individuals at the origin, <span class="math inline">M_j</span> the attraction of the destination, <span class="math inline">d_{ij}</span> the distance between <span class="math inline">i</span> and <span class="math inline">j</span> and <span class="math inline">\mu_{ij}</span> is noise) it allows the structure to be introduced explicitly into the gravity model without involving it in a second step when the single or double constraint is applied. Fotheringham interprets the parameter <span class="math inline">\phi</span> parameter as indicating either agglomeration effects (<span class="math inline">\phi&gt;0</span>) or competition effects between attraction sites (<span class="math inline">\phi&lt;0</span>). Note that this approach dœs not guarantee separability or compliance with row or column constraints.</p>
<p><span class="citation" data-cites="fik1990">(<a href="#ref-fik1990" role="doc-biblioref">Fik et Mulligan, 1990</a>)</span> integrate the model of intervening opportunities to propose a richer version that takes structure into account. Although the shortcomings of the gravity model are the same, and although the analysis proposed by Fotheringham is particularly enlightening in terms of the omitted variable bias, we will see that our proposal, in line with <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>, differs from these in that it makes explicit the way in which spatial structure is taken into account, which also allows greater precision in the articulation of agglomeration, competition or saturation issues.</p>
</div>
</div>
</div>
<p>There are still two flaws in <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>‹s radiative model. The first is the counterpart of its elegance: there are no parameters to adjust it, which limits the model’s ability to account for the richness of the data. The elegant calculation of trip averages is only valid when the underlying process perfectly follows the authors› hypothesis. However, if we want a basic model that is simple and conceptually clear, we also want to be able to enrich the model with parameters that would make sense in the light of the richness of the data. The only proposal they make in this respect is to introduce a <span class="math inline">\varepsilon</span> to modify the weight of the starting point in the choice of routes. This is only a very partial response to what we would like to see. In this respect, the gravity model and even more so the Fotheringham model (see box) are richly endowed with parameters, which makes it possible to adjust them to the data, at the risk, however, of a bias linked to the poor definition of the model’s parameters, which <span style="white-space:nowrap">can ‹</span>catch› everything that has not been explained.</p>
<p>The second flaw is that the model dœs not respect the constraints on the margins for destinations. In <a href="#eq-rad" class="quarto-xref">équation&nbsp;6</a> the term <span class="math inline">T_i</span> term is used to adjust the model to the number of departures from <span class="math inline">i</span>. On the other hand, there is no counterpart for calibrating on the destinations. <span class="math inline">j</span> and it is therefore not possible for the model to take account of a capacity constraint: a number of particles greater than the number of jobs can be absorbed in <span class="math inline">j</span>. Here again, the gravity model can overcome this problem by applying constraint procedures, which could also be applied to the <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> model. But here again we lose the possibility of interpreting what this constraint procedure produces.</p>
</section>
</section>
<section id="sec-meaps" class="level2 page-columns page-full" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-meaps"><span class="header-section-number">3</span> MEAPS: an Ergodic Absorption Model with Priority and Saturation</h2>
<p>We now propose an extended and reworked version of <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> ’s approach that addresses our criticisms of <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>’s model. In this section, we present the model in its simplest form before outlining its most direct extensions. Synthetic simulations <a href="#sec-synth" class="quarto-xref">section&nbsp;4</a> allow us to appreciate the broad outlines of how this model works. We then discuss possible estimation procedures and the development of measurements based on this model.</p>
<section id="ranking-destination-choice-and-absorption" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="ranking-destination-choice-and-absorption"><span class="header-section-number">3.1</span> Ranking, destination choice and absorption</h3>
<p>We consider <span class="math inline">I</span> individuals and <span class="math inline">J</span>jobs[^4] located in an area. These locations are fixed and exogenous, which means that we are not interested in the problem of location choice. Not that this choice is not important, but we are interested in the distribution of journeys, once the locations have been fixed. The idea is that to determine the choice of location, we need to take into account what the distribution of paths, their length or their generalised cost tells us.</p>
<p>[^4] In what follows, we look at the relationship between residents and employment, which suggests home-work mobility. This is mainly to fix ideas, but the relationship between residents and any type of amenity can be approached in the same way. It is also possible to classify residents according to observable characteristics and to index the model by these categories.</p>
<p>It is assumed that all locations are separate and that there is therefore only one individual or one job per location (jobs and individuals can be in the same place). Each individual <span class="math inline">i</span> ranks the <span class="math inline">J</span> jobs and examines them in this order. He has a probability <span class="math inline">p_a</span> of taking a job (all the jobs are similar and have the same probability of being taken). As long as no jobs are taken, the individual continues his search by moving on to the next closest job (to his starting point). The probability of taking the job <span class="math inline">j</span> is therefore equal to the probability of not taking the nearest jobs multiplied by the probability of taking the next nearest job. <span class="math inline">p_a</span> of holding the job <span class="math inline">j</span>. Noting <span class="math inline">r_{i}(j)</span> the rank of the job <span class="math inline">j</span> in the ranking of distances since <span class="math inline">i</span> we can write <span class="math inline">\bar F(j)</span> the probability of overtaking the <span class="math inline">j^{ème}</span> <span style="white-space:nowrap">element :</span></p>
<p><span id="eq-fbar"><span class="math display">
\bar F(j)=(1-p_a)^{r_i(j)}
\tag{7}</span></span></p>
<p>We also define the probability of fleeing the zone in question. This is the probability that an individual will not find one of the <span class="math inline">J</span> jobs that are suitable for them, so they give up or look further afield. Assuming for the moment that this probability is the same for all individuals, <span class="math inline">p_f</span> we can determine <span class="math inline">p_a</span> :</p>
<p><span id="eq-pa"><span class="math display">
p_a = 1-(p_f)^{1/J}
\tag{8}</span></span></p>
<p>The probability <span class="math inline">P_i(j)</span> of <span class="math inline">i</span> of stopping in <span class="math inline">j</span> <span style="white-space:nowrap">is :</span></p>
<p><span id="eq-pij"><span class="math display">
P_i(j) = (1-p_a)^{r_i(j)-1} \times p_a = {p_f}^{\frac {r_i(j)-1} {J}} \times (1-{p_f}^{1/J})
\tag{9}</span></span></p>
<p>This expression therefore defines the probability of an individual <span class="math inline">i</span> to hold the job <span class="math inline">j</span> as a function of the escape probability, the job rank and the total number of jobs. The rank of <span class="math inline">j</span> is simply the number of cumulative opportunities from the starting point of <span class="math inline">i</span> to <span class="math inline">j</span> and replaces the distance, as in the expressions of <span class="citation" data-cites="stouffer1940">Stouffer (<a href="#ref-stouffer1940" role="doc-biblioref">1940</a>)</span> or <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>. This number is none other than the individual’s job accessibility <span class="math inline">i</span> in a circle of radius <span class="math inline">[ij]</span> whether this radius is defined using a Euclidean distance or other measures such as travel time. Note that it is assumed here that the jobs are identical or, at least, perfectly substitutable for the individual.</p>
<p>Each job has been assumed to be spatially distinct from the others. In the case where jobs are not separated and could accumulate at a point or within a tile, the formalisation dœs not change - this is the separability property mentioned above. The probability of stopping in the tile <span class="math inline">c_d</span> at a distance of <span class="math inline">d</span> from <span class="math inline">i</span> where <span class="math inline">k</span> jobs can be deduced from <a href="#eq-fbar" class="quarto-xref">équation&nbsp;7</a> since the <span class="math inline">k</span> jobs have successive ranks. By noting <span class="math inline">s_i(d)=\sum _{j/d_{i,j}&lt;d}1</span> the accumulation (i.e.&nbsp;the accessibility) of all the jobs that are at a distance strictly less than that of the tile under consideration for <span class="math inline">i</span> (and therefore excluding <span class="math inline">k</span> jobs on the tile <span class="math inline">c_d</span>), we <span style="white-space:nowrap">have :</span></p>
<p><span id="eq-picd"><span class="math display">
P_i(i\in c_d) = {p_f}^{s_i(d)/J}\times(1-{p_f}^{ k/J})
\tag{10}</span></span></p>
<p>By taking a limited expansion of this expression to the 1st order (under the hypothesis that <span class="math inline">k</span> is small compared with the total number of opportunities <span class="math inline">J</span>) we obtain, noting <span class="math inline">\\mu=\\frac{-log(p_f)}{J}</span> :</p>
<p><span id="eq-picddl"><span class="math display">
P_i(i\in c_d) \approx k\times \mu \times e^{-\mu \times s_i(d)}
\tag{11}</span></span></p>
<p>This expression clearly reveals the core of the model. The proportion of jobs coming from <span class="math inline">i</span> in the tile is a function of the jobs in the tile multiplied by the accessibility to that tile of <span class="math inline">i</span>.</p>
<p>When the density of jobs is constant on a plane, <span class="math inline">s_i(d)</span> is proportional to the area and the model becomes a function of distance with a term in <span class="math inline">e^{-r^2/\rho^2}</span>. Here again, the behaviour of our model, under this very specific condition of a homogeneous distribution of opportunities, is similar to that proposed for a gravity model, when the latter is specified with a distance function in <span class="math inline">e^{r/\rho}</span>. The preferred form of the gravity model would be justified for a homogeneous distribution of opportunities along a straight line[^5]. This result differs from that of <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span>, who found asymptotic behaviour in<span class="math inline">1/r^4</span>.</p>
<p>[^5] The literature on international trade makes extensive use of the gravity model, and there are some very rich developments. The problem of international trade is a little different from that of the analysis of displacement distributions because we observe bilateral flows by product repeatedly between countries. We therefore have a large amount of information to link together using the gravity representation. The transport issue is different in that the distance between origin and destination is well known, but the bilateral routes are not. On the other hand, we do have information on the distribution of journeys according to distance, purpose and mode.</p>
<p>As in the <span class="citation" data-cites="simini2012">Simini <em>et al.</em> (<a href="#ref-simini2012" role="doc-biblioref">2012</a>)</span> model, the result is parameter-free, because the probability of escape is entirely determined by the online constraint (the individual <span class="math inline">i</span> has an expectation equal to 1 - <span class="math inline">p_f</span> to find a job in the zone under consideration).</p>
</section>
<section id="sec-priorite" class="level3 page-columns page-full" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="sec-priorite"><span class="header-section-number">3.2</span> Saturation and priority</h3>
<p>We still have to take into account the column constraint, i.e.&nbsp;the fact that each job can be filled once and only once. Instead of an adjustment <em>ad hoc</em> adjustment that comes out of nowhere, we propose the following job-filling mechanism: each individual <span class="math inline">i</span> is ranked in order of priority. The first-ranked individual is confronted with all the jobs and we calculate his or her probability of taking a job <span class="math inline">j</span>using the previous formula (<a href="#eq-pij" class="quarto-xref">équation&nbsp;9</a>). The jobs are then partially filled in proportion to these probabilities[^6]. The second individual is treated in the same way, and so on, until one or more jobs are completely filled (when the sum of the probabilities just exceeds 1). These jobs are then removed from the list of possible choices and the assignment continues for the next individuals on the reduced list. Each time an individual is added, other jobs may be removed from the search list.</p>
<p>[^6] In all rigour, probabilities do not add up so simply and an exact treatment would require taking into account probabilities conditional on whether or not a particular job had been taken previously. The procedure described here is a simplification, substituting expectations for conditional probabilities.</p>
<p>At the end of this process, all individuals have jobs (at <span class="math inline">p_f</span> nearly) and all jobs are filled as soon as we ask <span class="math inline">I \times (1 - p_f) = J</span>. This allocation with priority is Pareto-optimal. It is not possible to increase the satisfaction of one individual without reducing that of another. At each stage, each individual makes his choices without any constraint other than the possible saturation caused by his predecessors. To increase his satisfaction, i.e.&nbsp;to allow him to occupy in probability a job better classified for him, it would be necessary to degrade the situation of a predecessor by allocating a job further away for him. This assignment procedure favours those at the top of the ranking, but takes account of individual choices.</p>
<p>Formally, we note <span class="math inline">\phi_u(i,j)</span> the probability of availability (<span class="math inline">\phi</span> is 0 if the job is completely taken) of the job <span class="math inline">j</span> for a given order of priority <span class="math inline">u</span> at the time the individual <span class="math inline">i</span> has to choose. The probability of this individual <span class="math inline">i</span> of taking the job <span class="math inline">j</span> can then be written <span style="white-space:nowrap">as :</span></p>
<p><span id="eq-puij"><span class="math display">
P_{u, i}(j) = \lambda_{u,i}.\phi_u(i,j). p_a \prod_{l=1}^{r_i(j)-1}(1-\lambda_{u,i}. \phi_u(i,r^{-1}(l)).p_a)
\tag{12}</span></span></p>
<p>This expression is complicated by the need to go through the jobs in the order that corresponds to each individual. The probability <span class="math inline">p_a</span> must then be calculated so that the leakage rate of <span class="math inline">i</span> remains unchanged. It is assumed that the remaining jobs remain perfectly substitutable throughout the assignment process. The probability of each is therefore identical and adjusted by a multiplicative factor <span class="math inline">\lambda_{u,i}</span>. The term <span class="math inline">\lambda_{u,i}</span> term thus derives from the potential unavailability of jobs. When a job is unavailable, the individual <span class="math inline">i</span> when it is his turn to choose, knows his potential targets. He therefore adjusts his probability of absorption so as to respect the probability of flight. This is how we respect the online constraint, which is expressed by <a href="#eq-lambda" class="quarto-xref">équation&nbsp;13</a> below. This means that an individual is all the more likely to accept a job if there are few choices left.</p>
<p>Another solution would be to consider that the probability of flight is not preserved and that unavailability results in higher flight. More complex solutions are also possible. For the time being, we will confine ourselves to the simple case where all individuals have the same chance of working in the zone under consideration.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Under this assumption of conservation of the probability of leakage, we <span style="white-space:nowrap">have :</span></p>
<div class="no-row-height column-margin column-container"><p><sup>2</sup>&nbsp;In practice, to avoid side effects, you need to choose an employment zone that is larger than the resident zone.</p></div><p><span id="eq-lambda"><span class="math display">
\forall i, \prod_{j=1} ^{J} (1-\lambda_{u,i} \times \phi_u(i,j) \times p_{a})= p_f
\tag{13}</span></span></p>
<p>The solution to this equation is that of a polynomial in <span class="math inline">\lambda_{u,i}</span> of high order. There may be several solutions, but it is necessary that <span class="math inline">0&lt;\lambda_{u,i}\times p_a&lt;1</span> which reduces the number of admissible solutions. For a <span class="math inline">i</span> we can produce an approximate solution by a development limited to order 1 by taking the <span class="math inline">log</span> of <a href="#eq-lambda" class="quarto-xref">équation&nbsp;13</a> :</p>
<p><span id="eq-lambdadl"><span class="math display">
p_{a} \times \lambda_{u,i} = \frac {-log(p_f)}{\sum_{j=1} ^{J} \phi_u(i,j)}
\tag{14}</span></span></p>
<p>We can check that <span class="math inline">0&lt;\lambda_{u,i}\times p_a&lt;1</span> when <span class="math inline">J</span> is large enough and the number of jobs remaining remains high (in probability) compared to <span class="math inline">-log(p_f)</span>.</p>
</section>
<section id="sec-erg" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="sec-erg"><span class="header-section-number">3.3</span> Ergodicity</h3>
<p>Each order of priority <span class="math inline">u</span> defines a possible path for allocating jobs to residents (or vice versa). In each case, we end up with a possible state of the resident-job pairing, from which we deduce the work trips. Of course, the final result depends on the order of priority chosen. To avoid this, the usual strategy in statistical physics is to repeat the procedure for all the possible orders of priority and to consider the average of the results obtained for the different orders of priority. <span class="math inline">I!</span> possible orders of priority.</p>
<p>The ergodic assumption here is that this average over all these orders of priority is close to the steady state of work trips in the area under consideration.</p>
<p>The first quantity that we average over the orders <span class="math inline">u</span> is the availability variable <span class="math inline">\phi_u(i,j)</span> of employment <span class="math inline">j</span> for the resident <span class="math inline">i</span>. This average <span class="math inline">\langle\phi\rangle_u(n,j)</span> corresponds to the probability of the job being available <span class="math inline">j</span> for any resident after <span class="math inline">n</span> residents already have a job or have left the area. This variable dœs not depend on <span class="math inline">i</span> but only on the number of residents already positioned.</p>
<p>A second variable will be useful. This is the average accessibility to available jobs. It can be noted that <span class="math inline">A_n(i,k)</span> the total number of jobs that remain available for <span class="math inline">i</span> when <span class="math inline">n</span> residents have already positioned themselves, counting jobs from the nearest <span class="math inline">i</span> to <span class="math inline">k^{ième}</span> nearest. The figure we are interested in is the average over all the <span class="math inline">n</span> possibilities, i.e.&nbsp;:</p>
<p><span id="eq-an"><span class="math display">
\langle A \rangle_n(i,k) = \langle\sum_{j, r_i(j)\leq k} \langle \phi \rangle_u(n,j) \rangle _n
\tag{15}</span></span></p>
<p>The special feature of this accessibility is that as jobs are taken (when <span class="math inline">n</span> increases), accessibility is reduced, since it only takes the share of nearby jobs that is still available.</p>
<p>As before, we consider that the probability of an individual leaving is a constant. In this case, the probability of absorption will increase as more jobs are taken: the fewer jobs that remain available, the more a resident is prepared to accept those that remain. The probability <span class="math inline">P_a</span> will therefore depend on <span class="math inline">n</span> and can be written as <span class="math inline">P_{a,n}</span>.</p>
<p>For a <span class="math inline">n</span> given, we <span style="white-space:nowrap">have :</span></p>
<p><span id="eq-pf2"><span class="math display">
P_f=\prod_{k=1}^J(1-P_{a,n}\times \langle \phi \rangle_u(n, r_i^{-1}(k))
\tag{16}</span></span></p>
<p>Passing through <span class="math inline">log</span> and performing a limited expansion, we <span style="white-space:nowrap">obtain :</span></p>
<p><span id="eq-logpf"><span class="math display">
log(P_f)=-P_{a,n}\times\sum_{k=1}^J \langle \phi \rangle_u(n,r_i(k))=-P_{a,n}\times(J-(1-P_f)\times n)
\tag{17}</span></span></p>
<p>We now have all the information we need to calculate the probability <span class="math inline">P_n(i,j)</span> that the resident <span class="math inline">i</span> taking the job <span class="math inline">j</span> after <span class="math inline">n</span> residents have already positioned themselves (cf. <a href="#eq-pij" class="quarto-xref">équation&nbsp;9</a>). By switching to <span class="math inline">log</span> we <span style="white-space:nowrap">have :</span></p>
<p><span id="eq-logpij"><span class="math display">
log(P_n(i,j))=log(P_{a,n})+log(\langle\phi \rangle_u(n,j))+\sum_{k=1}^{r_i^{-1}(j)}log(1-P_{a,n}\times \langle \phi \rangle_u(n,r_i(k))
\tag{18}</span></span></p>
<p>By performing a limited expansion of the last term and then averaging over the <span class="math inline">n</span> we <span style="white-space:nowrap">get :</span></p>
<p><span id="eq-logpijapprox"><span class="math display">
log(P_{ij})\approx\langle log(P_{a,n})\rangle _n+\langle\langle\phi\rangle_u(n,j)\rangle_n + \langle A\rangle_n(i, r_i(j))
\tag{19}</span></span></p>
<p>The probability <span class="math inline">P_{ij}</span> can therefore be written from the average probability of absorption, the expectation that the job will be taken up, and the probability of the job being taken up. <span class="math inline">j</span> is available and the average accessibility. Conceptually, this is perfectly satisfactory and understandable. The fact remains that these quantities cannot be calculated directly; simulations are required.</p>
</section>
<section id="sec-hetero" class="level3 page-columns page-full" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="sec-hetero"><span class="header-section-number">3.4</span> Heterogeneity of leakage and absorption</h3>
<p>So far we have considered the case where individuals and jobs are perfectly substitutable. This simplifies the model and allows an explicit resolution. However, it is possible to make the model more complex by introducing interpretable parameters that allow better prediction and extraction of information from the data.</p>
<p>Firstly, the leakage parameter can be specific to each municipality of residents or each type of resident. For example, the census allows us to measure the proportion of individuals, by municipality, who have a job more than 100km from their home. This proportion is low (<span class="math inline">\le5%</span>for a region like the one studied in the La Rochelle application <span class="citation" data-cites="meaps2024a">(<a href="#ref-meaps2024a" role="doc-biblioref">Parodi et Timbeau, 2024b</a>)</span>) but can vary from one commune to another for a variety of reasons: not all communes are equally well served; some are on the outskirts of the study area; the average characteristics of residents vary from one commune to another, etc. The model can easily take into account a probability of leakage<span class="math inline">p_{f,i}</span> for each individual.</p>
<p>Secondly, the absorption parameter has until now been identical for all jobs and all individuals. It can now be made job-dependent, <span class="math inline">p_{a,j}</span> In this way, we can highlight the attractiveness of a particular employment zone. The census provides us with some information on commuting between municipalities and, therefore, on the differential attractiveness of different municipalities. Other data could provide us with information at a sub-municipal level. We might also want to make the probability of absorption dependent on observable job characteristics. Over and above the mass effect already taken into account, jobs in a dense employment zone may be more attractive than isolated jobs. In this case, absorption depends on the following characteristics <span class="math inline">X</span> observed characteristics and by specifying the functional form of <span class="math inline">p_a(X)</span> it can be estimated in such a way as to better reproduce the information on the distribution of journeys.</p>
<p>The model presented is sufficiently flexible to be able to account for more complex phenomena so as to be able both to exploit rich data and to model behaviours (flight, absorption) that seem to make sense. If, instead of matching individuals and jobs, we look at the case of school choice, we can imagine that the absorption of the nearest school is high, while those of higher rank rapidly collapse. If the individual is indifferent to the characteristics of the schools, apart from their location, he will choose the nearest school. The refusal of this first school may be explained by an unobservable parental requirement, which results in a greater distance travelled. But the basic model accounting for a drop in absorption beyond the first rank is likely to be quite good.[^8]. It is also possible to increase or decrease the absorption of certain resident-school pairs, which is a way of introducing information on school mapping, for example.</p>
<p>[^8] In more general terms, we can specify any law for the probability of absorption, which must verify that<span class="math inline">\sum_{k=1,J} p_{i,r_i(k)} = p_{f,i}</span> for all <span class="math inline">i</span>. Any parameterisation of this probability distribution can then be simulated and fitted to the data. If the parameters have a theoretical interpretation, they can be identified.</p>
<p>We can therefore modify the absorption probabilities by giving a particular group of job pairs a greater or lesser chance of being absorbed. By modifying the groups that partition the pairs of individuals <span class="math inline">\times</span> jobs, we can increase or reduce the number of degrees of freedom in the system. When only the probability of absorption is a parameter, the number of degrees of freedom is reduced by 1 and the parameter <span class="math inline">p</span> is determined by the condition of equality between the number of jobs filled and the number of individuals. If we have information on the probability of leakage per individual or per group of individuals, the number of degrees of freedom can be increased by a probability of leakage differentiated according to these groups. The number of degrees of freedom can be further increased by crossing a probability of absorption by groups of jobs and groups of individuals. The choice of specification will depend on what we want to achieve and the problem under consideration. In the<a href="./larochelle.html">estimation at La Rochelle</a> an application using a large number of degrees of freedom in order to adjust the model on detailed data (giving for pairs commune of residence <span class="math inline">\times</span> municipality of employment). We also show a parsimonious determination of the correction cœfficients in order to be able to extract relevant information from the data on flows between communes and to be able to compare the predictive power of <em>MEAPS</em> to that of a gravity model, with an equal degree of freedom.</p>
<p>By indexing by <span class="math inline">i</span> leakage probabilities <span class="math inline">p_{f,i}</span> and by <span class="math inline">i,j</span> the correction cœfficients <span class="math inline">\lambda_{i,j}</span> the main equations of the model <span style="white-space:nowrap">become :</span></p>
<p><span id="eq-comp1"><span class="math display">
P_{i, u}(j) = \lambda_{i,j} . p_{a} \prod _{l=1} ^{r_{u(i)}(j)-1} {[1-\lambda_{i,r_{u(i)}(l)}. p_{a}.\phi_u(i,r_{u(i)}^{-1}(l))]}
\tag{20}</span></span></p>
<p><span id="eq-lambdacomp"><span class="math display">
\prod _{l=1} ^{J} {[1-\lambda_{i,r_{u(i)}(l)}.p_{a}.\phi_u(i,r_{u(i)}^{-1}(l))]}= p_{f,i}
\tag{21}</span></span></p>
<p>It is not possible to give a reduced form of this expression. However, it can be calculated numerically for each <span class="math inline">u</span>, <span class="math inline">i</span> and <span class="math inline">j</span> as a function of the model assumptions (<span class="math inline">p_{f,i}</span>, <span class="math inline">p_{a,j}</span>the spatial structure of residents and jobs) and serves as the basis for the calculation algorithm used in the simulations presented in the <a href="#sec-synth" class="quarto-xref">section&nbsp;4</a> section.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<div class="no-row-height column-margin column-container"><p><sup>3</sup>&nbsp;This expression is implemented in the package R<code>{rmeaps}</code> package, available in the github repository <a href="https://github.com/maxime2506/rmeaps">github.com/maxime2506/rmeaps</a> and installed in R by <code>devtools::install_github("maxime2506/rmeaps")</code>. It is useful to have a compiler that implements OpenMP, which requires a few manipulations on MacOS. The implementation is done in C++/opemmp and relies on parallelization to handle the traversal of priority orders.</p></div><p>The model built in this way is flexible, since it is possible to specify escape processes (in-line constraint equivalent to the constraint <strong>?@eq-a</strong>i constraint) and absorption processes that respect the job saturation constraint (online constraint equivalent to the <strong>?@eq-b</strong>j ) by the priority process described in <strong>?@sec-priority</strong>. By going through all the possible permutations, we can get rid of a particular order of priority and define an average solution to the process. When the problem is analysed with a finite grid (or a grid smaller than the number of<span class="math inline">J</span> opportunities), we can conjecture an ergodic behaviour of the average quantities predicted by the model. This explicitly solves the constraint problem at the margins of the gravity model or the radiative model.</p>
<p>To study some of the properties of the model, we propose here to explore its behaviour on synthetic data. The synthetic data, generated explicitly, allow us to control parameter variations in order to isolate their consequences. These simulations do not claim to be exhaustive or demonstrative, but can be used to support intuition. The entire section on synthetic simulations is executable in the sense of <span class="citation" data-cites="lasser2020">Lasser (<a href="#ref-lasser2020" role="doc-biblioref">2020</a>)</span>. The codes needed to reproduce these simulations and the associated graphics are available at <code>github.com/xtimbeau/meaps</code> and are freely executable.</p>
</section>
</section>
<section id="sec-synth" class="level2 page-columns page-full" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="sec-synth"><span class="header-section-number">4</span> Synthetic simulations</h2>
<section id="sec-3p2s" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="sec-3p2s"><span class="header-section-number">4.1</span> Three centres and satellites</h3>
<p>We construct an abstract territory made up of a <span style="white-space:nowrap">« </span>city centre<span style="white-space:nowrap"> »</span> and <span style="white-space:nowrap">« </span>two peripheries<span style="white-space:nowrap"> »</span> (<strong>?@fig-territory</strong>). This arbitrary configuration allows us to evaluate <em>MEAPS</em> by simulating journeys and their distribution. Each individual and each job are located separately from each other, which makes it possible to calculate Euclidean distances between each inhabitant and each job and to deduce an unambiguous ranking of jobs for each inhabitant according to their distance. All jobs are considered to be substitutable, and it is assumed that there is an identical 10% probability of flight for all individuals. The distances between the centres are given in <a href="#tbl-distances" class="quarto-xref">tableau&nbsp;1</a> (in any unit).</p>
<div class="cell" data-tbl-scap="Distances entre les pôles">
<div id="tbl-distances" class="cell quarto-float anchored" data-tbl-scap="Distances entre les pôles">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-distances-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Tableau</strong>&nbsp;1<strong>.</strong> Distances entre les pôles
</figcaption>
<div aria-describedby="tbl-distances-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="obtmrvmejf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#obtmrvmejf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#obtmrvmejf thead, #obtmrvmejf tbody, #obtmrvmejf tfoot, #obtmrvmejf tr, #obtmrvmejf td, #obtmrvmejf th {
  border-style: none;
}

#obtmrvmejf p {
  margin: 0;
  padding: 0;
}

#obtmrvmejf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#obtmrvmejf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#obtmrvmejf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#obtmrvmejf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#obtmrvmejf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#obtmrvmejf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#obtmrvmejf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#obtmrvmejf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#obtmrvmejf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#obtmrvmejf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#obtmrvmejf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#obtmrvmejf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#obtmrvmejf .gt_spanner_row {
  border-bottom-style: hidden;
}

#obtmrvmejf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#obtmrvmejf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#obtmrvmejf .gt_from_md > :first-child {
  margin-top: 0;
}

#obtmrvmejf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#obtmrvmejf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#obtmrvmejf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#obtmrvmejf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#obtmrvmejf .gt_row_group_first td {
  border-top-width: 2px;
}

#obtmrvmejf .gt_row_group_first th {
  border-top-width: 2px;
}

#obtmrvmejf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#obtmrvmejf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#obtmrvmejf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#obtmrvmejf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#obtmrvmejf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#obtmrvmejf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#obtmrvmejf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#obtmrvmejf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#obtmrvmejf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#obtmrvmejf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#obtmrvmejf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#obtmrvmejf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#obtmrvmejf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#obtmrvmejf .gt_left {
  text-align: left;
}

#obtmrvmejf .gt_center {
  text-align: center;
}

#obtmrvmejf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#obtmrvmejf .gt_font_normal {
  font-weight: normal;
}

#obtmrvmejf .gt_font_bold {
  font-weight: bold;
}

#obtmrvmejf .gt_font_italic {
  font-style: italic;
}

#obtmrvmejf .gt_super {
  font-size: 65%;
}

#obtmrvmejf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#obtmrvmejf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#obtmrvmejf .gt_indent_1 {
  text-indent: 5px;
}

#obtmrvmejf .gt_indent_2 {
  text-indent: 10px;
}

#obtmrvmejf .gt_indent_3 {
  text-indent: 15px;
}

#obtmrvmejf .gt_indent_4 {
  text-indent: 20px;
}

#obtmrvmejf .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h1</td>
<td class="gt_row gt_right" headers="e1">0.00</td>
<td class="gt_row gt_right" headers="e2">0.75</td>
<td class="gt_row gt_right" headers="e3">0.75</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">h2</td>
<td class="gt_row gt_right" headers="e1">0.75</td>
<td class="gt_row gt_right" headers="e2">0.00</td>
<td class="gt_row gt_right" headers="e3">1.50</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h3</td>
<td class="gt_row gt_right" headers="e1">0.75</td>
<td class="gt_row gt_right" headers="e2">1.50</td>
<td class="gt_row gt_right" headers="e3">0.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>To ensure equality between job demand and supply, 4,500 jobs are drawn at random. The three job centres have the same centres as the residential centres, but are more closely distributed than the residential centres. As shown on the <strong>?@fig-territory</strong>, the job centres are located around the same centres as the residential areas. The peripheral centres contain fewer jobs (15% each) than the central centre (70% of total employment), reflecting the usual structure whereby the peripheral centres contain primarily jobs related to services provided to residents (such as shops or schools), while the central activity zone contains a wider range of jobs, in greater numbers. We make no distinction in terms of the productivity or qualifications required for jobs. This assumption simplifies the simulation of the model, but nothing prevents us from distinguishing between categories of jobs and categories of inhabitants, or from introducing elements of choice between distance and type of job. We do not consider here the choice of location and consider all locations as exogenous.</p>
<p>In the statistical analysis that follows, we will proceed with a spatial aggregation by paving the plane where the jobs and inhabitants are located with adjacent hexagons. This corresponds to an empirical analysis in which location data is crunched.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-territoire" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-scap="Territoire synthétique (centre + 2 villages)" data-fig-pos="htb">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-territoire-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Graphique</strong>&nbsp;1<strong>.</strong> Territoire synthétique comportant un centre ville (h1) et deux villages (h2) et (h3). Dans chaque hexagone est indiqué la densité <span style="white-space:nowrap">(5 000</span> habitants). <span style="white-space:nowrap">4 500</span> emplois avec des proportions d’emplois de 80% dans le centre et de 5% dans les 2 villages (les 10% restant sont la fuite). La dispersion est plus basse pour les emplois. Les densités d’emplois sont représentées dans le panneau de droite en orange.
</figcaption>
<div aria-describedby="fig-territoire-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="output/gcarte_ss.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" data-glightbox="description: .lightbox-desc-1"><img src="output/gcarte_ss.png" class="img-fluid figure-img" style="width:100.0%" data-fig-pos="htb" data-fig-scap="Territoire synthétique (centre + 2 villages)"></a>
</div>
</figure>
</div>
</div>
</div>
<p>The <a href="#fig-distances" class="quarto-xref">graphique&nbsp;2</a> simulates <em>MEAPS</em> using data from <strong>?@fig-territory</strong>. For each resident hexagon, we obtain an average value for the distance to their job. In the same way, we calculate the average distance travelled to reach each job.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-distances" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-scap="Distances moyenne par habitant et pour un emploi" data-fig-pos="htb">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-distances-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Graphique</strong>&nbsp;2<strong>.</strong> On représente sur le panneau de <strong>gauche</strong> les distances moyennes parcourues par les habitants d’un héxagone. La vignette présente la densité des trajets en fonction de la distance(vert). Sur le panneau de <strong>droite</strong> on représente les distances moyennes pour atteindre chaque emploi, ainsi que la densité de ces trajets par distance dans la vignette (orange)
</figcaption>
<div aria-describedby="fig-distances-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="output/gdistances.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2"><img src="output/gdistances.png" class="img-fluid figure-img" style="width:100.0%" data-fig-pos="htb" data-fig-scap="Distances moyenne par habitant et pour un emploi"></a>
</div>
</figure>
</div>
</div>
</div>
<p>This first graph shows how the model works <em>MEAPS</em>. A distribution of journeys can be generated (in the thumbnails of the <a href="#fig-distances" class="quarto-xref">graphique&nbsp;2</a>). As the majority of jobs are located in the central hub, the average distances for residents are lower there than in the other hubs. The model generates a little variance within each centre. This is consistent with the idea that the most outlying residential hexagons generate greater distances. The distribution of average distances to employment is tighter than that of average distances travelled per inhabitant. The averages of these two distributions are equal (by construction).</p>
<p>We can construct a table of flows between each centre (<a href="#tbl-fluxpoles" class="quarto-xref">tableau&nbsp;2</a>). The first thing to note is that the constraints at the margins are perfectly respected, which is the principle behind the construction of <em>MEAPS</em> construction principle, the approximations made in the resolution algorithm remain less than <span class="math inline">10^{-5}</span> at least. Furthermore, the flow table confirms the previous diagnosis. Most of the residents of h1 (78%) move to g1 (the same centre). This <span style="white-space:nowrap">« </span>intra-cluster<span style="white-space:nowrap"> »</span> employment rate is 42% for the other two clusters. This is due to the imbalance in the location of jobs and is a desired property of the model. It partly explains the distribution of job mobility distances for residents and also <span style="white-space:nowrap">its ‹</span>reciprocal›, when calculating average distances to a hexagon of jobs.</p>
<div class="cell" data-tbl-scap="flux entre pôles">
<div id="tbl-fluxpoles" class="cell quarto-float anchored" data-tbl-scap="flux entre pôles">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fluxpoles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Tableau</strong>&nbsp;2<strong>.</strong> flux entre pôles
</figcaption>
<div aria-describedby="tbl-fluxpoles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="stvmbgiqlo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#stvmbgiqlo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#stvmbgiqlo thead, #stvmbgiqlo tbody, #stvmbgiqlo tfoot, #stvmbgiqlo tr, #stvmbgiqlo td, #stvmbgiqlo th {
  border-style: none;
}

#stvmbgiqlo p {
  margin: 0;
  padding: 0;
}

#stvmbgiqlo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#stvmbgiqlo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#stvmbgiqlo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#stvmbgiqlo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#stvmbgiqlo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#stvmbgiqlo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stvmbgiqlo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#stvmbgiqlo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#stvmbgiqlo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#stvmbgiqlo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#stvmbgiqlo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#stvmbgiqlo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#stvmbgiqlo .gt_spanner_row {
  border-bottom-style: hidden;
}

#stvmbgiqlo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#stvmbgiqlo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#stvmbgiqlo .gt_from_md > :first-child {
  margin-top: 0;
}

#stvmbgiqlo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#stvmbgiqlo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#stvmbgiqlo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#stvmbgiqlo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#stvmbgiqlo .gt_row_group_first td {
  border-top-width: 2px;
}

#stvmbgiqlo .gt_row_group_first th {
  border-top-width: 2px;
}

#stvmbgiqlo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#stvmbgiqlo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#stvmbgiqlo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#stvmbgiqlo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stvmbgiqlo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#stvmbgiqlo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#stvmbgiqlo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#stvmbgiqlo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#stvmbgiqlo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stvmbgiqlo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#stvmbgiqlo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#stvmbgiqlo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#stvmbgiqlo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#stvmbgiqlo .gt_left {
  text-align: left;
}

#stvmbgiqlo .gt_center {
  text-align: center;
}

#stvmbgiqlo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#stvmbgiqlo .gt_font_normal {
  font-weight: normal;
}

#stvmbgiqlo .gt_font_bold {
  font-weight: bold;
}

#stvmbgiqlo .gt_font_italic {
  font-style: italic;
}

#stvmbgiqlo .gt_super {
  font-size: 65%;
}

#stvmbgiqlo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#stvmbgiqlo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#stvmbgiqlo .gt_indent_1 {
  text-indent: 5px;
}

#stvmbgiqlo .gt_indent_2 {
  text-indent: 10px;
}

#stvmbgiqlo .gt_indent_3 {
  text-indent: 15px;
}

#stvmbgiqlo .gt_indent_4 {
  text-indent: 20px;
}

#stvmbgiqlo .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
<th id="total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h1</td>
<td class="gt_row gt_right" headers="e1"><span style="white-space:nowrap">2 481</span></td>
<td class="gt_row gt_right" headers="e2">335</td>
<td class="gt_row gt_right" headers="e3">334</td>
<td class="gt_row gt_right" headers="total"><span style="white-space:nowrap">3 150</span></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">h2</td>
<td class="gt_row gt_right" headers="e1">334</td>
<td class="gt_row gt_right" headers="e2">290</td>
<td class="gt_row gt_right" headers="e3">51</td>
<td class="gt_row gt_right" headers="total">675</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h3</td>
<td class="gt_row gt_right" headers="e1">334</td>
<td class="gt_row gt_right" headers="e2">50</td>
<td class="gt_row gt_right" headers="e3">290</td>
<td class="gt_row gt_right" headers="total">675</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">total</td>
<td class="gt_row gt_right" headers="e1"><span style="white-space:nowrap">3 150</span></td>
<td class="gt_row gt_right" headers="e2">675</td>
<td class="gt_row gt_right" headers="e3">675</td>
<td class="gt_row gt_right" headers="total"><span style="white-space:nowrap">4 500</span></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>To assess the behaviour of the model, we can perform a thought experiment in which we move the two satellite poles away from the centre (the distance between 1 and 2 or 3 increases from 0.7 to 1.2 in this experiment). The <a href="#tbl-fluxpoles2" class="quarto-xref">tableau&nbsp;3</a> is obtained by simulating the model again on this alternative geography. The result is identical to the previous configuration. This result is consistent with intuition and is a desired property of the model. Since the ranking orders do not change (as long as the poles are far enough apart and the configuration remains symmetrical), the ranks are not modified and therefore the flows are unchanged. The distributions of distances (outgoing and incoming) are largely modified, since 2 or 3 are further away from 1, as indicated by <a href="#fig-distances2" class="quarto-xref">graphique&nbsp;3</a>. We are tempted to conduct further thought experiments to analyse the behaviour of the model. The application <em>Shiny</em> application available at <a href="https://ofce.shinyapps.io/rmeaps">ofce.shinyapps.io/rmeaps</a> allows all these experiments to be carried out using the same code as that used here.</p>
<div class="cell" data-tbl-scap="flux entre pôles (pôle 3 plus loin)">
<div id="tbl-fluxpoles2" class="cell quarto-float anchored" data-tbl-scap="flux entre pôles (pôle 3 plus loin)">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fluxpoles2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Tableau</strong>&nbsp;3<strong>.</strong> flux entre pôles (pôle 3 plus loin)
</figcaption>
<div aria-describedby="tbl-fluxpoles2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="vchpvceqxe" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vchpvceqxe table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vchpvceqxe thead, #vchpvceqxe tbody, #vchpvceqxe tfoot, #vchpvceqxe tr, #vchpvceqxe td, #vchpvceqxe th {
  border-style: none;
}

#vchpvceqxe p {
  margin: 0;
  padding: 0;
}

#vchpvceqxe .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vchpvceqxe .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vchpvceqxe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vchpvceqxe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vchpvceqxe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vchpvceqxe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vchpvceqxe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vchpvceqxe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vchpvceqxe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vchpvceqxe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vchpvceqxe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vchpvceqxe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vchpvceqxe .gt_spanner_row {
  border-bottom-style: hidden;
}

#vchpvceqxe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vchpvceqxe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vchpvceqxe .gt_from_md > :first-child {
  margin-top: 0;
}

#vchpvceqxe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vchpvceqxe .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vchpvceqxe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vchpvceqxe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vchpvceqxe .gt_row_group_first td {
  border-top-width: 2px;
}

#vchpvceqxe .gt_row_group_first th {
  border-top-width: 2px;
}

#vchpvceqxe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vchpvceqxe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vchpvceqxe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vchpvceqxe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vchpvceqxe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vchpvceqxe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vchpvceqxe .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vchpvceqxe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vchpvceqxe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vchpvceqxe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vchpvceqxe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vchpvceqxe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vchpvceqxe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vchpvceqxe .gt_left {
  text-align: left;
}

#vchpvceqxe .gt_center {
  text-align: center;
}

#vchpvceqxe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vchpvceqxe .gt_font_normal {
  font-weight: normal;
}

#vchpvceqxe .gt_font_bold {
  font-weight: bold;
}

#vchpvceqxe .gt_font_italic {
  font-style: italic;
}

#vchpvceqxe .gt_super {
  font-size: 65%;
}

#vchpvceqxe .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vchpvceqxe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vchpvceqxe .gt_indent_1 {
  text-indent: 5px;
}

#vchpvceqxe .gt_indent_2 {
  text-indent: 10px;
}

#vchpvceqxe .gt_indent_3 {
  text-indent: 15px;
}

#vchpvceqxe .gt_indent_4 {
  text-indent: 20px;
}

#vchpvceqxe .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
<th id="total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h1</td>
<td class="gt_row gt_right" headers="e1"><span style="white-space:nowrap">2 482</span></td>
<td class="gt_row gt_right" headers="e2">334</td>
<td class="gt_row gt_right" headers="e3">334</td>
<td class="gt_row gt_right" headers="total"><span style="white-space:nowrap">3 150</span></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">h2</td>
<td class="gt_row gt_right" headers="e1">334</td>
<td class="gt_row gt_right" headers="e2">290</td>
<td class="gt_row gt_right" headers="e3">51</td>
<td class="gt_row gt_right" headers="total">675</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h3</td>
<td class="gt_row gt_right" headers="e1">334</td>
<td class="gt_row gt_right" headers="e2">51</td>
<td class="gt_row gt_right" headers="e3">291</td>
<td class="gt_row gt_right" headers="total">675</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">total</td>
<td class="gt_row gt_right" headers="e1"><span style="white-space:nowrap">3 150</span></td>
<td class="gt_row gt_right" headers="e2">675</td>
<td class="gt_row gt_right" headers="e3">675</td>
<td class="gt_row gt_right" headers="total"><span style="white-space:nowrap">4 500</span></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-distances2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-scap="Distances moyenne par habitant et pour un emploi (3 éloigné)" data-fig-pos="htb">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-distances2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Graphique</strong>&nbsp;3<strong>.</strong> Le graphique est construit comme le précédent, le pôle 3 est éloigné de 0.5 (70% plus loin) par rapport à 1.
</figcaption>
<div aria-describedby="fig-distances2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="output/gdistances2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" data-glightbox="description: .lightbox-desc-3"><img src="output/gdistances2.png" class="img-fluid figure-img" style="width:100.0%" data-fig-pos="htb" data-fig-scap="Distances moyenne par habitant et pour un emploi (3 éloigné)"></a>
</div>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-denscomp" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-scap="Densités comparées" data-fig-pos="htb">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-denscomp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Graphique</strong>&nbsp;4<strong>.</strong> Densités comparées des distances parcourues par habitant entre le scénario de référence et le <span style="white-space:nowrap">scénario ‹</span>pôle 3 plus loin›. Le trait pointillé est utilisé pour le scénario alternatif.
</figcaption>
<div aria-describedby="fig-denscomp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="output/gdenshabg.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" data-glightbox="description: .lightbox-desc-4"><img src="output/gdenshabg.png" class="img-fluid figure-img" style="width:100.0%" data-fig-pos="htb" data-fig-scap="Densités comparées"></a>
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-compgravsynth" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="sec-compgravsynth"><span class="header-section-number">4.2</span> Comparison with the gravity model</h3>
<p>Compare <em>MEAPS</em>with the gravity model to understand its advantages. To do this, we simulate a gravity model with two constraints <a href="#eq-gravmod" class="quarto-xref">équation&nbsp;3</a> which allows calibration on the rows (each individual has a job) and on the columns (each job is filled). This model is simulated at the disaggregated level, i.e.&nbsp;at the level of each individual and each job based on the geographical configuration described above in <a href="#sec-3p2s" class="quarto-xref">section&nbsp;4.1</a>. The gravity model is specified using the function<span class="math inline">f</span> where <span class="math inline">\delta</span> is a positive <span style="white-space:nowrap">parameter :</span></p>
<p><span id="eq-f"><span class="math display">
f(d) = e^{d/\delta}
\tag{22}</span></span></p>
<p>This is a very common choice. The gravity model can then be normalised using the Furness algorithm <span class="citation" data-cites="de2011modelling">(<a href="#ref-de2011modelling" role="doc-biblioref">Dios Ortúzar et Willumsen, 2011</a>)</span> algorithm, in which first the rows are normalised (each individual has one job and one job only in probability, taking into account the leakage parameter), then the columns (each job is completely filled). These normalisations are iterated in rows and then in columns until a stable flow matrix is obtained. These normalisations follow the <a href="#eq-ai" class="quarto-xref">équation&nbsp;4</a> and <a href="#eq-bj" class="quarto-xref">équation&nbsp;5</a> normalisations.</p>
<p>The gravity model specified in this way is fitted to the simulation <em>MEAPS</em> simulation, taking as a reference the flows of <a href="#tbl-fluxpoles" class="quarto-xref">tableau&nbsp;2</a>, constructed by aggregation over groups of inhabitants and <span style="white-space:nowrap">jobs –</span> in other words a matrix of <span class="math inline">3 \times 3</span>. The adjustment is made by calibrating the parameter <span class="math inline">\delta</span> so as to minimise the relative Kullback-Leitner entropy of the aggregated distributions (this notion of entropy is described in detail in the document <a href="./larochelle.html">Estimates at La Rochelle</a>). The result of the estimation is proposed in <a href="#tbl-fluxgrav" class="quarto-xref">tableau&nbsp;4</a> and corresponds to a value of <span class="math inline">\delta \approx</span> 0.68.</p>
<div class="cell">
<div id="tbl-fluxgrav" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fluxgrav-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Tableau</strong>&nbsp;4<strong>.</strong> Modèle gravitaire calé sur la configuration de référence
</figcaption>
<div aria-describedby="tbl-fluxgrav-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="cbzbqiuptn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cbzbqiuptn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cbzbqiuptn thead, #cbzbqiuptn tbody, #cbzbqiuptn tfoot, #cbzbqiuptn tr, #cbzbqiuptn td, #cbzbqiuptn th {
  border-style: none;
}

#cbzbqiuptn p {
  margin: 0;
  padding: 0;
}

#cbzbqiuptn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cbzbqiuptn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cbzbqiuptn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cbzbqiuptn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cbzbqiuptn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cbzbqiuptn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cbzbqiuptn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cbzbqiuptn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cbzbqiuptn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cbzbqiuptn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cbzbqiuptn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cbzbqiuptn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cbzbqiuptn .gt_spanner_row {
  border-bottom-style: hidden;
}

#cbzbqiuptn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cbzbqiuptn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cbzbqiuptn .gt_from_md > :first-child {
  margin-top: 0;
}

#cbzbqiuptn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cbzbqiuptn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cbzbqiuptn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cbzbqiuptn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cbzbqiuptn .gt_row_group_first td {
  border-top-width: 2px;
}

#cbzbqiuptn .gt_row_group_first th {
  border-top-width: 2px;
}

#cbzbqiuptn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbzbqiuptn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cbzbqiuptn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cbzbqiuptn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cbzbqiuptn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbzbqiuptn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cbzbqiuptn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cbzbqiuptn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cbzbqiuptn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cbzbqiuptn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cbzbqiuptn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbzbqiuptn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cbzbqiuptn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbzbqiuptn .gt_left {
  text-align: left;
}

#cbzbqiuptn .gt_center {
  text-align: center;
}

#cbzbqiuptn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cbzbqiuptn .gt_font_normal {
  font-weight: normal;
}

#cbzbqiuptn .gt_font_bold {
  font-weight: bold;
}

#cbzbqiuptn .gt_font_italic {
  font-style: italic;
}

#cbzbqiuptn .gt_super {
  font-size: 65%;
}

#cbzbqiuptn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cbzbqiuptn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cbzbqiuptn .gt_indent_1 {
  text-indent: 5px;
}

#cbzbqiuptn .gt_indent_2 {
  text-indent: 10px;
}

#cbzbqiuptn .gt_indent_3 {
  text-indent: 15px;
}

#cbzbqiuptn .gt_indent_4 {
  text-indent: 20px;
}

#cbzbqiuptn .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th colspan="5" id="MEAPS<br>Fuite à 10%" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">MEAPS<br>
Fuite à 10%</span></th>
<th rowspan="2" id=" " class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="5" id="Gravitaire<br>Normalisé, δ = 0.68" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Gravitaire<br>
Normalisé, δ = 0.68</span></th>
</tr>
<tr class="odd gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
<th id="total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
<th id="total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h1</td>
<td class="gt_row gt_right" headers="e1"><span style="white-space:nowrap">2 481</span></td>
<td class="gt_row gt_right" headers="e2">335</td>
<td class="gt_row gt_right" headers="e3">334</td>
<td class="gt_row gt_right" headers="total"><span style="white-space:nowrap">3 150</span></td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">h1</td>
<td class="gt_row gt_right" headers="e1_g"><span style="white-space:nowrap">2 447</span></td>
<td class="gt_row gt_right" headers="e2_g">352</td>
<td class="gt_row gt_right" headers="e3_g">350</td>
<td class="gt_row gt_right" headers="total_g"><span style="white-space:nowrap">3 150</span></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">h2</td>
<td class="gt_row gt_right" headers="e1">334</td>
<td class="gt_row gt_right" headers="e2">290</td>
<td class="gt_row gt_right" headers="e3">51</td>
<td class="gt_row gt_right" headers="total">675</td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">h2</td>
<td class="gt_row gt_right" headers="e1_g">353</td>
<td class="gt_row gt_right" headers="e2_g">286</td>
<td class="gt_row gt_right" headers="e3_g">36</td>
<td class="gt_row gt_right" headers="total_g">675</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h3</td>
<td class="gt_row gt_right" headers="e1">334</td>
<td class="gt_row gt_right" headers="e2">50</td>
<td class="gt_row gt_right" headers="e3">290</td>
<td class="gt_row gt_right" headers="total">675</td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">h3</td>
<td class="gt_row gt_right" headers="e1_g">350</td>
<td class="gt_row gt_right" headers="e2_g">37</td>
<td class="gt_row gt_right" headers="e3_g">288</td>
<td class="gt_row gt_right" headers="total_g">675</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">total</td>
<td class="gt_row gt_right" headers="e1"><span style="white-space:nowrap">3 150</span></td>
<td class="gt_row gt_right" headers="e2">675</td>
<td class="gt_row gt_right" headers="e3">675</td>
<td class="gt_row gt_right" headers="total"><span style="white-space:nowrap">4 500</span></td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">total</td>
<td class="gt_row gt_right" headers="e1_g"><span style="white-space:nowrap">3 150</span></td>
<td class="gt_row gt_right" headers="e2_g">675</td>
<td class="gt_row gt_right" headers="e3_g">675</td>
<td class="gt_row gt_right" headers="total_g"><span style="white-space:nowrap">4 500</span></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>The adjustment of the gravity model gives a good result. One of the reasons for this good result is the symmetry of the geographical configuration. The two satellites are at the same distance from the central pole and the <span class="math inline">f</span> function, which depends only on distance, ensures that the flows are distributed between each of the poles without too much difficulty. If we take a non-symmetrical configuration, by moving one of the two satellites further away, with the other remaining in its place, we obtain a different pattern, with the gravity model amplifying the asymmetries.</p>
<div class="cell">
<div id="tbl-fluxgrav2" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fluxgrav2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Tableau</strong>&nbsp;5<strong>.</strong> Modèle gravitaire pour un satellite éloigné
</figcaption>
<div aria-describedby="tbl-fluxgrav2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="lawloyzwdr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lawloyzwdr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lawloyzwdr thead, #lawloyzwdr tbody, #lawloyzwdr tfoot, #lawloyzwdr tr, #lawloyzwdr td, #lawloyzwdr th {
  border-style: none;
}

#lawloyzwdr p {
  margin: 0;
  padding: 0;
}

#lawloyzwdr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lawloyzwdr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lawloyzwdr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lawloyzwdr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lawloyzwdr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lawloyzwdr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lawloyzwdr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lawloyzwdr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lawloyzwdr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lawloyzwdr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lawloyzwdr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lawloyzwdr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lawloyzwdr .gt_spanner_row {
  border-bottom-style: hidden;
}

#lawloyzwdr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lawloyzwdr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lawloyzwdr .gt_from_md > :first-child {
  margin-top: 0;
}

#lawloyzwdr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lawloyzwdr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lawloyzwdr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lawloyzwdr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lawloyzwdr .gt_row_group_first td {
  border-top-width: 2px;
}

#lawloyzwdr .gt_row_group_first th {
  border-top-width: 2px;
}

#lawloyzwdr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lawloyzwdr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lawloyzwdr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lawloyzwdr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lawloyzwdr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lawloyzwdr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lawloyzwdr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lawloyzwdr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lawloyzwdr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lawloyzwdr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lawloyzwdr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lawloyzwdr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lawloyzwdr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lawloyzwdr .gt_left {
  text-align: left;
}

#lawloyzwdr .gt_center {
  text-align: center;
}

#lawloyzwdr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lawloyzwdr .gt_font_normal {
  font-weight: normal;
}

#lawloyzwdr .gt_font_bold {
  font-weight: bold;
}

#lawloyzwdr .gt_font_italic {
  font-style: italic;
}

#lawloyzwdr .gt_super {
  font-size: 65%;
}

#lawloyzwdr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lawloyzwdr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lawloyzwdr .gt_indent_1 {
  text-indent: 5px;
}

#lawloyzwdr .gt_indent_2 {
  text-indent: 10px;
}

#lawloyzwdr .gt_indent_3 {
  text-indent: 15px;
}

#lawloyzwdr .gt_indent_4 {
  text-indent: 20px;
}

#lawloyzwdr .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th colspan="5" id="MEAPS<br>Fuite à 10%" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">MEAPS<br>
Fuite à 10%</span></th>
<th rowspan="2" id=" " class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="5" id="Gravitaire<br>Normalisé, δ = 0.68" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Gravitaire<br>
Normalisé, δ = 0.68</span></th>
</tr>
<tr class="odd gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
<th id="total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
<th id="total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h1</td>
<td class="gt_row gt_right" headers="e1"><span style="white-space:nowrap">2 482</span></td>
<td class="gt_row gt_right" headers="e2">334</td>
<td class="gt_row gt_right" headers="e3">334</td>
<td class="gt_row gt_right" headers="total"><span style="white-space:nowrap">3 150</span></td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">h1</td>
<td class="gt_row gt_right" headers="e1_g"><span style="white-space:nowrap">2 581</span></td>
<td class="gt_row gt_right" headers="e2_g">285</td>
<td class="gt_row gt_right" headers="e3_g">284</td>
<td class="gt_row gt_right" headers="total_g"><span style="white-space:nowrap">3 150</span></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">h2</td>
<td class="gt_row gt_right" headers="e1">334</td>
<td class="gt_row gt_right" headers="e2">290</td>
<td class="gt_row gt_right" headers="e3">51</td>
<td class="gt_row gt_right" headers="total">675</td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">h2</td>
<td class="gt_row gt_right" headers="e1_g">286</td>
<td class="gt_row gt_right" headers="e2_g">367</td>
<td class="gt_row gt_right" headers="e3_g">22</td>
<td class="gt_row gt_right" headers="total_g">675</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h3</td>
<td class="gt_row gt_right" headers="e1">334</td>
<td class="gt_row gt_right" headers="e2">51</td>
<td class="gt_row gt_right" headers="e3">291</td>
<td class="gt_row gt_right" headers="total">675</td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">h3</td>
<td class="gt_row gt_right" headers="e1_g">284</td>
<td class="gt_row gt_right" headers="e2_g">23</td>
<td class="gt_row gt_right" headers="e3_g">369</td>
<td class="gt_row gt_right" headers="total_g">675</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">total</td>
<td class="gt_row gt_right" headers="e1"><span style="white-space:nowrap">3 150</span></td>
<td class="gt_row gt_right" headers="e2">675</td>
<td class="gt_row gt_right" headers="e3">675</td>
<td class="gt_row gt_right" headers="total"><span style="white-space:nowrap">4 500</span></td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">total</td>
<td class="gt_row gt_right" headers="e1_g"><span style="white-space:nowrap">3 150</span></td>
<td class="gt_row gt_right" headers="e2_g">675</td>
<td class="gt_row gt_right" headers="e3_g">675</td>
<td class="gt_row gt_right" headers="total_g"><span style="white-space:nowrap">4 500</span></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>The model <em>MEAPS</em> model maintains an identical configuration in the case of satellite centres that are far from the centre, because the configuration remains symmetrical and no rank is changed. On the other hand, the gravity model gives a very different response to the reference case: satellite residents are more inclined to look for jobs in their respective satellites, and the flows between satellite poles and the central pole are reduced. This property of the gravity model is expected: the function <span class="math inline">f</span> function gives less weight to jobs that are further away. At the limit where this distance becomes particularly great, the flows between satellite centres and the central centre will dry up almost entirely. The estimated parameter for the simulation <em>MEAPS</em> simulation is of the order of 0.68 which is of the order of magnitude of the radius of the central pole (0.5). For a distance of a few times 0.68 the flux between poles will be almost zero. The response of <em>MEAPS</em> response seems more appropriate to the situation we are observing. When municipalities are satellites of a central hub at a distance of a few dozen kilometres, there are flows towards this municipality to take up jobs, and the fact that the municipality is a few kilometres further away dœs not drastically stop these flows. The sensitivity of distance is expected to be low <em>at this scale</em>. We will see when we apply this to the La Rochelle conurbation, using data describing flows between the commune of residence and the commune of employment (taken from <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022</a>)</span>) that <em>MEAPS</em> provides a better representation of reality than the gravity model.</p>
<p>If the procedure for estimating the parameter <span class="math inline">\delta</span> on the geographical configuration where the satellite poles are far apart, we end up with <span class="math inline">\delta \approx</span> 0.95. This value is very different from the previous parameter, which shows both <span style="white-space:nowrap">the ‹</span>plasticity› of the gravity model and its unreliability, as if <span style="white-space:nowrap">the ‹</span>gravitational› force could change completely with each new datum (<a href="#tbl-fluxgrav3" class="quarto-xref">tableau&nbsp;6</a>).</p>
<div class="cell">
<div id="tbl-fluxgrav3" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fluxgrav3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Tableau</strong>&nbsp;6<strong>.</strong> Modèle gravitaire réajusté, satellite éloigné
</figcaption>
<div aria-describedby="tbl-fluxgrav3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="xtifosmwjv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xtifosmwjv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xtifosmwjv thead, #xtifosmwjv tbody, #xtifosmwjv tfoot, #xtifosmwjv tr, #xtifosmwjv td, #xtifosmwjv th {
  border-style: none;
}

#xtifosmwjv p {
  margin: 0;
  padding: 0;
}

#xtifosmwjv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xtifosmwjv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xtifosmwjv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xtifosmwjv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xtifosmwjv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xtifosmwjv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtifosmwjv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xtifosmwjv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xtifosmwjv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xtifosmwjv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xtifosmwjv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xtifosmwjv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xtifosmwjv .gt_spanner_row {
  border-bottom-style: hidden;
}

#xtifosmwjv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xtifosmwjv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xtifosmwjv .gt_from_md > :first-child {
  margin-top: 0;
}

#xtifosmwjv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xtifosmwjv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xtifosmwjv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xtifosmwjv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xtifosmwjv .gt_row_group_first td {
  border-top-width: 2px;
}

#xtifosmwjv .gt_row_group_first th {
  border-top-width: 2px;
}

#xtifosmwjv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtifosmwjv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xtifosmwjv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xtifosmwjv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtifosmwjv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtifosmwjv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xtifosmwjv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xtifosmwjv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xtifosmwjv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtifosmwjv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xtifosmwjv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtifosmwjv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xtifosmwjv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtifosmwjv .gt_left {
  text-align: left;
}

#xtifosmwjv .gt_center {
  text-align: center;
}

#xtifosmwjv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xtifosmwjv .gt_font_normal {
  font-weight: normal;
}

#xtifosmwjv .gt_font_bold {
  font-weight: bold;
}

#xtifosmwjv .gt_font_italic {
  font-style: italic;
}

#xtifosmwjv .gt_super {
  font-size: 65%;
}

#xtifosmwjv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xtifosmwjv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xtifosmwjv .gt_indent_1 {
  text-indent: 5px;
}

#xtifosmwjv .gt_indent_2 {
  text-indent: 10px;
}

#xtifosmwjv .gt_indent_3 {
  text-indent: 15px;
}

#xtifosmwjv .gt_indent_4 {
  text-indent: 20px;
}

#xtifosmwjv .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th colspan="5" id="MEAPS<br>Fuite à 10%" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">MEAPS<br>
Fuite à 10%</span></th>
<th rowspan="2" id=" " class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="5" id="Gravitaire<br>Normalisé, δ = 0.95" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Gravitaire<br>
Normalisé, δ = 0.95</span></th>
</tr>
<tr class="odd gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
<th id="total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
<th id="total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h1</td>
<td class="gt_row gt_right" headers="e1"><span style="white-space:nowrap">2 482</span></td>
<td class="gt_row gt_right" headers="e2">334</td>
<td class="gt_row gt_right" headers="e3">334</td>
<td class="gt_row gt_right" headers="total"><span style="white-space:nowrap">3 150</span></td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">h1</td>
<td class="gt_row gt_right" headers="e1_g"><span style="white-space:nowrap">2 455</span></td>
<td class="gt_row gt_right" headers="e2_g">348</td>
<td class="gt_row gt_right" headers="e3_g">347</td>
<td class="gt_row gt_right" headers="total_g"><span style="white-space:nowrap">3 150</span></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">h2</td>
<td class="gt_row gt_right" headers="e1">334</td>
<td class="gt_row gt_right" headers="e2">290</td>
<td class="gt_row gt_right" headers="e3">51</td>
<td class="gt_row gt_right" headers="total">675</td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">h2</td>
<td class="gt_row gt_right" headers="e1_g">348</td>
<td class="gt_row gt_right" headers="e2_g">288</td>
<td class="gt_row gt_right" headers="e3_g">39</td>
<td class="gt_row gt_right" headers="total_g">675</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h3</td>
<td class="gt_row gt_right" headers="e1">334</td>
<td class="gt_row gt_right" headers="e2">51</td>
<td class="gt_row gt_right" headers="e3">291</td>
<td class="gt_row gt_right" headers="total">675</td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">h3</td>
<td class="gt_row gt_right" headers="e1_g">347</td>
<td class="gt_row gt_right" headers="e2_g">39</td>
<td class="gt_row gt_right" headers="e3_g">289</td>
<td class="gt_row gt_right" headers="total_g">675</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">total</td>
<td class="gt_row gt_right" headers="e1"><span style="white-space:nowrap">3 150</span></td>
<td class="gt_row gt_right" headers="e2">675</td>
<td class="gt_row gt_right" headers="e3">675</td>
<td class="gt_row gt_right" headers="total"><span style="white-space:nowrap">4 500</span></td>
<td class="gt_row gt_right" headers="vide" style="border-left-width: 1px; border-left-style: hidden; border-left-color: #000000; border-right-width: 1px; border-right-style: hidden; border-right-color: #000000; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: hidden; border-bottom-color: #000000"></td>
<td class="gt_row gt_left" headers="gh_g">total</td>
<td class="gt_row gt_right" headers="e1_g"><span style="white-space:nowrap">3 150</span></td>
<td class="gt_row gt_right" headers="e2_g">675</td>
<td class="gt_row gt_right" headers="e3_g">675</td>
<td class="gt_row gt_right" headers="total_g"><span style="white-space:nowrap">4 500</span></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="sec-estimation" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="sec-estimation"><span class="header-section-number">4.3</span> Estimation procedure</h3>
<p>It is possible to modify the weightings of the absorption probabilities so as to modify the flow table. This is illustrated in the following table, where for each of the 9 possible pairs of residential area (3) and employment area (3) the relative probability of absorption has been doubled successively. The geographical configuration is that of the <strong>?@fig-territory</strong>, with a centre and two satellites. The centre contains more jobs than residents, forcing inflows into zone 1 as indicated in the <a href="#tbl-fluxpoles" class="quarto-xref">tableau&nbsp;2</a>. This is referred to as a relative doubling of the probability, because the constraints of constant probability of escape and saturation of jobs impose a reduction in the probability of absorption of the other jobs, which is guaranteed in the algorithm which implements <em>MEAPS</em>.</p>
<p>The <a href="#tbl-fluxpond" class="quarto-xref">tableau&nbsp;7</a> describes the variations in flows compared with a reference situation (that of the <a href="#tbl-fluxpoles" class="quarto-xref">tableau&nbsp;2</a>), rounded to the nearest integer. There are therefore <span class="math inline">3 \times 3</span> matrices <span class="math inline">3 \times 3</span>. Each of the sub-matrices indicates the flow variations for each origin-destination pair; there are 9 possibilities for doubling the absorption probability, which constitute the rows and columns of the encompassing matrix. Note that the sums of the columns and rows of each sub-matrix are zero, indicating that the row and column constraints have been met.</p>
<p>In accordance with intuition, and despite the effects induced by compliance with the row and column constraints, it can be seen that the residential/employment zone pair, which is increased in relative probability, experiences higher flows. To compensate for these higher flows, in the same column, i.e.&nbsp;for flows from other residential areas, there is a systematic decrease in flows from other residential areas. Symmetrically, an increase in flows from the residential area <span class="math inline">i</span> to the employment zone <span class="math inline">j</span> always leads to a decrease in flows from <span class="math inline">i</span> to other employment areas.</p>
<div class="cell">
<div id="tbl-fluxpond" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fluxpond-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Tableau</strong>&nbsp;7<strong>.</strong> Modification de la probabilité d’absorption
</figcaption>
<div aria-describedby="tbl-fluxpond-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="kbwmiqkxbp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kbwmiqkxbp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kbwmiqkxbp thead, #kbwmiqkxbp tbody, #kbwmiqkxbp tfoot, #kbwmiqkxbp tr, #kbwmiqkxbp td, #kbwmiqkxbp th {
  border-style: none;
}

#kbwmiqkxbp p {
  margin: 0;
  padding: 0;
}

#kbwmiqkxbp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kbwmiqkxbp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kbwmiqkxbp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kbwmiqkxbp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kbwmiqkxbp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kbwmiqkxbp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kbwmiqkxbp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kbwmiqkxbp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kbwmiqkxbp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kbwmiqkxbp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kbwmiqkxbp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kbwmiqkxbp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kbwmiqkxbp .gt_spanner_row {
  border-bottom-style: hidden;
}

#kbwmiqkxbp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kbwmiqkxbp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kbwmiqkxbp .gt_from_md > :first-child {
  margin-top: 0;
}

#kbwmiqkxbp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kbwmiqkxbp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kbwmiqkxbp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kbwmiqkxbp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kbwmiqkxbp .gt_row_group_first td {
  border-top-width: 2px;
}

#kbwmiqkxbp .gt_row_group_first th {
  border-top-width: 2px;
}

#kbwmiqkxbp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbwmiqkxbp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kbwmiqkxbp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kbwmiqkxbp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kbwmiqkxbp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbwmiqkxbp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kbwmiqkxbp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kbwmiqkxbp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kbwmiqkxbp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kbwmiqkxbp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kbwmiqkxbp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbwmiqkxbp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kbwmiqkxbp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbwmiqkxbp .gt_left {
  text-align: left;
}

#kbwmiqkxbp .gt_center {
  text-align: center;
}

#kbwmiqkxbp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kbwmiqkxbp .gt_font_normal {
  font-weight: normal;
}

#kbwmiqkxbp .gt_font_bold {
  font-weight: bold;
}

#kbwmiqkxbp .gt_font_italic {
  font-style: italic;
}

#kbwmiqkxbp .gt_super {
  font-size: 65%;
}

#kbwmiqkxbp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kbwmiqkxbp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kbwmiqkxbp .gt_indent_1 {
  text-indent: 5px;
}

#kbwmiqkxbp .gt_indent_2 {
  text-indent: 10px;
}

#kbwmiqkxbp .gt_indent_3 {
  text-indent: 15px;
}

#kbwmiqkxbp .gt_indent_4 {
  text-indent: 20px;
}

#kbwmiqkxbp .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th rowspan="2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="3" id="e1" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">e1</span></th>
<th colspan="3" id="e2" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">e2</span></th>
<th colspan="3" id="e3" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">e3</span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">e3</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_row_group_first">
<td rowspan="3" class="gt_row gt_left gt_stub_row_group" headers="h1 stub_1_1 stub_1">h1</td>
<td class="gt_row gt_left" headers="h1 stub_1_1 h">h1</td>
<td class="gt_row gt_right" headers="h1 stub_1_1 e1_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">76</td>
<td class="gt_row gt_right" headers="h1 stub_1_1 e1_e2">−38</td>
<td class="gt_row gt_right" headers="h1 stub_1_1 e1_e3">−38</td>
<td class="gt_row gt_right" headers="h1 stub_1_1 e2_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">−72</td>
<td class="gt_row gt_right" headers="h1 stub_1_1 e2_e2">55</td>
<td class="gt_row gt_right" headers="h1 stub_1_1 e2_e3">17</td>
<td class="gt_row gt_right" headers="h1 stub_1_1 e3_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">−72</td>
<td class="gt_row gt_right" headers="h1 stub_1_1 e3_e2">17</td>
<td class="gt_row gt_right" headers="h1 stub_1_1 e3_e3" style="border-right-width: 1px; border-right-style: solid; border-right-color: black">55</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="h1 h_2 h">h2</td>
<td class="gt_row gt_right" headers="h1 h_2 e1_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">−38</td>
<td class="gt_row gt_right" headers="h1 h_2 e1_e2">27</td>
<td class="gt_row gt_right" headers="h1 h_2 e1_e3">11</td>
<td class="gt_row gt_right" headers="h1 h_2 e2_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">81</td>
<td class="gt_row gt_right" headers="h1 h_2 e2_e2">−63</td>
<td class="gt_row gt_right" headers="h1 h_2 e2_e3">−18</td>
<td class="gt_row gt_right" headers="h1 h_2 e3_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">−9</td>
<td class="gt_row gt_right" headers="h1 h_2 e3_e2">1</td>
<td class="gt_row gt_right" headers="h1 h_2 e3_e3" style="border-right-width: 1px; border-right-style: solid; border-right-color: black">8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="h1 h_3 h" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">h3</td>
<td class="gt_row gt_right" headers="h1 h_3 e1_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−38</td>
<td class="gt_row gt_right" headers="h1 h_3 e1_e2" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">11</td>
<td class="gt_row gt_right" headers="h1 h_3 e1_e3" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">27</td>
<td class="gt_row gt_right" headers="h1 h_3 e2_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−9</td>
<td class="gt_row gt_right" headers="h1 h_3 e2_e2" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">8</td>
<td class="gt_row gt_right" headers="h1 h_3 e2_e3" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">1</td>
<td class="gt_row gt_right" headers="h1 h_3 e3_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">81</td>
<td class="gt_row gt_right" headers="h1 h_3 e3_e2" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−18</td>
<td class="gt_row gt_right" headers="h1 h_3 e3_e3" style="border-right-width: 1px; border-right-style: solid; border-right-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−63</td>
</tr>
<tr class="even gt_row_group_first">
<td rowspan="3" class="gt_row gt_left gt_stub_row_group" headers="h2 stub_1_4 stub_1">h2</td>
<td class="gt_row gt_left" headers="h2 stub_1_4 h">h1</td>
<td class="gt_row gt_right" headers="h2 stub_1_4 e1_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">−59</td>
<td class="gt_row gt_right" headers="h2 stub_1_4 e1_e2">75</td>
<td class="gt_row gt_right" headers="h2 stub_1_4 e1_e3">−15</td>
<td class="gt_row gt_right" headers="h2 stub_1_4 e2_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">75</td>
<td class="gt_row gt_right" headers="h2 stub_1_4 e2_e2">−76</td>
<td class="gt_row gt_right" headers="h2 stub_1_4 e2_e3">1</td>
<td class="gt_row gt_right" headers="h2 stub_1_4 e3_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">2</td>
<td class="gt_row gt_right" headers="h2 stub_1_4 e3_e2">−26</td>
<td class="gt_row gt_right" headers="h2 stub_1_4 e3_e3" style="border-right-width: 1px; border-right-style: solid; border-right-color: black">24</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="h2 h_5 h">h2</td>
<td class="gt_row gt_right" headers="h2 h_5 e1_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">51</td>
<td class="gt_row gt_right" headers="h2 h_5 e1_e2">−58</td>
<td class="gt_row gt_right" headers="h2 h_5 e1_e3">7</td>
<td class="gt_row gt_right" headers="h2 h_5 e2_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">−80</td>
<td class="gt_row gt_right" headers="h2 h_5 e2_e2">87</td>
<td class="gt_row gt_right" headers="h2 h_5 e2_e3">−7</td>
<td class="gt_row gt_right" headers="h2 h_5 e3_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">7</td>
<td class="gt_row gt_right" headers="h2 h_5 e3_e2">−13</td>
<td class="gt_row gt_right" headers="h2 h_5 e3_e3" style="border-right-width: 1px; border-right-style: solid; border-right-color: black">5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="h2 h_6 h" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">h3</td>
<td class="gt_row gt_right" headers="h2 h_6 e1_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">9</td>
<td class="gt_row gt_right" headers="h2 h_6 e1_e2" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−17</td>
<td class="gt_row gt_right" headers="h2 h_6 e1_e3" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">8</td>
<td class="gt_row gt_right" headers="h2 h_6 e2_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">5</td>
<td class="gt_row gt_right" headers="h2 h_6 e2_e2" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−11</td>
<td class="gt_row gt_right" headers="h2 h_6 e2_e3" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">7</td>
<td class="gt_row gt_right" headers="h2 h_6 e3_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−9</td>
<td class="gt_row gt_right" headers="h2 h_6 e3_e2" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">39</td>
<td class="gt_row gt_right" headers="h2 h_6 e3_e3" style="border-right-width: 1px; border-right-style: solid; border-right-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−30</td>
</tr>
<tr class="odd gt_row_group_first">
<td rowspan="3" class="gt_row gt_left gt_stub_row_group" headers="h3 stub_1_7 stub_1">h3</td>
<td class="gt_row gt_left" headers="h3 stub_1_7 h">h1</td>
<td class="gt_row gt_right" headers="h3 stub_1_7 e1_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">−59</td>
<td class="gt_row gt_right" headers="h3 stub_1_7 e1_e2">−15</td>
<td class="gt_row gt_right" headers="h3 stub_1_7 e1_e3">75</td>
<td class="gt_row gt_right" headers="h3 stub_1_7 e2_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">2</td>
<td class="gt_row gt_right" headers="h3 stub_1_7 e2_e2">24</td>
<td class="gt_row gt_right" headers="h3 stub_1_7 e2_e3">−26</td>
<td class="gt_row gt_right" headers="h3 stub_1_7 e3_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">75</td>
<td class="gt_row gt_right" headers="h3 stub_1_7 e3_e2">0</td>
<td class="gt_row gt_right" headers="h3 stub_1_7 e3_e3" style="border-right-width: 1px; border-right-style: solid; border-right-color: black">−76</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="h3 h_8 h">h2</td>
<td class="gt_row gt_right" headers="h3 h_8 e1_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">9</td>
<td class="gt_row gt_right" headers="h3 h_8 e1_e2">8</td>
<td class="gt_row gt_right" headers="h3 h_8 e1_e3">−17</td>
<td class="gt_row gt_right" headers="h3 h_8 e2_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">−9</td>
<td class="gt_row gt_right" headers="h3 h_8 e2_e2">−30</td>
<td class="gt_row gt_right" headers="h3 h_8 e2_e3">39</td>
<td class="gt_row gt_right" headers="h3 h_8 e3_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black">5</td>
<td class="gt_row gt_right" headers="h3 h_8 e3_e2">7</td>
<td class="gt_row gt_right" headers="h3 h_8 e3_e3" style="border-right-width: 1px; border-right-style: solid; border-right-color: black">−12</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="h3 h_9 h" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">h3</td>
<td class="gt_row gt_right" headers="h3 h_9 e1_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">51</td>
<td class="gt_row gt_right" headers="h3 h_9 e1_e2" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">7</td>
<td class="gt_row gt_right" headers="h3 h_9 e1_e3" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−58</td>
<td class="gt_row gt_right" headers="h3 h_9 e2_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">7</td>
<td class="gt_row gt_right" headers="h3 h_9 e2_e2" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">5</td>
<td class="gt_row gt_right" headers="h3 h_9 e2_e3" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−12</td>
<td class="gt_row gt_right" headers="h3 h_9 e3_e1" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−80</td>
<td class="gt_row gt_right" headers="h3 h_9 e3_e2" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">−7</td>
<td class="gt_row gt_right" headers="h3 h_9 e3_e3" style="border-right-width: 1px; border-right-style: solid; border-right-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black">87</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="11" class="gt_sourcenote">Le tableau représente l’écart entre les flux obtenus pour une probabilité d’absorption doublée pour la zone <em>i</em> d’habitation et la zone <em>j</em> d’emploi, pour chaque paire de zones habitation/emploi. La première matrice en haut à gauche indique donc que le flux entre la zone 1 d’habitation et la zone 1 d’emploi est accru de 76 lorsque la probabilité d’absorption relative est doublée. Pour compenser ce flux plus important entre 1 et 1, le flux en la zone d’habitation 2 et l’emploi 1 est réduit de 38, ce qui implique à son tour que ceux entre 2 et 2 et entre 2 et 3 s’accroissent.</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>An interesting property of the <a href="#tbl-fluxpond" class="quarto-xref">tableau&nbsp;7</a> matrices is that the 9 matrices <span class="math inline">3 \times 3</span>form a vector space[^10] of dimension 4. This is to be expected, since the constraints reduce the dimension by 9 (<span class="math inline">=3\times 3</span>) to 4, since there are 3 constraints in each dimension (rows and columns) and one is redundant (if the sums on each row are zero, then the sum of all the cœfficients is zero and therefore if the sums on two columns are zero, the third is necessarily zero). This indicates that, at least locally (in the vicinity of the flux matrix calculated in <a href="#tbl-fluxpoles" class="quarto-xref">tableau&nbsp;2</a>), it is possible to modify the absorption probabilities to achieve any flux matrix. To the nearest linear approximation, it is therefore possible to reproduce any aggregate flow structure using a set of parameters that exactly saturate the dimension of this flow structure. This property means that different estimation approaches can be envisaged, depending on the data available and the number of degrees of freedom we are prepared to devote to reproducing the data.</p>
<p>[^10] The eigenvalues of the<span class="math inline">9 \times 9</span> consisting of the 9 column vectors of the 9 <span style="white-space:nowrap">« </span>derived<span style="white-space:nowrap"> »</span> matrices are (133.3, 97.3, -28.6, 22.0, 0, 0, 0, 0, 0). With 5 zero eigenvalues and 4 non-zero eigenvalues, we can conclude that the dimension of the vector space generated by the 9 matrices is 4.</p>
<p>The calculation time can be quite long due to the need to repeat a large number of draws, but the following section (<a href="#sec-ergemp" class="quarto-xref">section&nbsp;4.4</a>) shows that this number can remain reasonable. An estimate of this type is implemented by an iterative procedure in the document <a href="./larochelle.html">Estimates at La Rochelle</a> document, which reproduces <em>MEAPS</em> data from the <span class="citation" data-cites="MOBPRO">INSEE (<a href="#ref-MOBPRO" role="doc-biblioref">2022</a>)</span> job mobility survey with a calculation scheme that can be easily implemented.</p>
</section>
<section id="sec-ergemp" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="sec-ergemp"><span class="header-section-number">4.4</span> Ergodicity in practice</h3>
<p>Using synthetic data, it is easy to test the ergodicity hypothesis. It has been conjectured that the various mean quantities on the permutations <span class="math inline">u</span> were comparable to observations, possibly repeated. At this stage of synthetic simulations we do not compare the model with observations (see <a href="./larochelle.html">Estimates at La Rochelle</a>), but we will show that estimating mean values dœs not require examination of the <span class="math inline">I!</span>possible permutations[^11] and can make do with spatial aggregation and a few permutation draws.</p>
<p>[^11] By Stirling’s formula<span class="math inline">log_{10}(I!) \approx (n +1/2)log_{10} n +log_{10}\sqrt{2} - n log_{10}e \approx 5\times10^5</span> for <span class="math inline">I=10^5</span> which makes a large number.</p>
<p>To illustrate this property, we repeat the simulations of the model for several priority draws (noted <span class="math inline">u</span> in the <a href="#sec-erg" class="quarto-xref">section&nbsp;3.3</a> section), using a Monte-Carlo method. Taking the average over a sample of <span class="math inline">u</span> we can construct an estimator of the mean quantities and show that with a sample size that is small compared with <span class="math inline">I!</span> can be estimated reliably and in a reasonable time. This property will be demonstrated on the particular geographical structure that we have summarised, although this dœs not allow us to generalise with certainty. There are undoubtedly pathological spatial configurations that contradict this conjecture.</p>
<p>The <a href="#fig-emperg" class="quarto-xref">graphique&nbsp;5</a> illustrates the stochastic processes at work in the model and their resolution by averaging over the possible draws. The model is applied by randomly drawing priority permutations between residents. The set of destination choices (squared within the hexagons) is then represented for a number of housing hexagons (drawn at random). The grid already performs an averaging operation, since each individual in each hexagon has a different order of priority. We then represent the quantities of jobs (the probability of choosing a job in the destination hexagon). The white lines illustrate the dependence on the priority draw. But after a few draws, these probabilities converge on average. To simulate the model, it is not necessary (in all probability) to go through the entire universe of permutations.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-emperg" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-scap="Affectation de l'emploi pour des carreaux de départ" data-fig-pos="htb">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-emperg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Graphique</strong>&nbsp;5<strong>.</strong> Chaque ligne blanche représente pour un carreau de départ et d’arrivée (tous les carreaux d’arrivée sont représenté par une ligne, pour une sélection aléatoire de 4 carreaux de départ) la probabilité de prendre l’emploi dans le carreau d’arrivée en fonction du tirage aléatoire. Les lignes vertes représentent cette même probabibilité prise en moyenne sur les tirages cumulés. L’échelle de l’axe des y est logarithmique.
</figcaption>
<div aria-describedby="fig-emperg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="output/gemploi_erg.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" data-glightbox="description: .lightbox-desc-5"><img src="output/gemploi_erg.png" class="img-fluid figure-img" style="width:100.0%" data-fig-pos="htb" data-fig-scap="Affectation de l'emploi pour des carreaux de départ"></a>
</div>
</figure>
</div>
</div>
</div>
<p>The <a href="#tbl-fluxpoles_conf" class="quarto-xref">tableau&nbsp;8</a> indicates the 90% confidence intervals that can be constructed from the previous simulations. Satisfactory stability is achieved, even though the aggregate flows are stochastic. For a hundred or so runs, we can obtain an accuracy of more than <span class="math inline">10^{-3}</span>.</p>
<div class="cell" data-tbl-scap="flux entre pôles, intervalles de confiance">
<div id="tbl-fluxpoles_conf" class="cell quarto-float anchored" data-tbl-scap="flux entre pôles, intervalles de confiance">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fluxpoles_conf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Tableau</strong>&nbsp;8<strong>.</strong> flux entre pôles, intervalles de confiance
</figcaption>
<div aria-describedby="tbl-fluxpoles_conf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="upljeglulx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#upljeglulx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#upljeglulx thead, #upljeglulx tbody, #upljeglulx tfoot, #upljeglulx tr, #upljeglulx td, #upljeglulx th {
  border-style: none;
}

#upljeglulx p {
  margin: 0;
  padding: 0;
}

#upljeglulx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#upljeglulx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#upljeglulx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#upljeglulx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#upljeglulx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#upljeglulx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#upljeglulx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#upljeglulx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#upljeglulx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#upljeglulx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#upljeglulx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#upljeglulx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#upljeglulx .gt_spanner_row {
  border-bottom-style: hidden;
}

#upljeglulx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#upljeglulx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#upljeglulx .gt_from_md > :first-child {
  margin-top: 0;
}

#upljeglulx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#upljeglulx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#upljeglulx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#upljeglulx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#upljeglulx .gt_row_group_first td {
  border-top-width: 2px;
}

#upljeglulx .gt_row_group_first th {
  border-top-width: 2px;
}

#upljeglulx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#upljeglulx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#upljeglulx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#upljeglulx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#upljeglulx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#upljeglulx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#upljeglulx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#upljeglulx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#upljeglulx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#upljeglulx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#upljeglulx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#upljeglulx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#upljeglulx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#upljeglulx .gt_left {
  text-align: left;
}

#upljeglulx .gt_center {
  text-align: center;
}

#upljeglulx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#upljeglulx .gt_font_normal {
  font-weight: normal;
}

#upljeglulx .gt_font_bold {
  font-weight: bold;
}

#upljeglulx .gt_font_italic {
  font-style: italic;
}

#upljeglulx .gt_super {
  font-size: 65%;
}

#upljeglulx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#upljeglulx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#upljeglulx .gt_indent_1 {
  text-indent: 5px;
}

#upljeglulx .gt_indent_2 {
  text-indent: 10px;
}

#upljeglulx .gt_indent_3 {
  text-indent: 15px;
}

#upljeglulx .gt_indent_4 {
  text-indent: 20px;
}

#upljeglulx .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="e1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">e1</th>
<th id="e2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">e2</th>
<th id="e3" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">e3</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h1</td>
<td class="gt_row gt_center" headers="e1"><p>2481<br>[2472; 2490]<br>ε≈0.1%</p></td>
<td class="gt_row gt_center" headers="e2"><p>335<br>[330; 340]<br>ε≈0.5%</p></td>
<td class="gt_row gt_center" headers="e3"><p>334<br>[329; 339]<br>ε≈0.5%</p></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="gh">h2</td>
<td class="gt_row gt_center" headers="e1"><p>334<br>[327; 342]<br>ε≈0.6%</p></td>
<td class="gt_row gt_center" headers="e2"><p>290<br>[284; 295]<br>ε≈0.6%</p></td>
<td class="gt_row gt_center" headers="e3"><p>51<br>[49; 53]<br>ε≈2%</p></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="gh">h3</td>
<td class="gt_row gt_center" headers="e1"><p>334<br>[327; 341]<br>ε≈0.6%</p></td>
<td class="gt_row gt_center" headers="e2"><p>50<br>[49; 52]<br>ε≈2%</p></td>
<td class="gt_row gt_center" headers="e3"><p>290<br>[286; 295]<br>ε≈0.5%</p></td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="even">
<td colspan="4" class="gt_sourcenote">Source: MEAPS, intervalle à 95%, 1024 tirages</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>The saturation and priority diagram is illustrated by <a href="#fig-rangerg" class="quarto-xref">graphique&nbsp;6</a> below. For each arrival tile (a job), we represent the average rank (left) and its standard deviation (right) at the time of saturation. The stochastic nature results from the random drawing of the order of each individual (the starting tiles). For most jobs, the mean ergodic saturation rank is reached very quickly. The white lines are rapidly horizontal, indicating rapid convergence of the mean rank as the draws accumulate. This graph confirms that, with a few exceptions, the state of the system is stable after a few draws. The right-hand panel illustrates the standard deviation observed on the cumulative draws. This illustrates the stochastic nature of the model induced by the draws.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-rangerg" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-scap="Rang au moment de la saturation" data-fig-pos="htb">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-rangerg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Graphique</strong>&nbsp;6<strong>.</strong> Chaque ligne blanche représente pour un carreau d’arrivée (tous les carreaux d’arrivée sont représenté par une ligne) le rang moyen (panneau gauche) et l’écart type du rang (panneau de droite).
</figcaption>
<div aria-describedby="fig-rangerg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="output/g_rangns.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" data-glightbox="description: .lightbox-desc-6"><img src="output/g_rangns.png" class="img-fluid figure-img" style="width:100.0%" data-fig-pos="htb" data-fig-scap="Rang au moment de la saturation"></a>
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="localised-tension-by-job" class="level3" data-number="4.5">
<h3 data-number="4.5" class="anchored" data-anchor-id="localised-tension-by-job"><span class="header-section-number">4.5</span> Localised tension by job</h3>
<p>The average rank at the time of saturation is information that can be used to construct a localised tension indicator as shown on <strong>?@fig-map_erg</strong>. The tension indicator provides information that is distinct from average distance or population or job density. The most strained jobs are found on the axis linking the centres. Jobs located on the periphery of the central hub have a level of tension close to (but slightly higher than) those located in the satellites on the edge pointing towards the central hub. These factors can be used to identify relevant areas for employment development.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-carte_erg" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-scap="Indicateur de tension" data-fig-pos="htb">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-carte_erg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Graphique</strong>&nbsp;7<strong>.</strong> Indicateur de tension relatif localisé égal au rang de saturation normalisé à 100% (0% pour l’emploi saturé le plus tard, 100% pour l’emploi saturé le plus tôt, en moyenne sur chaque hexagone d’emploi).
</figcaption>
<div aria-describedby="fig-carte_erg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="output/carte_erg.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" data-glightbox="description: .lightbox-desc-7"><img src="output/carte_erg.png" class="img-fluid figure-img" style="width:100.0%" data-fig-pos="htb" data-fig-scap="Indicateur de tension"></a>
</div>
</figure>
</div>
</div>
</div>
<p>Experimentation in the application <em>Shiny</em> application makes it possible to study various properties of the tension indicator, in particular when overall tension is high (fewer jobs than residents) or low (excess of jobs over residents). In the case where there is an excess of jobs over residents, it is possible to observe local tension on certain jobs.</p>
</section>
<section id="synthetic-simulation-in-shiny" class="level3 page-columns page-full" data-number="4.6">
<h3 data-number="4.6" class="anchored" data-anchor-id="synthetic-simulation-in-shiny"><span class="header-section-number">4.6</span> Synthetic simulation in Shiny</h3>
<p>The application <a href="https://ofce.shinyapps.io./rmeaps/">shiny rmeaps</a> application can be used to generate synthetic geographies and simulate the <em>MEAPS</em> model on these distributions. Most of the graphs in this chapter can be reproduced in this way. The application allows you to choose the size of the problem (<span class="math inline">n</span> the number of assets and <span class="math inline">k</span> the number of jobs). By choosing more jobs than workers, we specify a problem where there is an excess of jobs and therefore no global constraint. In the opposite case, there is leakage, calculated so that the number of working people remaining in the area is equal to the number of jobs.</p>
<p>Various parameters can be used to specify the geography, i.e.&nbsp;the relative position of the poles or their size. The simulator uses Monte Carlo to simulate several orders of passage and displays the corresponding graphs as convergence progresses, accumulating the average of the different variables in the model. This feature makes it easy to visualise the ergodicity property mentioned above.</p>
<div class="column-screen">
<iframe id="meaps-shiny" src="https://ofce.shinyapps.io/rmeaps/" style="border: none; width: 100%; height: 850px" frameborder="0"></iframe>
</div>
</section>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-commenges2016" class="csl-entry" role="listitem">
Commenges H. (2016). <span>«&nbsp;<a href="https://doi.org/10.3166/RIG.26.79-95">Modèle de radiation et modèle gravitaire - Du formalisme à l<span>’</span>usage</a>&nbsp;»</span>, <em>Revue Internationale de Géomatique</em>, <em>26</em>, n° 1, p.&nbsp;79‑95.
</div>
<div id="ref-de2011modelling" class="csl-entry" role="listitem">
Dios Ortúzar J. de, Willumsen L.G. (2011). <em>Modelling transport</em>, John wiley &amp; sons.
</div>
<div id="ref-fik1990" class="csl-entry" role="listitem">
Fik T.J., Mulligan G.F. (1990). <span>«&nbsp;<a href="https://doi.org/10.1068/a220527">Spatial Flows and Competing Central Places: Towards a General Theory of Hierarchical Interaction</a>&nbsp;»</span>, <em>Environment and Planning A: Economy and Space</em>, <em>22</em>, n° 4, p.&nbsp;527‑549.
</div>
<div id="ref-jean-michelfloch2019" class="csl-entry" role="listitem">
Floch J.-M., Sillard P. (2019). <span>«&nbsp;<a href="https://thema.univ-fcomte.fr/theoq/pdf/2019/communications/2019_Floch.pdf">Les interactions spatiales. Quelques conséquences de l<span>’</span>introduction du modèle radiatif</a>&nbsp;»</span>, <em>Colloque Théo Quant 2019</em>.
</div>
<div id="ref-fotheringham1983" class="csl-entry" role="listitem">
Fotheringham A.S. (1983). <span>«&nbsp;<a href="https://doi.org/10.1177/0308518X8301500103">A New Set of Spatial-Interaction Models: The Theory of Competing Destinations</a>&nbsp;»</span>, <em>Environment and Planning A: Economy and Space</em>, <em>15</em>, n° 1, p.&nbsp;15‑36.
</div>
<div id="ref-fotheringham1984" class="csl-entry" role="listitem">
Fotheringham A.S. (1984). <span>«&nbsp;<a href="https://doi.org/10.1068/a160529">Spatial Flows and Spatial Patterns</a>&nbsp;»</span>, <em>Environment and Planning A: Economy and Space</em>, <em>16</em>, n° 4, p.&nbsp;529‑543.
</div>
<div id="ref-hansen1959" class="csl-entry" role="listitem">
Hansen W.G. (1959). <span>«&nbsp;<a href="https://doi.org/10.1080/01944365908978307">How Accessibility Shapes Land Use</a>&nbsp;»</span>, <em>Journal of the American Institute of Planners</em>, <em>25</em>, n° 2, p.&nbsp;73‑76.
</div>
<div id="ref-heanue1966" class="csl-entry" role="listitem">
Heanue K.E., Pyers C.E. (1966). <span>«&nbsp;A Comparative Evaluation of Trip Distribution Procedures&nbsp;»</span>, <em>Highway Reserach Record</em>, n° 114, p.&nbsp;20‑50.
</div>
<div id="ref-MOBPRO" class="csl-entry" role="listitem">
INSEE (2022). <span>«&nbsp;<a href="https://www.insee.fr/fr/statistiques/6454112">Mobilités professionnelles en 2019 : déplacements domicile - lieu de travail Recensement de la population - Base flux de mobilité</a>&nbsp;»</span>,.
</div>
<div id="ref-koenig1974" class="csl-entry" role="listitem">
Koenig G. (1974). <span>«&nbsp;<a href="https://doi.org/10.2307/3500570">Theorie economique de l’accessibilite urbaine</a>&nbsp;»</span>, <em>Revue économique</em>, <em>25</em>, n° 2, p.&nbsp;275.
</div>
<div id="ref-koenig1980" class="csl-entry" role="listitem">
Koenig G. (1980). <span>«&nbsp;<a href="https://doi.org/10.1007/bf00167128">Indicators of urban accessibility: Theory and application</a>&nbsp;»</span>, <em>Transportation</em>, <em>9</em>, n° 2, p.&nbsp;145‑172.
</div>
<div id="ref-lasser2020" class="csl-entry" role="listitem">
Lasser J. (2020). <span>«&nbsp;<a href="https://doi.org/10.1038/s42005-020-00403-4">Creating an executable paper is a journey through Open Science</a>&nbsp;»</span>, <em>Communications Physics</em>, <em>3</em>, n° 1.
</div>
<div id="ref-lenormand2016" class="csl-entry" role="listitem">
Lenormand M., Bassolas A., Ramasco J.J. (2016). <span>«&nbsp;<a href="https://doi.org/10.1016/j.jtrangeo.2015.12.008">Systematic comparison of trip distribution laws and models</a>&nbsp;»</span>, <em>Journal of Transport Geography</em>, <em>51</em>, p.&nbsp;158‑169.
</div>
<div id="ref-masucci2013" class="csl-entry" role="listitem">
Masucci A.P., Serras J., Johansson A., Batty M. (2013). <span>«&nbsp;<a href="https://doi.org/10.1103/PhysRevE.88.022812">Gravity versus radiation models: On the importance of scale and heterogeneity in commuting flows</a>&nbsp;»</span>, <em>Physical Review E</em>, <em>88</em>, n° 2, p.&nbsp;022812.
</div>
<div id="ref-mcfadden1974d" class="csl-entry" role="listitem">
McFadden D. (1974). <span>«&nbsp;<a href="https://doi.org/10.1016/0047-2727(74)90003-6">The measurement of urban travel demand</a>&nbsp;»</span>, <em>Journal of Public Economics</em>, <em>3</em>, n° 4, p.&nbsp;303‑328.
</div>
<div id="ref-meaps2024b" class="csl-entry" role="listitem">
Parodi M., Timbeau X. (2024a). <span>«&nbsp;<a href="https://preview.meaps.fr/trajets.html">La ville compacte : une solution aux émissions de gaz à effet de serre</a>&nbsp;»</span>, <em>Document de travail de l’OFCE</em>, n° 5-2024.
</div>
<div id="ref-meaps2024a" class="csl-entry" role="listitem">
Parodi M., Timbeau X. (2024b). <span>«&nbsp;<a href="https://preview.meaps.fr/larochelle.html">MEAPS&amp;Gravitaire : Estimations à la Rochelle</a>&nbsp;»</span>, <em>Document de travail de l’OFCE</em>, n° 4-2024.
</div>
<div id="ref-patrickbonnel2001" class="csl-entry" role="listitem">
Patrick Bonnel (2001). <em>Prévision de la demande de transport</em>, thèse de doctorat, Lyon, France.
</div>
<div id="ref-pirie1979" class="csl-entry" role="listitem">
Pirie G.H. (1979). <span>«&nbsp;<a href="https://doi.org/10.1068/a110299">Measuring Accessibility: A Review and Proposal</a>&nbsp;»</span>, <em>Environment and Planning A: Economy and Space</em>, <em>11</em>, n° 3, p.&nbsp;299‑312.
</div>
<div id="ref-jeanpoulit2005" class="csl-entry" role="listitem">
Poulit J. (2005). <em><a href="https://editionslesperegrines.fr/fr/books/le-territoire-des-hommes">Le Territoire Des Hommes</a></em>, Éditions Les Pérégrines.
</div>
<div id="ref-ruiter1967" class="csl-entry" role="listitem">
Ruiter E.R. (1967). <span>«&nbsp;<a href="https://doi.org/10.1016/0041-1647(67)90094-9">Toward a better understanding of the intervening opportunities model</a>&nbsp;»</span>, <em>Transportation Research</em>, <em>1</em>, n° 1, p.&nbsp;47‑56.
</div>
<div id="ref-sen1995" class="csl-entry" role="listitem">
Sen A., Smith T.E. (1995). <em><a href="https://doi.org/10.1007/978-3-642-79880-1">Gravity Models of Spatial Interaction Behavior</a></em>, Springer, Berlin, Heidelberg (Advances in Spatial et Network Economics).
</div>
<div id="ref-simini2012" class="csl-entry" role="listitem">
Simini F., González M.C., Maritan A., Barabási A.-L. (2012). <span>«&nbsp;<a href="https://doi.org/10.1038/nature10856">A universal model for mobility and migration patterns</a>&nbsp;»</span>, <em>Nature</em>, <em>484</em>, n° 7392, p.&nbsp;96‑100.
</div>
<div id="ref-simini2013" class="csl-entry" role="listitem">
Simini F., Maritan A., Néda Z. (2013). <span>«&nbsp;<a href="https://doi.org/10.1371/journal.pone.0060069">Human Mobility in a Continuum Approach</a>&nbsp;»</span>, <em>PLOS ONE</em>, <em>8</em>, n° 3, p.&nbsp;e60069.
</div>
<div id="ref-stouffer1940" class="csl-entry" role="listitem">
Stouffer S.A. (1940). <span>«&nbsp;<a href="https://doi.org/10.2307/2084520">Intervening Opportunities: A Theory Relating Mobility and Distance</a>&nbsp;»</span>, <em>American Sociological Review</em>, <em>5</em>, n° 6, p.&nbsp;845.
</div>
<div id="ref-wilson1967" class="csl-entry" role="listitem">
Wilson A.G. (1967). <span>«&nbsp;<a href="https://doi.org/10.1016/0041-1647(67)90035-4">A statistical theory of spatial distribution models</a>&nbsp;»</span>, <em>Transportation Research</em>, <em>1</em>, n° 3, p.&nbsp;253‑269.
</div>
</div>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1"><strong>Graphique</strong>&nbsp;1<strong>.</strong> Territoire synthétique comportant un centre ville (h1) et deux villages (h2) et (h3). Dans chaque hexagone est indiqué la densité <span style="white-space:nowrap">(5 000</span> habitants). <span style="white-space:nowrap">4 500</span> emplois avec des proportions d’emplois de 80% dans le centre et de 5% dans les 2 villages (les 10% restant sont la fuite). La dispersion est plus basse pour les emplois. Les densités d’emplois sont représentées dans le panneau de droite en orange.</span>
<span class="glightbox-desc lightbox-desc-2"><strong>Graphique</strong>&nbsp;2<strong>.</strong> On représente sur le panneau de <strong>gauche</strong> les distances moyennes parcourues par les habitants d’un héxagone. La vignette présente la densité des trajets en fonction de la distance(vert). Sur le panneau de <strong>droite</strong> on représente les distances moyennes pour atteindre chaque emploi, ainsi que la densité de ces trajets par distance dans la vignette (orange)</span>
<span class="glightbox-desc lightbox-desc-3"><strong>Graphique</strong>&nbsp;3<strong>.</strong> Le graphique est construit comme le précédent, le pôle 3 est éloigné de 0.5 (70% plus loin) par rapport à 1.</span>
<span class="glightbox-desc lightbox-desc-4"><strong>Graphique</strong>&nbsp;4<strong>.</strong> Densités comparées des distances parcourues par habitant entre le scénario de référence et le <span style="white-space:nowrap">scénario ‹</span>pôle 3 plus loin›. Le trait pointillé est utilisé pour le scénario alternatif.</span>
<span class="glightbox-desc lightbox-desc-5"><strong>Graphique</strong>&nbsp;5<strong>.</strong> Chaque ligne blanche représente pour un carreau de départ et d’arrivée (tous les carreaux d’arrivée sont représenté par une ligne, pour une sélection aléatoire de 4 carreaux de départ) la probabilité de prendre l’emploi dans le carreau d’arrivée en fonction du tirage aléatoire. Les lignes vertes représentent cette même probabibilité prise en moyenne sur les tirages cumulés. L’échelle de l’axe des y est logarithmique.</span>
<span class="glightbox-desc lightbox-desc-6"><strong>Graphique</strong>&nbsp;6<strong>.</strong> Chaque ligne blanche représente pour un carreau d’arrivée (tous les carreaux d’arrivée sont représenté par une ligne) le rang moyen (panneau gauche) et l’écart type du rang (panneau de droite).</span>
<span class="glightbox-desc lightbox-desc-7"><strong>Graphique</strong>&nbsp;7<strong>.</strong> Indicateur de tension relatif localisé égal au rang de saturation normalisé à 100% (0% pour l’emploi saturé le plus tard, 100% pour l’emploi saturé le plus tôt, en moyenne sur chaque hexagone d’emploi).</span>
</div>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Réutilisation</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.fr">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@article{parodi2023,
  author = {Parodi, Maxime and Timbeau, Xavier},
  title = {MEAPS: Modelling commuter flows},
  journal = {Document de travail de l’OFCE n°2023-14},
  date = {2023-05-02},
  url = {https://preview.meaps.fr},
  langid = {fr},
  abstract = {The gravity model used to distribute journeys between an
    origin and a destination poorly represents the influence of distance
    on choices. Drawing on the “intervening opportunities” model of
    @stouffer1940 and the radiative model of @simini2012, we construct
    an ergodic model of absorption with priority and saturation (MEAPS)
    that makes it possible to construct these choices on clear and
    flexible microscopic foundations. The model accommodates different
    formulations of stochastic processes that allow fundamental
    parameters to be estimated and interpreted. We validate the
    theoretical model on synthetic data, then in two associated
    documents {[}@meaps2024a; @meaps2024b{]} We propose an estimate of
    MEAPS and a detailed comparison with the gravity model and its most
    common variants. We then use this modelling to construct a
    high-resolution map of
    CO\textasciitilde\textasciitilde2\textasciitilde\textasciitilde{}
    emissions in La Rochelle. \textless br\textgreater{} `r
    wordcountaddin::word\_count(“theorie.qmd”)` words.}
}
</code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">Veuillez citer ce travail comme suit&nbsp;:</div><div id="ref-parodi2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Parodi M., Timbeau X. (2023). <span>«&nbsp;<a href="https://preview.meaps.fr">MEAPS: Modelling commuter
flows</a>&nbsp;»</span>, <em>Document de travail de l’OFCE n°2023-14</em>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="xtimbeau/meaps" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><strong>CC BY 4.0</strong></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","selector":".lightbox","closeEffect":"zoom","descPosition":"bottom","loop":false});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>